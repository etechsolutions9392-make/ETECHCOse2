<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-TECH SOLUTIONS | Dynamic E-Learning Portal</title>
    <link rel="icon" type="image/png" href="https://lh3.googleusercontent.com/pw/AP1GczNty6_2Cq0hySwk_JWjLVcINZz0lyqfq9BNLXjr9-qhG_94UV7oQLhTNB7VtAP8qM1G1G06Gj36pEqbZyvBWZlV4508OriC45KwQoabQ8qSRc5HHMGPVu=w2400?source=screenshot.guru">
     <link rel="icon" type="image/png" href="https://lh3.googleusercontent.com/pw/AP1GczNty6_2Cq0hySwk_JWjLVcINZz0lyqfq9BNLXjr9-qhG_94UV7oQLhTNB7VtAP8qM1G06Gj36pEqbZyvBWZlV4508OriC45KwQoabQ8qSRc5HHMGPVu=w2400?source=screenshot.guru"> 
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Razorpay SDK -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <!-- Custom CSS for Enhancements -->
    <style>
        :root {
            --primary-color: #3b82f6; /* Blue 500 */
            --secondary-color: #10b981; /* Green 500 */
            --accent-color: #a855f7; /* Purple 500 */
            --danger-color: #ef4444; /* Red 500 */
            --dark-bg: #1f2937; /* Gray 800 */
            --light-bg: #f3f4f6; /* Gray 100 */
            --text-heading-color: #1a202c; /* Dark text for headings */
            --text-body-color: #4a5568; /* Slightly lighter for body text */
        }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #e0f2f7 0%, #c1d9e2 100%);
            color: var(--text-body-color); /* Applied custom text color */
            line-height: 1.6;
            overflow-x: hidden; /* Prevent horizontal scroll due to animations */
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            color: var(--text-heading-color); /* Applied custom text color */
        }

        /* Dark Mode */
        html.dark {
            --dark-bg: #0d1117; /* GitHub Dark mode bg */
            --light-bg: #161b22; /* Slightly lighter dark */
            --text-heading-color: #c9d1d9; /* Light text for headings */
            --text-body-color: #8b949e; /* Lighter for body text */
            background: var(--dark-bg);
            color: var(--text-body-color);
        }
        html.dark body {
            background: var(--dark-bg);
            color: var(--text-body-color);
        }
        html.dark header {
            background-color: var(--light-bg);
            border-bottom: 1px solid #30363d;
        }
        html.dark #auth-section-wrapper,
        html.dark .course-card,
        html.dark .bg-white,
        html.dark .modal-content-container,
        html.dark #assistant-chat-modal-content {
            background: var(--light-bg);
            border: 1px solid #30363d;
            box-shadow: 0 12px 30px rgba(0,0,0,0.4);
        }
        html.dark .form-control {
            background: #21262d;
            border-color: #30363d;
            color: var(--text-heading-color);
        }
        html.dark .form-control:focus {
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3), 0 4px 12px rgba(0,0,0,0.3);
        }
        html.dark .form-label {
            background-color: #21262d;
            color: var(--text-body-color);
        }
        html.dark .form-control:focus ~ .form-label,
        html.dark .form-control:not(:placeholder-shown) ~ .form-label {
            color: var(--primary-color);
            background-color: #21262d;
        }
        html.dark .tab-btn {
            color: var(--text-body-color);
        }
        html.dark .tab-btn.active {
            color: var(--primary-color);
        }
        html.dark .ai-section-container {
            background: var(--light-bg);
            border-color: #30363d;
        }
        html.dark .ai-section-output {
            background: #21262d !important; /* Override specific light mode gradients */
            border-color: #30363d;
            color: var(--text-heading-color);
        }
        html.dark ::-webkit-scrollbar-track {
            background: #21262d;
        }
        html.dark ::-webkit-scrollbar-thumb {
            background: #4f46e5; /* Different color for dark mode scrollbar */
            border: 2px solid #21262d;
        }
        html.dark ::-webkit-scrollbar-thumb:hover {
            background: #6366f1;
        }

        /* Global Transitions for smooth UI */
        * {
            transition: all 0.3s ease-out;
        }

        /* Keyframe Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes slideInFromBottom {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-in-bottom {
            animation: slideInFromBottom 0.6s ease-out forwards;
        }

        @keyframes pulseGlow {
            0% { text-shadow: 0 0 5px rgba(59, 130, 246, 0.4); }
            50% { text-shadow: 0 0 15px rgba(59, 130, 246, 0.8); }
            100% { text-shadow: 0 0 5px rgba(59, 130, 246, 0.4); }
        }
        .pulse-glow {
            animation: pulseGlow 2s infinite alternate;
        }

        /* Loader Spinner */
        .loader {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            flex-shrink: 0; /* Prevent shrinking when text changes */
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom Tab Styles for Auth Section */
        .tab-btn {
            position: relative;
            overflow: hidden;
            transition: color 0.3s ease-out; /* Smooth color transition */
        }
        .tab-btn.active {
            color: var(--primary-color);
            font-weight: 700;
        }
        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) scaleX(0);
            width: 100%;
            height: 3px;
            background-color: var(--primary-color);
            transition: transform 0.3s ease-out;
            border-radius: 5px;
        }
        .tab-btn.active::after {
            transform: translateX(-50%) scaleX(1);
        }

        /* Modal Backdrop */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.6); /* Slightly darker backdrop */
            backdrop-filter: blur(10px); /* More pronounced blur */
            transition: background-color 0.3s ease, backdrop-filter 0.3s ease;
        }
        .modal-content-container {
            transform: scale(0.9) translateY(20px); /* Initial state: slightly smaller and lower */
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); /* Smoother animation */
            box-shadow: 0 25px 50px rgba(0,0,0,0.4); /* Deeper shadow */
        }
        .modal-content-container.active {
            transform: scale(1) translateY(0); /* Active state: full size and position */
            opacity: 1;
        }

        /* Floating Labels for Forms - Enhanced */
        .form-group {
            position: relative;
            margin-bottom: 1.75rem; /* More space */
        }
        .form-control {
            width: 100%;
            padding: 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.75rem; /* More rounded */
            background: #fdfdfd; /* Slightly off-white background */
            transition: all 0.3s ease;
            box-shadow: inset 0 1px 4px rgba(0,0,0,0.08); /* Stronger inner shadow */
        }
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3), 0 4px 12px rgba(0,0,0,0.15); /* Enhanced focus shadow */
        }
        .form-label {
            position: absolute;
            top: 1rem;
            left: 1rem;
            color: #6b7280;
            transition: all 0.25s ease, transform 0.25s ease; /* Longer transition */
            pointer-events: none;
            background-color: #fdfdfd; /* Match input background */
            padding: 0 0.25rem;
            border-radius: 3px;
            z-index: 1; /* Ensure label is above input when moved */
        }
        .form-control:focus ~ .form-label,
        .form-control:not(:placeholder-shown) ~ .form-label {
            top: -0.75rem;
            left: 0.75rem;
            font-size: 0.825rem; /* Slightly smaller font */
            color: var(--primary-color);
            background-color: #fdfdfd; /* Match input background */
            transform: translateY(-50%) translateX(-2px); /* Slight translate for "pop" effect */
            letter-spacing: 0.025em; /* Subtle letter spacing */
        }

        /* Enhanced Buttons - More Dynamic */
        .btn-primary {
            background: linear-gradient(145deg, #3b82f6, #2563eb);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
            transform: skewX(-20deg);
            z-index: -1;
        }
        .btn-primary:hover::before {
            left: 100%;
        }
        .btn-primary:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            transform: translateY(-3px);
            background: linear-gradient(145deg, #2563eb, #3b82f6); /* Subtle gradient shift on hover */
        }

        .btn-secondary {
            background: linear-gradient(145deg, #10b981, #059669);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        .btn-secondary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
            transform: skewX(-20deg);
            z-index: -1;
        }
        .btn-secondary:hover::before {
            left: 100%;
        }
        .btn-secondary:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            transform: translateY(-3px);
            background: linear-gradient(145deg, #059669, #10b981);
        }

        .btn-danger {
            background: linear-gradient(145deg, #ef4444, #dc2626);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        .btn-danger::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
            transform: skewX(-20deg);
            z-index: -1;
        }
        .btn-danger:hover::before {
            left: 100%;
        }
        .btn-danger:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            transform: translateY(-3px);
            background: linear-gradient(145deg, #dc2626, #ef4444);
        }

        /* Course Card Enhancements - More Glow and Lift */
        .course-card {
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15); /* Slightly larger initial shadow */
            border: 1px solid rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(5px);
            background: rgba(255, 255, 255, 0.95); /* Slightly less transparent */
            transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), border-color 0.4s ease, opacity 0.3s ease;
            opacity: 0; /* Initially hidden for entrance animation */
            transform: translateY(20px); /* Initial position for entrance animation */
            position: relative; /* For pseudo-element glow */
            overflow: hidden; /* Hide overflow from image scale */
        }
        .course-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 0.75rem; /* Match card border-radius */
            padding: 2px; /* Border thickness */
            background: linear-gradient(45deg, #3b82f6, #a855f7, #10b981); /* Gradient for the glow */
            -webkit-mask: 
                linear-gradient(#fff 0 0) content-box, 
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            z-index: 0;
            opacity: 0;
            transition: opacity 0.4s ease;
            filter: blur(10px); /* Blur the glow */
        }
        .course-card:hover::before {
            opacity: 1; /* Show glow on hover */
        }
        .course-card.animate-in {
            animation: slideInFromBottom 0.6s ease-out forwards;
        }
        .course-card:hover {
            transform: translateY(-10px) scale(1.02); /* More pronounced lift and scale */
            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.25); /* Deeper shadow on hover */
            border-color: var(--primary-color); /* Highlight border */
        }
        .course-card img {
            transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); /* Smoother image scale */
        }
        .course-card:hover img {
            transform: scale(1.08); /* More pronounced image scale */
        }

        /* Toast Notification - More lively */
        #toast {
            z-index: 1000;
            background: linear-gradient(90deg, #333, #555);
            color: #fff;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem; /* More rounded */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4); /* Deeper shadow */
            transform: translateX(120%) scale(0.9); /* Subtle scale in/out */
            transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55), background-color 0.3s ease, box-shadow 0.3s ease;
            opacity: 0; /* Start invisible */
        }
        #toast.active { /* Use 'active' class to show toast */
            transform: translateX(0) scale(1);
            opacity: 1;
        }
        #toast.bg-green-500 { background: linear-gradient(90deg, #10b981, #059669); }
        #toast.bg-red-500 { background: linear-gradient(90deg, #ef4444, #dc2626); }
        #toast.bg-yellow-500 { background: linear-gradient(90deg, #f59e0b, #d97706); }


        /* Aesthetic Background for Auth Section - More Dynamic Pattern */
        #auth-section-wrapper {
            background: 
                radial-gradient(circle at top left, rgba(59, 130, 246, 0.15) 0%, transparent 40%),
                radial-gradient(circle at bottom right, rgba(168, 85, 247, 0.15) 0%, transparent 40%),
                #ffffff; /* Base white background */
            border-radius: 1.5rem;
            padding: 2.5rem; /* More padding */
            box-shadow: 0 25px 60px rgba(0,0,0,0.2), 0 0 0 1px rgba(0,0,0,0.08); /* Deeper shadows */
            position: relative;
            overflow: hidden;
            opacity: 0; /* Initially hidden for entrance animation */
            transform: translateY(30px); /* Initial position for entrance animation */
            animation: slideInFromBottom 0.8s ease-out forwards; /* Apply entrance animation */
        }
        #auth-section-wrapper::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                rgba(255,255,255,0.07) 0px,
                rgba(255,255,255,0.07) 12px,
                transparent 12px,
                transparent 24px
            );
            animation: moveBackground 90s linear infinite; /* Slower animation for subtler effect */
            pointer-events: none;
            z-index: 0;
            opacity: 0.4; /* Slightly more visible */
            mix-blend-mode: overlay; /* Blend with background */
        }

        @keyframes moveBackground {
            0% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(-25%, -25%) scale(1.05); } /* Subtle zoom */
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        /* Social Media Icons - Enhanced */
        .social-icon {
            color: #ffffff; /* Default white color */
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            transform: scale(1);
            text-shadow: 0 2px 5px rgba(0,0,0,0.3); /* Initial shadow */
        }

        .social-icon:hover {
            transform: scale(1.3) translateY(-5px); /* More pronounced pop and lift */
            text-shadow: 0 5px 15px rgba(0,0,0,0.5); /* Deeper shadow on hover */
        }

        /* Specific icon colors (unchanged, but benefit from global hover) */
        .social-icon.fa-instagram:hover {
            color: #E1306C; /* Instagram pink */
        }
        .social-icon.fa-facebook:hover {
            color: #1877F2; /* Facebook blue */
        }
        .social-icon.fa-youtube:hover {
            color: #FF0000; /* YouTube red */
        }

        /* Header Enhancements */
        header {
            box-shadow: 0 8px 30px rgba(0,0,0,0.25); /* Stronger shadow */
        }
        header img {
            transition: transform 0.4s ease-out, box-shadow 0.4s ease-out;
        }
        header img:hover {
            transform: scale(1.15) rotate(8deg); /* More dynamic rotate/scale */
            box-shadow: 0 0 0 6px rgba(59, 130, 246, 0.6), 0 10px 20px rgba(0,0,0,0.4); /* Halo effect */
        }

        /* AI Section specific styling */
        .ai-section-container {
            background: linear-gradient(135deg, rgba(240, 248, 255, 0.9), rgba(224, 238, 255, 0.95)); /* Light blue gradient */
            border: 1px solid rgba(190, 220, 255, 0.7);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        .ai-section-container h4 {
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            display: inline-flex; /* To align icon with gradient text */
        }
        .ai-section-container .fa-brain { background: linear-gradient(to right, #a855f7, #6d28d9); background-clip: text; -webkit-background-clip: text; color: transparent; }
        .ai-section-container .fa-lightbulb { background: linear-gradient(to right, #fbbf24, #f59e0b); background-clip: text; -webkit-background-clip: text; color: transparent; }
        .ai-section-container .fa-clipboard-list { background: linear-gradient(to right, #06b6d4, #0891b2); background-clip: text; -webkit-background-clip: text; color: transparent; }
        .ai-section-container .fa-question-circle { background: linear-gradient(to right, #10b981, #059669); background-clip: text; -webkit-background-clip: text; color: transparent; }
        .ai-section-container .fa-lightbulb-on { background: linear-gradient(to right, #14b8a6, #0d9488); background-clip: text; -webkit-background-clip: text; color: transparent; }
        .ai-section-container .fa-user-tie { background: linear-gradient(to right, #6366f1, #4f46e5); background-clip: text; -webkit-background-clip: text; color: transparent; }
        .ai-section-container .fa-wrench { background: linear-gradient(to right, #ef4444, #dc2626); background-clip: text; -webkit-background-clip: text; color: transparent; }
        .ai-section-container .fa-code { background: linear-gradient(to right, #6b7280, #374151); background-clip: text; -webkit-background-clip: text; color: transparent; }
        .ai-section-container .fa-microchip { background: linear-gradient(to right, #ff7e5f, #feb47b); background-clip: text; -webkit-background-clip: text; color: transparent; } /* New: Orange/Peach */
        .ai-section-container .fa-file-alt { background: linear-gradient(to right, #9fe6a0, #42b883); background-clip: text; -webkit-background-clip: text; color: transparent; } /* New: Light Green */
        .ai-section-container .fa-briefcase { background: linear-gradient(to right, #e76f51, #f4a261); background-clip: text; -webkit-background-clip: text; color: transparent; } /* New: Orange/Brown for Interview Questions */



        .ai-section-output {
            position: relative;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.05);
            min-height: 100px;
            overflow-y: auto;
            max-height: 96;
            transition: all 0.3s ease-out;
            background-size: 200% 200%;
            animation: gradientMove 5s ease alternate infinite;
        }

        @keyframes gradientMove {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }

        .ai-plan-output { background: linear-gradient(135deg, #e0f2f7, #d0e7f2); }
        .ai-explanation-output { background: linear-gradient(135deg, #fffbe0, #fff7d0); }
        .ai-notes-output { background: linear-gradient(135deg, #e0f8fb, #d0f2f7); }
        .ai-quiz-output { background: linear-gradient(135deg, #e0f7e0, #d0f2d0); }
        .ai-project-ideas-output { background: linear-gradient(135deg, #e0fdfb, #d0f7f2); }
        .ai-career-paths-output { background: linear-gradient(135deg, #e0e0f7, #d0d0f2); }
        .ai-troubleshooting-output { background: linear-gradient(135deg, #fce9e9, #f7dcdc); }
        .ai-code-output { background: linear-gradient(135deg, #f0f0f0, #e0e0e0); }
        .ai-components-output { background: linear-gradient(135deg, #ffe5d3, #ffcba4); } /* New: Light Peach/Orange */
        .ai-lab-report-output { background: linear-gradient(135deg, #d3ffe3, #a4ffc3); } /* New: Light Green */
        .ai-interview-questions-output { background: linear-gradient(135deg, #fefce3, #fffbe3); } /* New: Light Yellow/Cream */
        
        /* Enhance scrollbars for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
            border: 2px solid #f1f1f1;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #2563eb;
        }

        /* Progress Bar Styling */
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 9999px; /* Full rounded corners */
            overflow: hidden;
            height: 12px; /* Slimmer bar */
            margin-top: 0.5rem;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--secondary-color); /* Green for progress */
            border-radius: 9999px;
            text-align: center;
            color: white;
            transition: width 0.5s ease-in-out, background-color 0.3s ease;
            font-size: 0.75rem; /* Smaller font for percentage */
            line-height: 12px; /* Center text vertically */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .progress-text-small {
            font-size: 0.75rem; /* Smaller text for progress label */
            color: #555;
            margin-top: 0.25rem;
            text-align: right;
        }

        /* Styling for completed courses */
        .course-completed .progress-bar {
            background-color: var(--accent-color); /* Purple for completed */
        }
        .course-completed .progress-text-small {
            color: var(--accent-color);
            font-weight: bold;
        }

        /* Dark mode toggle switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 28px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 28px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
            transform: translateX(20px);
        }
        .dark-mode-icon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.9rem;
            color: white;
            line-height: 1;
        }
        .dark-mode-icon.sun {
            right: 8px;
            color: #f39c12; /* Sun color */
        }
        .dark-mode-icon.moon {
            left: 8px;
            color: #f1c40f; /* Moon color */
        }
        input:checked + .slider .moon {
            display: none;
        }
        input:not(:checked) + .slider .sun {
            display: none;
        }

        /* TECHWHIZ Assistant specific styles */
        #techwhiz-fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: pulseGlow 2s infinite alternate; /* Re-use existing pulse glow */
            transform: scale(1);
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
        }
        #techwhiz-fab:hover {
            transform: scale(1.05) translateY(-3px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }
        html.dark #techwhiz-fab {
            background: linear-gradient(145deg, #6366f1, #4f46e5); /* Darker purple for FAB */
            color: #e0e7ff;
        }
        #techwhiz-fab.speech-active {
            animation: pulseBlue 1.5s infinite; /* Distinct pulse for listening */
        }
        #techwhiz-fab.image-processing {
             animation: spin 1s linear infinite, pulseRed 1.5s infinite; /* Spin + red pulse for image processing */
        }

        @keyframes pulseBlue {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        @keyframes pulseRed {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        #assistant-chat-modal-content {
            height: 80vh;
            max-height: 600px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow: hidden;
            border-radius: 1rem; /* More rounded modal */
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); /* Stronger shadow */
            position: relative;
            background: linear-gradient(180deg, var(--light-bg) 0%, rgba(240, 248, 255, 0.8) 100%); /* Subtle gradient */
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        html.dark #assistant-chat-modal-content {
            background: linear-gradient(180deg, #161b22 0%, #0d1117 100%);
        }

        #assistant-chat-modal-content .sticky {
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            color: white;
            border-bottom: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        html.dark #assistant-chat-modal-content .sticky {
             background: linear-gradient(90deg, #4f46e5, #a855f7);
        }

        #chat-history {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column-reverse; /* Keep new messages at bottom visually */
            gap: 0.75rem;
            background-color: rgba(240, 248, 255, 0.5); /* Lighter background for chat history */
            backdrop-filter: blur(3px); /* Small blur for depth */
        }
        html.dark #chat-history {
            background-color: rgba(33, 38, 45, 0.7);
        }

        .chat-message {
            max-width: 85%; /* Slightly wider messages */
            padding: 0.85rem 1.2rem; /* More padding */
            border-radius: 1.5rem;
            word-wrap: break-word;
            box-shadow: 0 3px 8px rgba(0,0,0,0.15); /* Stronger message shadow */
            transition: all 0.2s ease-out; /* Smooth transitions for messages */
            opacity: 0;
            transform: translateY(10px);
            animation: slideUpFadeIn 0.3s ease-out forwards;
        }
        @keyframes slideUpFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-message.user {
            background-color: var(--primary-color);
            color: white;
            align-self: flex-start; /* Changed to flex-start for reverse column flow */
            border-bottom-left-radius: 0.5rem; /* Pointing towards user input */
            margin-left: auto; /* Push user message to the right */
        }
        .chat-message.assistant {
            background-color: var(--light-bg);
            color: var(--text-heading-color);
            align-self: flex-start; /* Correct alignment for assistant */
            border-bottom-left-radius: 0.5rem;
        }
        html.dark .chat-message.assistant {
            background-color: #21262d; /* Darker background for assistant in dark mode */
            color: var(--text-heading-color);
            border-bottom-left-radius: 0.5rem;
        }

        .chat-message.user.image-message { /* Specific styling for user-uploaded image */
            background: none; /* No background for image messages */
            box-shadow: none;
            padding: 0;
            margin-left: auto; /* Keep it on the right */
            max-width: 60%; /* Smaller width for image */
            border-radius: 0.75rem;
            overflow: hidden;
        }
        .chat-message.user.image-message img {
            max-width: 100%;
            height: auto;
            display: block;
            border-radius: 0.75rem;
        }

        .speech-active {
            animation: pulseBlue 1.5s infinite; /* Distinct pulse for microphone */
        }

        #mic-btn, #send-btn, #upload-image-btn, #stop-speech-btn {
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.2s ease-in-out;
        }
        #mic-btn:hover, #send-btn:hover, #upload-image-btn:hover, #stop-speech-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }
        #mic-btn.speech-active {
            color: white;
            background: linear-gradient(145deg, #ef4444, #dc2626); /* Red pulse when active */
            animation: pulseRed 1s infinite;
        }
        #mic-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background: #ccc;
        }
        html.dark #mic-btn.speech-active {
            background: linear-gradient(145deg, #ef4444, #dc2626);
        }

        #techwhiz-input {
            border: 1px solid #d1d5db;
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            transition: all 0.2s ease-in-out;
        }
        #techwhiz-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3), inset 0 1px 3px rgba(0,0,0,0.1);
        }
        html.dark #techwhiz-input {
            background: #21262d;
            border-color: #30363d;
            color: var(--text-heading-color);
        }
        html.dark #techwhiz-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3), inset 0 1px 3px rgba(0,0,0,0.1);
        }


        #listening-status, #thinking-status {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: fadeIn 0.3s ease-out;
        }
        #listening-status::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--secondary-color); /* Green dot for listening */
            animation: pulseDot 1.5s infinite;
        }
        #thinking-status::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary-color); /* Blue dot for thinking */
            animation: bounceDot 1.2s infinite;
        }
        @keyframes pulseDot {
            0% { transform: scale(0.8); opacity: 0.7; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0.7; }
        }
        @keyframes bounceDot {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

    </style>
</head>
<body class="antialiased">
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>

    <!-- Header -->
    <header class="bg-gray-900 text-white p-4 shadow-2xl sticky top-0 z-40">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <img src="https://lh3.googleusercontent.com/pw/AP1GczMFGvwVU32NSsKv5V5pVdolG2i9-eEUBOupJmE6wvE5hKb08fmmPauG62OnGUmD0esm9pa-d285g6XBzAxuULCghMe8Obxi1mUTI3LcaMuGB0IJz-5-=w2400" alt="Logo" class="h-14 w-14 rounded-full border-4 border-blue-500 hover:scale-110 hover:rotate-6 transform transition-transform duration-300 shadow-lg">
                <h1 class="text-2xl md:text-3xl font-bold tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-300 drop-shadow-lg pulse-glow">
                    E-TECH <span class="text-blue-200">SOLUTIONS</span>
                </h1>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Dark Mode Toggle -->
                <label class="switch" aria-label="Toggle dark mode">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="slider round">
                        <i class="fas fa-sun dark-mode-icon sun"></i>
                        <i class="fas fa-moon dark-mode-icon moon"></i>
                    </span>
                </label>

                <div id="user-info" class="hidden items-center space-x-4">
                    <span id="user-name" class="font-semibold text-sm md:text-base text-blue-200"></span>
                    <button id="logout-btn" class="btn-danger font-bold py-2 px-4 rounded-full transition duration-300 flex items-center">
                        <i class="fas fa-sign-out-alt mr-2"></i> Logout
                    </button>
                    <!-- New: Payment History -->
                    <button id="payment-history-btn" class="btn-secondary font-bold py-2 px-4 rounded-full transition duration-300 hidden">
                        <i class="fas fa-receipt mr-2"></i> Payments
                    </button>
                </div>
                <button id="login-nav-btn" class="btn-primary font-bold py-2 px-4 rounded-full transition duration-300">
                    Login / Register
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="container mx-auto p-4 md:p-8">
        <!-- Authentication Section (Initially Visible) -->
        <section id="auth-section" class="max-w-lg mx-auto py-8">
            <div id="auth-section-wrapper" class="bg-white p-8 rounded-3xl shadow-2xl relative z-10">
                <div class="mb-6 border-b-2 border-gray-200">
                    <nav class="flex -mb-px" aria-label="Tabs">
                        <button class="tab-btn active w-1/2 py-4 px-1 text-center font-medium text-lg text-gray-700 hover:text-blue-600 transition duration-300" data-target="login-content" role="tab" aria-selected="true" aria-controls="login-content">
                            SIGN IN
                        </button>
                        <button class="tab-btn w-1/2 py-4 px-1 text-center font-medium text-lg text-gray-700 hover:text-blue-600 transition duration-300" data-target="register-content" role="tab" aria-selected="false" aria-controls="register-content">
                            CREATE ACCOUNT
                        </button>
                    </nav>
                </div>
                
                <!-- Login Form -->
                <div id="login-content" class="tab-content" role="tabpanel" aria-labelledby="login-tab">
                    <h2 class="text-3xl font-bold text-center mb-2 text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600">Welcome Back!</h2>
                    <p class="text-center text-gray-500 mb-6 text-lg">Sign in to continue your learning journey.</p>
                    <form id="login-form" aria-label="Login Form">
                        <div class="form-group">
                            <input type="email" id="login-email" class="form-control" placeholder=" " required autocomplete="email" aria-required="true">
                            <label for="login-email" class="form-label">Email Address</label>
                        </div>
                        <div class="form-group">
                            <input type="password" id="login-password" class="form-control" placeholder=" " required autocomplete="current-password" aria-required="true">
                            <label for="login-password" class="form-label">Password</label>
                        </div>
                        <button type="submit" class="w-full btn-primary py-3 px-4 rounded-full text-lg flex items-center justify-center">
                            <span class="button-text">Secure Login</span>
                            <div class="loader hidden ml-2 flex-shrink-0"></div>
                        </button>
                    </form>
                </div>

                <!-- Registration Form -->
                <div id="register-content" class="tab-content hidden" role="tabpanel" aria-labelledby="register-tab">
                    <h2 class="text-3xl font-bold text-center mb-2 text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600">Create Your Account</h2>
                    <p class="text-center text-gray-500 mb-6 text-lg">Unlock a world of electronics and IoT.</p>
                    <form id="register-form" aria-label="Registration Form">
                        <div class="form-group">
                            <input type="text" id="register-name" class="form-control" placeholder=" " required autocomplete="name" aria-required="true">
                            <label for="register-name" class="form-label">Full Name</label>
                        </div>
                        <div class="form-group">
                            <input type="email" id="register-email" class="form-control" placeholder=" " required autocomplete="email" aria-required="true">
                            <label for="register-email" class="form-label">Email Address</label>
                        </div>
                        <div class="form-group">
                            <input type="password" id="register-password" class="form-control" placeholder=" " required minlength="6" autocomplete="new-password" aria-required="true">
                            <label for="register-password" class="form-label">Password (min. 6 characters)</label>
                        </div>
                        <button type="submit" class="w-full btn-secondary py-3 px-4 rounded-full text-lg flex items-center justify-center">
                            <span class="button-text">Create Account</span>
                            <div class="loader hidden ml-2 flex-shrink-0"></div>
                        </button>
                    </form>
                </div>
                 <p id="auth-error" class="text-red-500 text-center mt-4 h-5 font-semibold" role="alert" aria-live="polite"></p>
            </div>
        </section>

        <!-- Course Display Section (Initially Hidden) -->
        <section id="course-section" class="hidden mt-8 fade-in">
            <h2 class="text-4xl font-bold text-center text-gray-800 mb-8 text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600">Explore Our Courses</h2>
            
            <!-- Search, Filter, Sort Controls -->
            <div class="flex flex-col md:flex-row items-center justify-between mb-6 space-y-4 md:space-y-0 md:space-x-4">
                <div class="w-full md:w-1/3 relative form-group">
                    <input type="text" id="course-search" class="form-control pr-10" placeholder=" " aria-label="Search courses">
                    <label for="course-search" class="form-label">Search Courses</label>
                    <i class="fas fa-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                </div>

                <div class="flex space-x-2 w-full md:w-auto justify-center">
                    <select id="course-filter" class="p-2 border rounded-lg shadow-sm bg-white cursor-pointer" aria-label="Filter courses">
                        <option value="all">All Courses</option>
                        <option value="free">Free Courses</option>
                        <option value="paid">Paid Courses</option>
                        <option value="purchased">My Purchased Courses</option>
                        <option value="in-progress">My In-Progress Courses</option>
                        <option value="completed">My Completed Courses</option>
                    </select>
                    <select id="course-sort" class="p-2 border rounded-lg shadow-sm bg-white cursor-pointer" aria-label="Sort courses">
                        <option value="title-asc">Title (A-Z)</option>
                        <option value="title-desc">Title (Z-A)</option>
                        <option value="price-asc">Price (Low to High)</option>
                        <option value="price-desc">Price (High to Low)</option>
                        <option value="progress-asc">Progress (Low to High)</option>
                        <option value="progress-desc">Progress (High to Low)</option>
                    </select>
                </div>
            </div>

            <div id="course-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Courses will be dynamically inserted here -->
            </div>
        </section>
    </main>

    <!-- Course Content Modal -->
    <div id="course-modal" class="fixed inset-0 modal-backdrop hidden items-center justify-center p-4 z-50" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto transform transition-all duration-300 modal-content-container">
            <div class="sticky top-0 bg-white p-6 border-b-2 border-gray-100 flex justify-between items-center z-10 rounded-t-lg">
                <h3 id="modal-title" class="text-2xl font-bold text-gray-800"></h3>
                <button id="close-modal" class="text-gray-500 hover:text-gray-900 text-4xl leading-none transition-transform duration-300 hover:rotate-90" aria-label="Close Course Details">&times;</button>
            </div>
            <div id="modal-body" class="p-6 text-gray-700">
                <!-- Course content will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-5 right-5 text-white py-3 px-6 rounded-lg shadow-lg transform translate-x-full transition-transform duration-500" role="status" aria-live="polite">
        <p id="toast-message" class="font-semibold"></p>
    </div>

    <!-- TECHWHIZ Floating Action Button -->
    <button id="techwhiz-fab" class="btn-primary w-16 h-16 rounded-full flex items-center justify-center text-3xl text-white focus:outline-none focus:ring-4 focus:ring-blue-300" aria-label="Open TECHWHIZ Assistant">
        <i class="fas fa-robot fab-icon"></i>
    </button>

    <!-- TECHWHIZ Chat Modal -->
    <div id="techwhiz-modal" class="fixed inset-0 modal-backdrop hidden items-center justify-center p-4 z-50" role="dialog" aria-modal="true" aria-labelledby="techwhiz-modal-title">
        <div id="assistant-chat-modal-content" class="bg-white rounded-lg shadow-2xl max-w-lg w-full transform transition-all duration-300 modal-content-container">
            <div class="sticky top-0 bg-white p-6 border-b-2 border-gray-100 flex justify-between items-center z-10 rounded-t-lg">
                <h3 id="techwhiz-modal-title" class="text-2xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-robot mr-3 text-blue-500"></i>TECHWHIZ Assistant
                </h3>
                <div class="flex items-center">
                    <button id="clear-chat-btn" class="text-gray-500 hover:text-gray-900 text-2xl leading-none transition-transform duration-300 mr-4" aria-label="Clear Chat History" title="Clear Chat History">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                    <button id="close-techwhiz-modal" class="text-gray-500 hover:text-gray-900 text-4xl leading-none transition-transform duration-300 hover:rotate-90" aria-label="Close TECHWHIZ Assistant">&times;</button>
                </div>
            </div>
            <div id="chat-history" class="p-4 bg-gray-50 flex flex-col-reverse overflow-y-auto">
                <!-- Chat messages will be appended here -->
                <div class="chat-message assistant">Hello! I'm TECHWHIZ, your personal assistant for E-TECH SOLUTIONS. How can I help you today?</div>
            </div>
            <div class="p-4 border-t-2 border-gray-100 bg-white flex flex-col space-y-3">
                <div class="flex items-center space-x-2">
                    <input type="file" id="image-upload-input" accept="image/*" class="hidden" aria-label="Upload image for analysis">
                    <button id="upload-image-btn" class="btn-secondary py-2 px-3 rounded-full text-lg" aria-label="Upload Image">
                        <i class="fas fa-image"></i>
                    </button>
                    <input type="text" id="techwhiz-input" class="form-control flex-grow p-2" placeholder="Type your command or question..." aria-label="Text input for TECHWHiz Assistant">
                    <button id="mic-btn" class="btn-primary py-2 px-3 rounded-full text-lg" aria-label="Voice input">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <button id="send-btn" class="btn-primary py-2 px-3 rounded-full text-lg" aria-label="Send text command">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div class="flex justify-between items-center">
                    <button id="stop-speech-btn" class="btn-danger py-2 px-4 rounded-full text-sm" aria-label="Stop speaking">
                        <i class="fas fa-volume-mute mr-2"></i>Stop Speaking
                    </button>
                    <span id="listening-status" class="text-sm text-gray-600 italic hidden">Listening...</span>
                    <span id="thinking-status" class="text-sm text-blue-600 italic hidden">Thinking...</span>
                </div>
            </div>
        </div>
    </div>


    <!-- Footer with Social Media Links -->
    <footer class="bg-gray-900 text-white p-6 text-center shadow-inner mt-12">
        <div class="container mx-auto">
            <p class="text-lg mb-4 text-blue-100">&copy; 2025 E-TECH SOLUTIONS. All rights reserved.</p>
            <div class="flex justify-center space-x-6">
                <a href="https://www.instagram.com/yourprofile" target="_blank" class="text-3xl social-icon fa-instagram" aria-label="Visit us on Instagram">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://www.facebook.com/yourprofile" target="_blank" class="text-3xl social-icon fa-facebook" aria-label="Visit us on Facebook">
                    <i class="fab fa-facebook"></i>
                </a>
                <a href="https://www.youtube.com/yourchannel" target="_blank" class="text-3xl social-icon fa-youtube" aria-label="Visit us on YouTube">
                    <i class="fab fa-youtube"></i>
                </a>
            </div>
            <p class="mt-4 text-sm text-gray-400">Connect with us on social media!</p>
        </div>
    </footer>

    <!-- Firebase SDKs -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            createUserWithEmailAndPassword, 
            signInWithEmailAndPassword, 
            signOut, 
            onAuthStateChanged,
            sendEmailVerification,
            updateProfile
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore, 
            doc, 
            setDoc, 
            getDoc,
            updateDoc,
            arrayUnion
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // IMPORTANT: Replace with your actual Firebase configuration
       const firebaseConfig = {
            apiKey: "AIzaSyCyk9Jg_FW7jbVFh5XasK1Vb8_sP8J4zSE",
            authDomain: "etech-d39e5.firebaseapp.com",
            projectId: "etech-d39e5",
            storageBucket: "etech-d39e5.firebasestorage.app",
            messagingSenderId: "323388421053",
            appId: "1:323388421053:web:9057d22d4ee4b7450398d4",
            measurementId: "G-EV7M78EBGC"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Global variable to store current user's purchased courses
        let currentUserPurchasedCourses = [];
        let currentUserCourseProgress = {}; // New global variable for detailed progress
        let currentFilter = 'all'; // Default filter
        let currentSort = 'title-asc'; // Default sort

        // TECHWHIZ Assistant variables
        let recognition;
        let isListening = false;
        const synth = window.speechSynthesis;
        let currentUtterance = null;


        document.addEventListener('DOMContentLoaded', () => {
            // --- UI Element References ---
            const authSection = document.getElementById('auth-section');
            const courseSection = document.getElementById('course-section');
            const userInfo = document.getElementById('user-info');
            const userName = document.getElementById('user-name');
            const loginNavBtn = document.getElementById('login-nav-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const authError = document.getElementById('auth-error');
            const courseList = document.getElementById('course-list');
            const modal = document.getElementById('course-modal');
            const modalContent = modal.querySelector('.modal-content-container'); // Corrected selector
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            const closeModalBtn = document.getElementById('close-modal');
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            const courseSearch = document.getElementById('course-search');
            const courseFilter = document.getElementById('course-filter');
            const courseSort = document.getElementById('course-sort');
            const paymentHistoryBtn = document.getElementById('payment-history-btn');

            // TECHWHIZ Assistant UI Elements
            const techwhizFab = document.getElementById('techwhiz-fab');
            const techwhizModal = document.getElementById('techwhiz-modal');
            const closeTechwhizModalBtn = document.getElementById('close-techwhiz-modal');
            const chatHistory = document.getElementById('chat-history');
            const techwhizInput = document.getElementById('techwhiz-input');
            const micBtn = document.getElementById('mic-btn');
            const sendBtn = document.getElementById('send-btn');
            const stopSpeechBtn = document.getElementById('stop-speech-btn');
            const listeningStatus = document.getElementById('listening-status');
            const thinkingStatus = document.getElementById('thinking-status');
            const uploadImageBtn = document.getElementById('upload-image-btn');
            const imageUploadInput = document.getElementById('image-upload-input');
            const clearChatBtn = document.getElementById('clear-chat-btn');


            // --- Course Data (with prices) ---
            // Added 30-day learning agenda and video lectures (placeholder YouTube playlists)
            const courses = {
                'arduino-master': {
                    title: 'Arduino Master Class',
                    description: 'Go from beginner to expert with advanced projects, communication protocols, and real-world applications.',
                    image: 'https://lh3.googleusercontent.com/pw/AP1GczPvtSebwcEAoTS8k-OCNn_xZnUKH5rZXKAI4jLois7jfNsvPT14A1m11ZxNc1OFk6QXgYjp9lHolvmOWD8YnrbuP2acdqCFe_XIolbmvWSOd38hTmc=w2400',
                    price: 24900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Arduino Master Class</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Advanced C++ for Arduino - Deeper dive into pointers, classes, and object-oriented programming for efficient Arduino sketches.</li>
                            <li>Day 6-10: Interrupts and Timers - Learn how to use hardware interrupts and timers for precise timing and responsive event handling without blocking code.</li>
                            <li>Day 11-15: Communication Protocols (I2C, SPI) - Master inter-device communication using I2C for sensors and SPI for high-speed peripherals.</li>
                            <li>Day 16-20: Building a Home Automation System - Design and implement a multi-room home automation system using various sensors and actuators.</li>
                            <li>Day 21-25: Interfacing with Web APIs - Connect your Arduino to the internet, send data to cloud platforms, and control devices remotely via web APIs.</li>
                            <li>Day 26-30: Final Project: IoT Weather Station with Cloud Logging - Build a comprehensive weather station that collects data, logs it to a cloud database, and visualizes it.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLGs01L9dlz_k6Eexg8c-T0T5M-4aGGD_3" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'ai-robotics': {
                    title: 'AI for Robotics',
                    description: 'Dive into the world of Artificial Intelligence applied to robotics. Learn machine learning fundamentals, computer vision, and robot navigation.',
                    image: 'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 34900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: AI for Robotics</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to AI and Robotics - Understand the convergence of AI and robotics, ethical considerations, and real-world applications.</li>
                            <li>Day 6-10: Python for Robotics - Master Python programming for robot control, data processing, and scripting.</li>
                            <li>Day 11-15: Computer Vision with OpenCV - Implement image processing techniques, object detection, and facial recognition for robot perception.</li>
                            <li>Day 16-20: Path Planning Algorithms (A*, Dijkstra) - Learn and implement algorithms for efficient robot navigation in complex environments.</li>
                            <li>Day 21-25: Introduction to ROS (Robot Operating System) - Work with ROS for robot software development, including nodes, topics, and services.</li>
                            <li>Day 26-30: Final Project: Object Following Robot - Build an AI-powered robot that can detect and follow a specified object using computer vision.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLz_iWd0dC-sZdehFflfA2k6b7Ab72-L41" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'advanced-iot': {
                    title: 'Advanced IoT Development',
                    description: 'Master the Internet of Things with advanced development techniques, cloud integration, data analytics, and security best practices.',
                    image: 'https://images.unsplash.com/photo-1550751827-4bd374c3f58b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 49900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: AI for Robotics</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: IoT Architecture and Protocols (MQTT, CoAP) - Deep dive into common IoT communication protocols and their practical implementation.</li>
                            <li>Day 6-10: Cloud Platforms (AWS IoT, Google Cloud IoT) - Integrate IoT devices with leading cloud platforms for data ingestion and management.</li>
                            <li>Day 11-15: Edge Computing for IoT - Learn to process data closer to the source, reducing latency and bandwidth usage.</li>
                            <li>Day 16-20: IoT Security and Device Management - Implement robust security measures and manage large-scale IoT deployments.</li>
                            <li>Day 21-25: Data Visualization and Analytics - Analyze and visualize IoT data to gain insights and make informed decisions.</li>
                            <li>Day 26-30: Final Project: Smart Agriculture System - Develop an end-to-end smart agriculture solution with sensor data collection, cloud analytics, and automated irrigation.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PL-i-21uC2MA-e522qXp-o-4t5v_o7ksu" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'analog-electronics': {
                    title: 'Foundations of Analog Electronics',
                    description: 'Learn the core principles of analog circuits, including transistors, amplifiers, and operational amplifiers. Essential for hardware enthusiasts.',
                    image: 'https://images.unsplash.com/photo-1581091216694-dfc105b63486?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 79900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Foundations of Analog Electronics</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to Diodes and Rectifiers - Understand PN junctions, diode characteristics, and various rectifier configurations.</li>
                            <li>Day 6-10: Bipolar Junction Transistors (BJTs) - Explore BJT operation, biasing techniques, and their use as switches and amplifiers.</li>
                            <li>Day 11-15: Field-Effect Transistors (FETs) - Learn about JFETs and MOSFETs, their characteristics, and applications in circuit design.</li>
                            <li>Day 16-20: Operational Amplifiers (Op-Amps) - Master ideal op-amp characteristics, inverting and non-inverting configurations, and basic applications.</li>
                            <li>Day 21-25: Filters and Oscillators - Design and analyze active filters (low-pass, high-pass) and various oscillator circuits.</li>
                            <li>Day 26-30: Power Supplies and Voltage Regulation - Build stable regulated power supplies using Zener diodes, linear regulators, and switching regulators.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLB5bA3Q13V7Vj1m-G9x2j4j3Y7R0h5Y_2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'digital-electronics': {
                    title: 'Digital Logic Design',
                    description: 'Explore the building blocks of modern computers: logic gates, combinational and sequential circuits, and digital systems design.',
                    image: 'https://images.unsplash.com/photo-1593642702749-b687f27712d9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 89900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Digital Logic Design</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Boolean Algebra and Logic Gates - Master fundamental logic operations, truth tables, and common logic gates (AND, OR, NOT, XOR, etc.).</li>
                            <li>Day 6-10: Combinational Logic (Adders, Decoders) - Design and analyze combinational circuits like adders, subtractors, multiplexers, and decoders.</li>
                            <li>Day 11-15: Sequential Logic (Flip-Flops, Counters, Registers) - Understand the operation of various flip-flops (SR, JK, D, T) and design counters and shift registers.</li>
                            <li>Day 16-20: State Machines Design - Learn to design and implement finite state machines (FSMs) for control logic using state diagrams and state tables.</li>
                            <li>Day 21-25: Memory Devices (RAM, ROM) - Explore the architecture and operation of different types of digital memory, including RAM and ROM.</li>
                            <li>Day 26-30: Introduction to FPGAs and VHDL/Verilog - Get started with Field-Programmable Gate Arrays (FPGAs) and learn basic hardware description languages like VHDL or Verilog for digital system implementation.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLB5bA3Q13V7Vj1m-G9x2j4j3Y7R0h5Y_2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'embedded-systems': {
                    title: 'Embedded Systems Design',
                    description: 'Explore the design and implementation of embedded systems, covering microcontrollers, RTOS, and hardware-software co-design.',
                    image: 'https://images.unsplash.com/photo-1596541223940-272ec22295a0?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 159900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Embedded Systems Design</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to Microcontrollers (e.g., ESP32/STM32) - Understand microcontroller architecture, pin configurations, and basic programming setup.</li>
                            <li>Day 6-10: GPIO, Timers, and Interrupts - Master general-purpose I/O, precise timing with timers, and responsive interrupt-driven programming.</li>
                            <li>Day 11-15: Communication Interfaces (UART, SPI, I2C) - Implement standard communication protocols for interfacing with sensors and other devices.</li>
                            <li>Day 16-20: Real-Time Operating Systems (RTOS) Concepts - Learn about RTOS, task scheduling, inter-task communication, and synchronization.</li>
                            <li>Day 21-25: Sensor Interfacing and Data Acquisition - Connect various sensors (temperature, humidity, motion) and acquire data effectively.</li>
                            <li>Day 26-30: Final Project: Smart Home Energy Monitor - Develop an embedded system that monitors home energy consumption and sends data to a local display or cloud.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLlxT8hQ-1_K1V5sK1E3j8f8Y7G9L7R0h4" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'wireless-communication': {
                    title: 'Wireless Communication Systems',
                    description: 'Delve into the fundamentals of wireless communication, including modulation techniques, antenna theory, and practical wireless network design.',
                    image: 'https://images.unsplash.com/photo-1629904869389-c48c909618a8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 119900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Wireless Communication Systems</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to RF and Antennas - Understand basic RF concepts, electromagnetic waves, and antenna fundamentals.</li>
                            <li>Day 6-10: Modulation Techniques (AM, FM, PM) - Learn about analog modulation techniques and their application in radio communication.</li>
                            <li>Day 11-15: Digital Modulation (ASK, FSK, PSK) - Explore digital modulation schemes, their advantages, and implementation.</li>
                            <li>Day 16-20: Wireless Channel Characteristics - Understand fading, multipath, and noise effects on wireless signals.</li>
                            <li>Day 21-25: Wireless Network Architectures (Wi-Fi, Bluetooth, Zigbee) - Study common short-range wireless technologies and their protocols.</li>
                            <li>Day 26-30: Final Project: Simple Wireless Data Link - Build a basic wireless data transmission system using popular modules like NRF24L01.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLB5bA3Q13V7Vj1m-G9x2j4j3Y7R0h5Y_2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'smart-city-solutions': {
                    title: 'Smart City IoT Solutions',
                    description: 'Design and implement scalable IoT solutions for smart cities, covering infrastructure, data management, and public services.',
                    image: 'https://images.unsplash.com/photo-1519782806532-61d0f5e30c88?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 169900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Smart City IoT Solutions</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to Smart Cities and IoT - Overview of smart city concepts, challenges, and the role of IoT.</li>
                            <li>Day 6-10: Smart Lighting and Energy Management - Implement IoT solutions for intelligent street lighting and energy monitoring.</li>
                            <li>Day 11-15: Smart Waste Management Systems - Design and prototype IoT-based smart bins for optimized waste collection.</li>
                            <li>Day 16-20: Environmental Monitoring with IoT - Deploy sensors for air quality, noise, and water monitoring in urban areas.</li>
                            <li>Day 21-25: Smart Transportation and Parking - Develop IoT solutions for traffic management, smart parking, and public transport tracking.</li>
                            <li>Day 26-30: Final Project: Connected Public Safety System - Build an IoT system for real-time monitoring and alerting for public safety incidents in a city block.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PL-i-21uC2MA-e522qXp-o-4t5v_o7ksu" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'rfid-iot': {
                    title: 'RFID & NFC in IoT',
                    description: 'Learn about Radio-Frequency Identification (RFID) and Near Field Communication (NFC) technologies and their practical applications in IoT systems for tracking and authentication.',
                    image: 'https://images.unsplash.com/photo-1628178651842-178693c0429f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 39900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: RFID & NFC in IoT</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to RFID and NFC - Understand the principles, types (active/passive, high/low frequency), and applications of RFID and NFC.</li>
                            <li>Day 6-10: RFID Reader and Tag Interfacing - Learn to connect and communicate with RFID readers and various types of tags using microcontrollers.</li>
                            <li>Day 11-15: NFC Communication Modes - Explore NFC's reader/writer, peer-to-peer, and card emulation modes.</li>
                            <li>Day 16-20: Data Security in RFID/NFC Systems - Implement encryption and other security measures for secure data transmission.</li>
                            <li>Day 21-25: IoT Integration with RFID/NFC - Integrate RFID/NFC data with cloud platforms for asset tracking and inventory management.</li>
                            <li>Day 26-30: Final Project: Smart Inventory Management System - Build an IoT system that tracks inventory using RFID/NFC tags and updates a cloud database in real-time.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PL-i-21uC2MA-e522qXp-o-4t5v_o7ksu" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'wearable-tech-design': {
                    title: 'Wearable Technology Design',
                    description: 'Explore the exciting field of wearable electronics, from sensor integration and low-power design to data collection and mobile app connectivity.',
                    image: 'https://images.unsplash.com/photo-1600100684074-a6907409f582?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 39900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Wearable Technology Design</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to Wearable Electronics - History, current trends, and future of wearable devices.</li>
                            <li>Day 6-10: Sensor Selection and Integration - Choose and interface with various sensors for biometric data, motion tracking, and environmental monitoring.</li>
                            <li>Day 11-15: Low-Power Design Principles - Optimize circuits and code for extended battery life in wearable devices.</li>
                            <li>Day 16-20: Flexible Electronics and E-Textiles - Explore non-rigid circuit boards and integrating electronics into fabrics.</li>
                            <li>Day 21-25: Data Communication for Wearables (Bluetooth LE) - Implement efficient wireless communication for transferring data to smartphones or other devices.</li>
                            <li>Day 26-30: Final Project: Smart Fitness Tracker - Design and prototype a wearable device that tracks activity, heart rate, and syncs data to a mobile application.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLB5bA3Q13V7Vj1m-G9x2j4j3Y7R0h5Y_2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'medical-iot': {
                    title: 'Medical IoT Devices',
                    description: 'Understand the design and application of IoT devices in healthcare, focusing on patient monitoring, data security, and regulatory compliance.',
                    image: 'https://images.unsplash.com/photo-1576091160399-be97b7922d21?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 79900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Medical IoT Devices</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to IoMT (Internet of Medical Things) - Overview of medical IoT, its impact on healthcare, and ethical considerations.</li>
                            <li>Day 6-10: Biosensors and Data Acquisition - Learn to interface with common biosensors (ECG, SpO2, temperature) and acquire physiological data.</li>
                            <li>Day 11-15: Data Processing and Analytics for Health Data - Process raw sensor data and apply basic analytics for insights into patient health.</li>
                            <li>Day 16-20: Communication Protocols in Healthcare (Bluetooth, Wi-Fi, LoRa) - Understand secure and reliable data transmission for medical devices.</li>
                            <li>Day 21-25: Regulatory Compliance and Data Privacy (HIPAA, GDPR) - Learn about critical regulations and standards for medical device development.</li>
                            <li>Day 21-25: Regulatory Compliance and Data Privacy (HIPAA, GDPR) - Learn about critical regulations and standards for medical device development.</li>
                            <li>Day 26-30: Final Project: Remote Patient Monitoring System - Develop an IoT system that remotely monitors a patient's vital signs and sends alerts to caregivers.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLB5bA3Q13V7Vj1m-G9x2j4j3Y7R0h5Y_2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'industrial-iot': {
                    title: 'Industrial IoT (IIoT) & Industry 4.0',
                    description: 'Dive into the world of Industrial IoT, learning about smart factories, predictive maintenance, and data-driven decision-making in industrial settings.',
                    image: 'https://images.unsplash.com/photo-1596245084940-02a806c9a3e6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 89900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: Industrial IoT (IIoT) & Industry 4.0</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to IIoT and Industry 4.0 - Understand the concepts, benefits, and challenges of digital transformation in industry.</li>
                            <li>Day 6-10: Industrial Sensors and Actuators - Learn about sensors used in industrial environments (e.g., vibration, pressure, flow) and their interfacing.</li>
                            <li>Day 11-15: Industrial Communication Protocols (Modbus, OPC UA) - Master protocols for reliable data exchange in factory settings.</li>
                            <li>Day 16-20: Edge Analytics for IIoT - Implement data processing at the edge for real-time insights and reduced latency.</li>
                            <li>Day 21-25: Predictive Maintenance Systems - Design and implement systems that use sensor data to predict equipment failures.</li>
                            <li>Day 26-30: Final Project: Smart Factory Anomaly Detection - Develop an IIoT solution that monitors machinery for abnormal behavior and alerts maintenance teams.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PL-i-21uC2MA-e522qXp-o-4t5v_o7ksu" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                },
                'robot-operating-system': {
                    title: 'ROS (Robot Operating System) Fundamentals',
                    description: 'Get started with ROS, the flexible framework for writing robot software. Learn about nodes, topics, services, and practical robot simulation.',
                    image: 'https://images.unsplash.com/photo-1596245084940-02a806c9a3e6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80',
                    price: 49900.00,
                    totalDays: 30, // New: Total days for the course
                    content: `
                        <h4 class="text-xl font-bold mb-4">30-Day Learning Agenda: ROS (Robot Operating System) Fundamentals</h4>
                        <ul class="list-disc list-inside space-y-2 mb-6">
                            <li>Day 1-5: Introduction to ROS and Linux Basics - Understand the ROS ecosystem and essential Linux commands for robot development.</li>
                            <li>Day 6-10: ROS Nodes, Topics, and Messages - Learn the core communication concepts in ROS for building distributed robot applications.</li>
                            <li>Day 11-15: ROS Services and Actions - Implement request-response and long-running goal-oriented communication patterns.</li>
                            <li>Day 16-20: ROS Package Creation and Workspaces - Organize your robot code into reusable packages and manage your ROS projects.</li>
                            <li>Day 21-25: Robot Simulation with Gazebo and RViz - Simulate robots in virtual environments and visualize sensor data and robot states.</li>
                            <li>Day 26-30: Final Project: Simple Mobile Robot Navigation - Program a simulated mobile robot to navigate a known environment using ROS.</li>
                        </ul>
                        <h4 class="text-xl font-bold mb-4">Video Lectures</h4>
                        <div class="aspect-w-16 aspect-h-9 mb-8">
                            <iframe src="https://www.youtube.com/embed/videoseries?list=PLz_iWd0dC-sZdehFflfA2k6b7Ab72-L41" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full rounded-lg shadow-xl"></iframe>
                        </div>`
                }
            };

            // --- Authentication State Listener ---
            onAuthStateChanged(auth, async user => {
                if (user) {
                    // User is signed in
                    if (user.emailVerified) {
                        console.log("User is signed in and verified:", user);
                        // Fetch user data including purchased courses and progress
                        const userDocRef = doc(db, "users", user.uid);
                        const userDocSnap = await getDoc(userDocRef);
                        if (userDocSnap.exists()) {
                            const userData = userDocSnap.data();
                            currentUserPurchasedCourses = userData.purchasedCourses || [];
                            currentUserCourseProgress = userData.courseProgress || {}; // Load progress
                            console.log("Purchased Courses:", currentUserPurchasedCourses);
                            console.log("Course Progress:", currentUserCourseProgress);
                        } else {
                            // If user document doesn't exist (shouldn't happen after registration), create it
                            await setDoc(userDocRef, {
                                name: user.displayName || user.email,
                                email: user.email,
                                createdAt: new Date(),
                                purchasedCourses: [],
                                courseProgress: {} // Initialize empty progress
                            });
                            currentUserPurchasedCourses = [];
                            currentUserCourseProgress = {};
                        }
                        setupUIForLoggedInUser(user);
                    } else {
                        console.log("User is signed in but not verified.");
                        showToast('Please check your email to verify your account.', 'warning');
                        setupUIForLoggedOutUser();
                    }
                } else {
                    // User is signed out
                    console.log("User is signed out.");
                    currentUserPurchasedCourses = []; // Clear purchased courses on logout
                    currentUserCourseProgress = {}; // Clear progress on logout
                    setupUIForLoggedOutUser();
                }
            });

            // --- UI Setup Functions ---
            function setupUIForLoggedInUser(user) {
                authSection.classList.add('hidden');
                courseSection.classList.remove('hidden');
                userInfo.classList.remove('hidden');
                loginNavBtn.classList.add('hidden');
                paymentHistoryBtn.classList.remove('hidden'); // Show payment history button
                userName.textContent = `Welcome, ${user.displayName || user.email}`;
                displayCourses(); // Re-display courses with logged-in state
            }

            function setupUIForLoggedOutUser() {
                authSection.classList.remove('hidden');
                courseSection.classList.add('hidden');
                userInfo.classList.add('hidden');
                loginNavBtn.classList.remove('hidden');
                paymentHistoryBtn.classList.add('hidden'); // Hide payment history button
            }
            
            loginNavBtn.addEventListener('click', () => {
                 authSection.classList.remove('hidden');
                 courseSection.classList.add('hidden');
            });

            // --- Registration Logic ---
            registerForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('register-name').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                
                toggleLoader(registerForm, true, 'Creating Account...');
                authError.textContent = '';

                try {
                    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                    const user = userCredential.user;

                    // Update user's profile with their name
                    await updateProfile(user, { displayName: name });

                    // Send verification email
                    await sendEmailVerification(user);
                    
                    // Store user info in Firestore
                    await setDoc(doc(db, "users", user.uid), {
                        name: name,
                        email: email,
                        createdAt: new Date(),
                        purchasedCourses: [], // Initially empty
                        courseProgress: {} // Initialize empty progress
                    });

                    showToast('Registration successful! Please check your email to verify your account.', 'success');
                    await signOut(auth); // Sign out until they verify
                    
                } catch (error) {
                    console.error("Registration Error:", error);
                    authError.textContent = getFriendlyAuthError(error.code);
                } finally {
                    toggleLoader(registerForm, false);
                }
            });

            // --- Login Logic ---
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;

                toggleLoader(loginForm, true, 'Logging In...');
                authError.textContent = '';

                try {
                    const userCredential = await signInWithEmailAndPassword(auth, email, password);
                    if (!userCredential.user.emailVerified) {
                         await signOut(auth);
                         authError.textContent = 'Please verify your email before logging in.';
                         showToast('Verification required. A new verification email has been sent.', 'warning');
                         await sendEmailVerification(userCredential.user);
                    } else {
                         // onAuthStateChanged will handle the UI update
                         showToast('Login successful!', 'success');
                    }
                } catch (error) {
                    console.error("Login Error:", error);
                    authError.textContent = getFriendlyAuthError(error.code);
                } finally {
                    toggleLoader(loginForm, false);
                }
            });

            // --- Logout Logic ---
            logoutBtn.addEventListener('click', async () => {
                try {
                    await signOut(auth);
                    showToast('You have been logged out.', 'info');
                } catch (error) {
                    console.error("Logout Error:", error);
                    showToast('Error logging out. Please try again.', 'error');
                }
            });

            // --- Course Display Logic ---
            function displayCourses() {
                courseList.innerHTML = '';
                let coursesArray = Object.keys(courses).map(id => ({ id, ...courses[id] }));

                // Apply Search Filter
                const searchTerm = courseSearch.value.toLowerCase();
                if (searchTerm) {
                    coursesArray = coursesArray.filter(course =>
                        course.title.toLowerCase().includes(searchTerm) ||
                        course.description.toLowerCase().includes(searchTerm)
                    );
                }

                // Apply Course Filter
                coursesArray = coursesArray.filter(course => {
                    const isPurchased = currentUserPurchasedCourses.includes(course.id) || course.price === 0;
                    const courseProgress = currentUserCourseProgress[course.id];
                    const currentDay = courseProgress?.currentDay || 0;
                    const totalDays = course.totalDays || 30;
                    const isCompleted = currentDay >= totalDays && isPurchased;
                    const isInProgress = currentDay > 0 && currentDay < totalDays && isPurchased;

                    switch (currentFilter) {
                        case 'all': return true;
                        case 'free': return course.price === 0;
                        case 'paid': return course.price > 0;
                        case 'purchased': return isPurchased;
                        case 'in-progress': return isInProgress;
                        case 'completed': return isCompleted;
                        default: return true;
                    }
                });

                // Apply Sorting
                coursesArray.sort((a, b) => {
                    let compareA, compareB;
                    let result = 0;

                    switch (currentSort) {
                        case 'title-asc':
                            result = a.title.localeCompare(b.title);
                            break;
                        case 'title-desc':
                            result = b.title.localeCompare(a.title);
                            break;
                        case 'price-asc':
                            result = a.price - b.price;
                            break;
                        case 'price-desc':
                            result = b.price - a.price;
                            break;
                        case 'progress-asc':
                            // Sort by progress (lower % first), then by title
                            const progressA = (currentUserCourseProgress[a.id]?.currentDay || 0) / (a.totalDays || 30);
                            const progressB = (currentUserCourseProgress[b.id]?.currentDay || 0) / (b.totalDays || 30);
                            result = progressA - progressB;
                            if (result === 0) result = a.title.localeCompare(b.title);
                            break;
                        case 'progress-desc':
                            // Sort by progress (higher % first), then by title
                            const progA = (currentUserCourseProgress[a.id]?.currentDay || 0) / (a.totalDays || 30);
                            const progB = (currentUserCourseProgress[b.id]?.currentDay || 0) / (b.totalDays || 30);
                            result = progB - progA;
                            if (result === 0) result = a.title.localeCompare(b.title);
                            break;
                        default:
                            result = a.title.localeCompare(b.title); // Default to title asc
                    }
                    return result;
                });

                if (coursesArray.length === 0) {
                    courseList.innerHTML = '<p class="text-center text-gray-600 text-xl col-span-full">No courses found matching your criteria.</p>';
                    return;
                }

                coursesArray.forEach((course, index) => {
                    // If price is 0, consider it purchased for display purposes
                    const isPurchased = currentUserPurchasedCourses.includes(course.id) || course.price === 0;
                    const courseCard = document.createElement('div');
                    
                    courseCard.className = 'bg-white rounded-lg shadow-lg overflow-hidden transform hover:scale-105 transition duration-300 course-card'; 
                    courseCard.style.animationDelay = `${index * 0.1}s`; 

                    const currentDay = currentUserCourseProgress[course.id]?.currentDay || 0;
                    const totalDays = course.totalDays || 30; // Default to 30 if not specified
                    const progressPercentage = (currentDay / totalDays) * 100;
                    const isCourseCompleted = currentDay >= totalDays;

                    courseCard.innerHTML = `
                        <div class="h-56 overflow-hidden">
                            <img src="${course.image}" alt="${course.title}" class="w-full h-full object-cover">
                        </div>
                        <div class="p-6">
                            <h3 class="text-2xl font-bold mb-2 text-gray-900">${course.title}</h3>
                            <p class="text-gray-600 mb-4">${course.description}</p>
                            ${isPurchased ? 
                                `<div class="${isCourseCompleted ? 'course-completed' : ''}">
                                    <div class="progress-container">
                                        <div class="progress-bar" style="width: ${progressPercentage}%;">
                                            ${progressPercentage.toFixed(0)}%
                                        </div>
                                    </div>
                                    <p class="progress-text-small text-right mt-1">
                                        ${isCourseCompleted ? 'Completed!' : `Day ${currentDay} of ${totalDays}`}
                                    </p>
                                    <button data-course-id="${course.id}" class="view-course-btn w-full btn-secondary font-bold py-2 px-4 rounded-full mt-4">View Course</button>
                                </div>` :
                                `<button data-course-id="${course.id}" data-course-price="${course.price}" class="buy-course-btn w-full btn-primary font-bold py-2 px-4 rounded-full">
                                    Buy Now - ₹${(course.price / 100).toFixed(2)}
                                </button>`
                            }
                        </div>`;
                    courseList.appendChild(courseCard);

                    // Add the animate-in class after appending to trigger animation
                    setTimeout(() => {
                        courseCard.classList.add('animate-in');
                    }, 50); 
                });

                // Add event listeners for "View Course" and "Buy Now" buttons
                document.querySelectorAll('.view-course-btn').forEach(button => {
                    button.addEventListener('click', (e) => openCourseModal(e.target.dataset.courseId));
                });
                document.querySelectorAll('.buy-course-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const courseId = e.target.dataset.courseId;
                        const coursePrice = parseInt(e.target.dataset.coursePrice);
                        const courseTitle = courses[courseId].title;
                        // If course price is 0, treat as purchased directly without Razorpay
                        if (coursePrice === 0) {
                            const user = auth.currentUser;
                            if (user) {
                                // Add to purchased courses in Firestore if not already there
                                const userDocRef = doc(db, "users", user.uid);
                                updateDoc(userDocRef, {
                                    purchasedCourses: arrayUnion(courseId)
                                }).then(() => {
                                    currentUserPurchasedCourses.push(courseId); // Update local state
                                    showToast(`'${courseTitle}' is now accessible!`, 'success');
                                    displayCourses(); // Refresh to show "View Course"
                                    openCourseModal(courseId); // Open the course immediately
                                }).catch(firestoreError => {
                                    console.error("Error updating Firestore for free course:", firestoreError);
                                    showToast('Failed to update course access. Please try again.', 'error');
                                });
                            } else {
                                showToast('Please log in to access this course.', 'error');
                                loginNavBtn.click();
                            }
                        } else {
                            initiateRazorpayPayment(courseId, coursePrice, courseTitle);
                        }
                    });
                });
            }

            // --- Modal Logic ---
            function openCourseModal(courseId) {
                const course = courses[courseId];
                modalTitle.textContent = course.title;

                // Current user progress for this course
                let currentDay = currentUserCourseProgress[courseId]?.currentDay || 0;
                const totalDays = course.totalDays || 30;
                let progressPercentage = (currentDay / totalDays) * 100;
                let isCourseCompleted = currentDay >= totalDays;

                // Check if the user has purchased this course OR if its price is 0
                if (!currentUserPurchasedCourses.includes(courseId) && course.price !== 0) {
                    modalBody.innerHTML = `
                        <div class="p-6 text-center">
                            <i class="fas fa-lock text-red-500 text-6xl mb-4"></i>
                            <h4 class="text-2xl font-bold mb-2">Course Not Purchased</h4>
                            <p class="text-gray-700 mb-4">You need to purchase this course to access its content.</p>
                            <button data-course-id="${courseId}" data-course-price="${course.price}" class="buy-course-modal-btn btn-primary font-bold py-2 px-4 rounded-full">
                                Buy Now - ₹${(course.price / 100).toFixed(2)}
                            </button>
                        </div>
                    `;
                    // Add event listener for the buy button inside the modal
                    document.querySelector('.buy-course-modal-btn').addEventListener('click', (e) => {
                        const courseId = e.target.dataset.courseId;
                        const coursePrice = parseInt(e.target.dataset.coursePrice);
                        const courseTitle = courses[courseId].title;
                        closeModalBtn.click(); // Close modal before payment
                        initiateRazorpayPayment(courseId, coursePrice, courseTitle);
                    });

                } else {
                    // Course is purchased or free, display content and AI tools
                    const whatsappMessage = encodeURIComponent(`Check out this awesome course on E-TECH SOLUTIONS: ${course.title}! You can find it here: ${window.location.href}`);
                    modalBody.innerHTML = `
                        <!-- Course Progress Section -->
                        <div class="bg-blue-50 p-6 rounded-xl shadow-md mb-6 flex items-center justify-between">
                            <div>
                                <h4 class="text-xl font-bold text-blue-800 mb-2">Your Progress: <span id="modal-progress-text">${currentDay} of ${totalDays} Days</span></h4>
                                <div class="progress-container h-4 w-64">
                                    <div id="modal-progress-bar" class="progress-bar" style="width: ${progressPercentage}%;">
                                        ${progressPercentage.toFixed(0)}%
                                    </div>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button id="mark-day-complete-btn" data-course-id="${courseId}" class="btn-primary py-2 px-4 rounded-full text-sm" ${currentDay >= totalDays ? 'disabled' : ''}>
                                    Mark Day ${currentDay + 1} Complete
                                </button>
                                <button id="mark-course-complete-btn" data-course-id="${courseId}" class="btn-secondary py-2 px-4 rounded-full text-sm" ${currentDay >= totalDays ? 'disabled' : ''}>
                                    Mark Course Completed
                                </button>
                                ${isCourseCompleted ? `<button id="download-certificate-btn" class="btn-secondary py-2 px-4 rounded-full text-sm ml-2"><i class="fas fa-certificate mr-2"></i> Download Certificate</button>` : ''}
                            </div>
                        </div>

                        <div class="prose max-w-none text-gray-700">
                            ${course.content}
                        </div>
                        <div class="flex justify-end my-6">
                            <a href="https://wa.me/?text=${whatsappMessage}" target="_blank" class="btn-secondary font-bold py-2 px-4 rounded-full flex items-center" aria-label="Share on WhatsApp">
                                <i class="fab fa-whatsapp mr-2"></i> Share on WhatsApp
                            </a>
                        </div>
                    `;

                    // Progress buttons
                    document.getElementById('mark-day-complete-btn').addEventListener('click', (e) => markProgress(e.currentTarget.dataset.courseId, 1));
                    document.getElementById('mark-course-complete-btn').addEventListener('click', (e) => markProgress(e.currentTarget.dataset.courseId, totalDays));
                    // Certificate button (only if course is completed)
                    const downloadCertificateBtn = document.getElementById('download-certificate-btn');
                    if (downloadCertificateBtn) {
                        downloadCertificateBtn.addEventListener('click', () => downloadCertificate(course.title));
                    }
                }

                modal.classList.remove('hidden');
                modal.classList.add('flex');
                // Focus management for modal
                setTimeout(() => {
                    modalContent.classList.add('active'); // Use the 'active' class for transition
                    modal.focus(); // Focus the modal itself
                    const focusableElements = modalContent.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                    const firstFocusableElement = focusableElements[0];
                    if (firstFocusableElement) {
                        firstFocusableElement.focus();
                    }
                }, 10);
            }

            // --- Progress Tracking Functions ---
            async function markProgress(courseId, daysToAdvance) {
                const user = auth.currentUser;
                if (!user) {
                    showToast('Please log in to track your progress.', 'error');
                    return;
                }

                const course = courses[courseId];
                const totalDays = course.totalDays || 30;
                let currentDay = currentUserCourseProgress[courseId]?.currentDay || 0;
                let newDay = Math.min(currentDay + daysToAdvance, totalDays);

                if (daysToAdvance === totalDays) { // If marking course complete
                    newDay = totalDays;
                }

                if (newDay === currentDay) {
                    showToast('You are already at the latest day for this course or it\'s completed!', 'info');
                    return;
                }

                try {
                    const userDocRef = doc(db, "users", user.uid);
                    // Update nested map using dot notation
                    await updateDoc(userDocRef, {
                        [`courseProgress.${courseId}.currentDay`]: newDay,
                        [`courseProgress.${courseId}.lastUpdated`]: new Date()
                    });
                    
                    currentUserCourseProgress[courseId] = {
                        currentDay: newDay,
                        lastUpdated: new Date()
                    }; // Update local state

                    showToast(`Progress updated! You are now on Day ${newDay} of ${totalDays} for ${course.title}.`, 'success');
                    
                    // Refresh the modal and course list to reflect new progress
                    displayCourses(); 
                    openCourseModal(courseId); // Re-open modal to show updated progress and certificate button
                } catch (error) {
                    console.error("Error updating progress:", error);
                    showToast('Failed to update progress. Please try again.', 'error');
                }
            }

            // --- Certificate Download Function (Placeholder) ---
            function downloadCertificate(courseTitle) {
                const user = auth.currentUser;
                if (!user || !user.displayName) {
                    showToast('Please log in with a name to generate a certificate.', 'error');
                    return;
                }
                const userName = user.displayName;
                const date = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                const certificateText = `
                    This certifies that
                    ${userName}
                    has successfully completed the
                    "${courseTitle}"
                    course on E-TECH SOLUTIONS.
                    Date: ${date}
                `;
                // In a real application, you'd generate a more elaborate PDF/image.
                // For demonstration, we'll create a simple text file.
                const blob = new Blob([certificateText], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Certificate_${courseTitle.replace(/\s+/g, '_')}_${userName.replace(/\s+/g, '_')}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showToast('Certificate download initiated!', 'info');
            }


            // --- Razorpay Payment Integration ---
            function initiateRazorpayPayment(courseId, amount, courseTitle) {
                const user = auth.currentUser;
                if (!user) {
                    showToast('Please log in to purchase courses.', 'error');
                    // Optionally, redirect to login or show login modal
                    loginNavBtn.click(); // Simulate click on login/register button
                    return;
                }

                const options = {
                    key: "rzp_live_4cpkH5xviXonf3", // Replace with your actual Test API Key
                    amount: amount, // Amount in paise (e.g., 10000 for ₹100.00)
                    currency: "INR",
                    name: "E-TECH SOLUTIONS",
                    description: `Purchase of ${courseTitle} Course`,
                    image: "https://lh3.googleusercontent.com/pw/AP1GczNty6_2Cq0hySwk_JWjLVcINZz0lyqfq9BNLXjr9-qhG_94UV7oQLhTNB7VtAP8qM1G1G06Gj36pEqbZyvBWZlV4508OriC45KwQoabQ8qSRc5HHMGPVu=w2400?source=screenshot.guru",
                    handler: async function (response) {
                        // This function is called on successful payment
                        console.log("Payment Success:", response);
                        try {
                            // Update user's purchased courses in Firestore
                            const userDocRef = doc(db, "users", user.uid);
                            await updateDoc(userDocRef, {
                                purchasedCourses: arrayUnion(courseId)
                            });
                            currentUserPurchasedCourses.push(courseId); // Update local state
                            showToast(`Successfully purchased ${courseTitle}!`, 'success');
                            displayCourses(); // Refresh course list to show "View Course"
                        } catch (firestoreError) {
                            console.error("Error updating Firestore after payment:", firestoreError);
                            showToast('Payment successful, but failed to update course access. Please contact support.', 'error');
                        }
                    },
                    prefill: {
                        name: user.displayName || '',
                        email: user.email || '',
                        contact: '' // Optional: User's contact number
                    },
                    notes: {
                        course_id: courseId,
                        user_id: user.uid
                    },
                    theme: {
                        color: "#3b82f6" // Primary blue color
                    }
                };

                const rzp = new Razorpay(options);
                rzp.on('payment.failed', function (response) {
                    console.error("Payment Failed:", response);
                    showToast(`Payment for ${courseTitle} failed. Reason: ${response.error.description || 'Unknown error'}`, 'error');
                });
                rzp.open();
            }

            // --- Payment History Placeholder ---
            paymentHistoryBtn.addEventListener('click', () => {
                showToast('Payment history feature coming soon!', 'info');
                // Implement actual payment history display here.
                // This would involve fetching payment records from Firestore (if stored there)
                // or calling a backend API that integrates with Razorpay for past transactions.
            });


            async function handlePlanGeneration(e) {
                const button = e.currentTarget;
                const userGoal = document.getElementById('learning-goal').value;
                const outputContainer = document.getElementById('ai-plan-output');
                if (!userGoal) {
                    outputContainer.innerHTML = '<p class="text-red-500">Please enter your learning goal.</p>';
                    showToast('Please enter your learning goal.', 'error');
                    return;
                }
                toggleLoader(button, true, 'Generating...');
                outputContainer.innerHTML = '<p class="text-blue-500 flex items-center justify-center"><div class="loader mr-2"></div> Generating plan...</p>'; // Loading indicator
                const course = courses[button.dataset.courseId]; // Get course using dataset
                const prompt = `You are an expert curriculum designer. A student is taking the course: "${course.title}". The student's goal is: "${userGoal}". Create a personalized, day-by-day learning plan. Format it as simple HTML with h4 for days and ul/li for tasks. Ensure the HTML is well-formed and ready for direct insertion.`;
                try {
                    const generatedPlan = await callGeminiApi(prompt);
                    outputContainer.innerHTML = generatedPlan;
                    showToast('Learning plan generated!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error generating your plan. Please try again.</p>';
                    showToast('Error generating plan.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            async function handleConceptExplanation(e) {
                const button = e.currentTarget;
                const conceptInput = document.getElementById('concept-input').value;
                const outputContainer = document.getElementById('ai-explanation-output');
                if (!conceptInput) {
                    outputContainer.innerHTML = '<p class="text-red-500">Please enter a concept to explain.</p>';
                    showToast('Please enter a concept to explain.', 'error');
                    return;
                }
                toggleLoader(button, true, 'Explaining...');
                outputContainer.innerHTML = '<p class="text-yellow-500 flex items-center justify-center"><div class="loader mr-2"></div> Explaining concept...</p>';
                const course = courses[button.dataset.courseId];
                const prompt = `Explain the concept "${conceptInput}" clearly and concisely, specifically in the context of the "${course.title}" course. Provide a simple explanation, and if applicable, a small example or analogy. Format as simple HTML paragraphs.`;
                try {
                    const explanation = await callGeminiApi(prompt);
                    outputContainer.innerHTML = explanation;
                    showToast('Concept explained!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error explaining the concept. Please try again.</p>';
                    showToast('Error explaining concept.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            async function handleStudyNotesGeneration(e) {
                const button = e.currentTarget;
                const outputContainer = document.getElementById('ai-notes-output');
                toggleLoader(button, true, 'Generating Notes...');
                outputContainer.innerHTML = '<p class="text-cyan-500 flex items-center justify-center"><div class="loader mr-2"></div> Generating notes...</p>';
                const course = courses[button.dataset.courseId];
                const prompt = `Generate concise, bullet-point study notes for the course "${course.title}". Focus on the key topics and concepts mentioned in its description and modules. Format them as simple HTML with a main heading and bulleted list.`;
                try {
                    const notes = await callGeminiApi(prompt);
                    outputContainer.innerHTML = notes;
                    showToast('Study notes generated!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error generating study notes. Please try again.</p>';
                    showToast('Error generating notes.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            async function handleQuizGeneration(e) {
                const button = e.currentTarget;
                const outputContainer = document.getElementById('ai-quiz-output');
                toggleLoader(button, true, 'Generating Quiz...');
                outputContainer.innerHTML = '<p class="text-green-500 flex items-center justify-center"><div class="loader mr-2"></div> Generating quiz...</p>';
                const course = courses[button.dataset.courseId];
                const prompt = `Generate a 3-question multiple-choice quiz about "${course.title}". Each question should have 4 options (A, B, C, D) and indicate the correct answer. Provide the output as a JSON array of objects, where each object has "question", "options" (an array of strings), and "answer" (a string matching one of the options).`;

                // Define the structured response schema
                const responseSchema = {
                    type: "ARRAY",
                    items: {
                        type: "OBJECT",
                        properties: {
                            "question": { "type": "STRING" },
                            "options": {
                                "type": "ARRAY",
                                "items": { "type": "STRING" }
                            },
                            "answer": { "type": "STRING" }
                        },
                        "required": ["question", "options", "answer"],
                        "propertyOrdering": ["question", "options", "answer"]
                    }
                };

                try {
                    const quizJson = await callGeminiApi(prompt, responseSchema);
                    const quiz = JSON.parse(quizJson);
                    let quizHtml = '<h4 class="text-xl font-bold mb-4">Your Quiz:</h4>';
                    quiz.forEach((q, index) => {
                        quizHtml += `<div class="mb-4 p-4 bg-white rounded-lg shadow-sm">
                                        <p class="font-semibold text-lg mb-2">Q${index + 1}: ${q.question}</p>
                                        <ul class="list-none space-y-1">`;
                        q.options.forEach(option => {
                            quizHtml += `<li class="ml-4">${option}</li>`;
                        });
                        quizHtml += `</ul>
                                     <p class="mt-2 text-green-700 font-medium">Correct Answer: ${q.answer}</p>
                                   </div>`;
                    });
                    outputContainer.innerHTML = quizHtml;
                    showToast('Quiz generated!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error generating the quiz. Please try again.</p>';
                    showToast('Error generating quiz.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            // --- New AI Feature: Project Idea Generation ---
            async function handleProjectIdeaGeneration(e) {
                const button = e.currentTarget;
                const outputContainer = document.getElementById('ai-project-ideas-output');
                toggleLoader(button, true, 'Generating Ideas...');
                outputContainer.innerHTML = '<p class="text-teal-500 flex items-center justify-center"><div class="loader mr-2"></div> Generating project ideas...</p>';
                const course = courses[button.dataset.courseId]; // Get course using dataset
                const prompt = `Generate 3-5 innovative and practical project ideas for someone who has just completed the course "${course.title}". Briefly describe each idea. Format them as simple HTML with a main heading and bulleted list.`;
                try {
                    const ideas = await callGeminiApi(prompt);
                    outputContainer.innerHTML = ideas;
                    showToast('Project ideas generated!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error generating project ideas. Please try again.</p>';
                    showToast('Error generating project ideas.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            // --- New AI Feature: Career Path Suggestion ---
            async function handleCareerPathSuggestion(e) {
                const button = e.currentTarget;
                const outputContainer = document.getElementById('ai-career-paths-output');
                toggleLoader(button, true, 'Suggesting Paths...');
                outputContainer.innerHTML = '<p class="text-indigo-500 flex items-center justify-center"><div class="loader mr-2"></div> Suggesting career paths...</p>';
                const course = courses[button.dataset.courseId]; // Get course using dataset
                const prompt = `Based on the course "${course.title}", suggest 3-5 relevant career paths or job roles. For each, briefly explain why it's a good fit for someone with skills from this course. Format as simple HTML with a main heading and bulleted list.`;
                try {
                    const careerPaths = await callGeminiApi(prompt);
                    outputContainer.innerHTML = careerPaths;
                    showToast('Career paths suggested!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error suggesting career paths. Please try again.</p>';
                    showToast('Error suggesting career paths.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            // --- New AI Feature: AI Interview Question Generator ---
            async function handleInterviewQuestionGeneration(e) {
                const button = e.currentTarget;
                const outputContainer = document.getElementById('ai-interview-questions-output');
                toggleLoader(button, true, 'Generating Questions...');
                outputContainer.innerHTML = '<p class="text-yellow-700 flex items-center justify-center"><div class="loader mr-2"></div> Generating interview questions...</p>';
                const course = courses[button.dataset.courseId]; // Get course using dataset
                const prompt = `Generate 5-7 common interview questions (technical and behavioral) for someone applying for roles related to the "${course.title}" course. Focus on questions that assess understanding and application of concepts learned in the course. Format as simple HTML with a main heading and a numbered list of questions.`;
                try {
                    const interviewQuestions = await callGeminiApi(prompt);
                    outputContainer.innerHTML = interviewQuestions;
                    showToast('Interview questions generated!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed for interview questions:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error generating interview questions. Please try again.</p>';
                    showToast('Error generating interview questions.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            // --- New AI Feature: Troubleshooting Assistant ---
            async function handleTroubleshooting(e) {
                const button = e.currentTarget;
                const problemDescription = document.getElementById('troubleshooting-input').value;
                const outputContainer = document.getElementById('ai-troubleshooting-output');
                if (!problemDescription.trim()) {
                    outputContainer.innerHTML = '<p class="text-red-500">Please describe the problem you\'re facing.</p>';
                    showToast('Please describe your problem.', 'error');
                    return;
                }

                toggleLoader(button, true, 'Troubleshooting...');
                outputContainer.innerHTML = '<p class="text-red-500 flex items-center justify-center"><div class="loader mr-2"></div> Analyzing problem...</p>';
                const course = courses[button.dataset.courseId];
                const prompt = `A student working on the "${course.title}" course is facing an issue. They describe the problem as: "${problemDescription}". Provide detailed troubleshooting steps, common causes, and potential solutions. Focus on practical, step-by-step advice relevant to electronics/IoT projects. Format as simple HTML with headings (e.g., h5 for steps) and bullet points (ul/li).`;
                
                try {
                    const troubleshootingSteps = await callGeminiApi(prompt);
                    outputContainer.innerHTML = troubleshootingSteps;
                    showToast('Troubleshooting steps generated!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed for troubleshooting:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error generating troubleshooting steps. Please try again.</p>';
                    showToast('Error generating troubleshooting steps.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            // --- New AI Feature: Code Explainer/Debug Helper ---
            async function handleCodeExplanation(e) {
                const button = e.currentTarget;
                const codeSnippet = document.getElementById('code-input').value;
                const outputContainer = document.getElementById('ai-code-output');
                if (!codeSnippet.trim()) {
                    outputContainer.innerHTML = '<p class="text-red-500">Please paste your code snippet.</p>';
                    showToast('Please paste your code.', 'error');
                    return;
                }

                toggleLoader(button, true, 'Analyzing Code...');
                outputContainer.innerHTML = '<p class="text-gray-700 flex items-center justify-center"><div class="loader mr-2"></div> Analyzing code...</p>';
                const course = courses[button.dataset.courseId];
                const prompt = `A student from the "${course.title}" course has the following code: \n\`\`\`\n${codeSnippet}\n\`\`\`\nExplain what this code does, identify any potential errors or areas for improvement, and suggest fixes if it's a debugging scenario. If no errors, provide a concise explanation. Format as simple HTML paragraphs and lists.`;
                
                try {
                    const codeAnalysis = await callGeminiApi(prompt);
                    outputContainer.innerHTML = codeAnalysis;
                    showToast('Code analyzed!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed for code explanation:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error analyzing your code. Please try again.</p>';
                    showToast('Error analyzing code.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            // --- New AI Feature: Component Suggester ---
            async function handleComponentSuggestion(e) {
                const button = e.currentTarget;
                const requirementsInput = document.getElementById('component-requirements-input').value;
                const outputContainer = document.getElementById('ai-components-output');
                if (!requirementsInput.trim()) {
                    outputContainer.innerHTML = '<p class="text-red-500">Please describe your project requirements.</p>';
                    showToast('Please describe your project requirements.', 'error');
                    return;
                }

                toggleLoader(button, true, 'Suggesting Components...');
                outputContainer.innerHTML = '<p class="text-orange-500 flex items-center justify-center"><div class="loader mr-2"></div> Looking for components...</p>';
                const course = courses[button.dataset.courseId];
                const prompt = `Based on the course "${course.title}" and the following project requirements: "${requirementsInput}", suggest suitable electronic components (e.g., microcontrollers, sensors, communication modules). For each suggestion, provide a brief justification of why it fits and common alternatives. Format as simple HTML with a main heading and a detailed bulleted list.`;
                
                try {
                    const suggestions = await callGeminiApi(prompt);
                    outputContainer.innerHTML = suggestions;
                    showToast('Components suggested!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed for component suggestion:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error suggesting components. Please try again.</p>';
                    showToast('Error suggesting components.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }

            // --- New AI Feature: Lab Report Assistant ---
            async function handleLabReportAssistance(e) {
                const button = e.currentTarget;
                const labDataInput = document.getElementById('lab-data-input').value;
                const outputContainer = document.getElementById('ai-lab-report-output');
                if (!labDataInput.trim()) {
                    outputContainer.innerHTML = '<p class="text-red-500">Please provide your lab data or observations.</p>';
                    showToast('Please provide your lab data or observations.', 'error');
                    return;
                }

                toggleLoader(button, true, 'Generating Draft...');
                outputContainer.innerHTML = '<p class="text-green-500 flex items-center justify-center"><div class="loader mr-2"></div> Drafting report...</p>';
                const course = courses[button.dataset.courseId];
                const prompt = `A student from the "${course.title}" course has the following lab experiment data and observations: "${labDataInput}". Act as a lab assistant. Help them structure and draft a section of a lab report, such as the 'Results' or 'Discussion' section. Focus on interpreting the data and drawing conclusions relevant to the course. If it's a discussion, suggest possible sources of error or future experiments. Format as simple HTML paragraphs and lists.`;
                
                try {
                    const reportDraft = await callGeminiApi(prompt);
                    outputContainer.innerHTML = reportDraft;
                    showToast('Lab report draft generated!', 'success');
                } catch (error) {
                    console.error('Gemini API call failed for lab report assistance:', error);
                    outputContainer.innerHTML = '<p class="text-red-500">Sorry, there was an error generating the lab report draft. Please try again.</p>';
                    showToast('Error generating lab report draft.', 'error');
                } finally {
                    toggleLoader(button, false);
                }
            }


            // --- Gemini API Call ---
            // This function is still present for the AI tools within the course modal.
            // If these tools are also to be removed, this function should be removed too.
            async function callGeminiApi(prompt, responseSchema = null, imageData = null, retries = 3, delay = 1000) {
                const apiKey = "AIzaSyCODRIZL8mNqWpUf0HdWcoCedimZM_0G5E"; // Canvas will provide the key at runtime.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                let contents = [{ role: "user", parts: [{ text: prompt }] }];
                if (imageData) {
                    contents[0].parts.push({
                        inlineData: {
                            mimeType: imageData.mimeType,
                            data: imageData.data
                        }
                    });
                }

                const payload = { contents: contents };

                if (responseSchema) {
                    payload.generationConfig = {
                        responseMimeType: "application/json",
                        responseSchema: responseSchema
                    };
                }

                for (let i = 0; i < retries; i++) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        if (!response.ok) {
                            const errorBody = await response.json();
                            console.error(`API Error: ${response.status} - ${errorBody.error.message}`);
                            throw new Error(`HTTP error! status: ${response.status} - ${errorBody.error.message}`);
                        }
                        const result = await response.json();
                        if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                            return result.candidates[0].content.parts[0].text;
                        } else {
                            throw new Error("Invalid response from Gemini API");
                        }
                    } catch (error) {
                        console.error(`Attempt ${i + 1} failed:`, error);
                        if (i === retries - 1) throw error;
                        await new Promise(res => setTimeout(res, delay * Math.pow(2, i)));
                    }
                }
            }
            
            // --- Utility Functions ---
            function toggleLoader(element, isLoading, loadingText = 'Processing...') {
                const button = element.closest('button') || element; // Get the button element or the element itself if it's the button
                const buttonText = button.querySelector('.button-text');
                const loader = button.querySelector('.loader');
                const originalText = button.dataset.originalText || (buttonText ? buttonText.textContent : ''); // Store original text

                if (buttonText && !button.dataset.originalText) {
                    button.dataset.originalText = originalText;
                }

                if (isLoading) {
                    button.disabled = true;
                    if (buttonText) buttonText.textContent = loadingText;
                    if (loader) loader.classList.remove('hidden');
                } else {
                    button.disabled = false;
                    if (buttonText) buttonText.textContent = button.dataset.originalText;
                    if (loader) loader.classList.add('hidden');
                }
            }


            function getFriendlyAuthError(code) {
                switch (code) {
                    case 'auth/invalid-email': return 'Please enter a valid email address.';
                    case 'auth/user-not-found': return 'No account found with this email.';
                    case 'auth/wrong-password': return 'Incorrect password. Please try again.';
                    case 'auth/email-already-in-use': return 'An account with this email already exists.';
                    case 'auth/weak-password': return 'Password should be at least 6 characters long.';
                    case 'auth/network-request-failed': return 'Network error. Please check your internet connection.';
                    default: return 'An unexpected error occurred. Please try again.';
                }
            }
            
            function showToast(message, type = 'info') {
                const toast = document.getElementById('toast');
                const toastMessage = document.getElementById('toast-message');
                
                // Reset classes
                toast.classList.remove('bg-gray-800', 'bg-green-500', 'bg-red-500', 'bg-yellow-500');
                
                let bgColor = 'bg-gray-800'; // Default
                if (type === 'success') bgColor = 'bg-green-500';
                if (type === 'error') bgColor = 'bg-red-500';
                if (type === 'warning') bgColor = 'bg-yellow-500';
                
                toast.classList.add(bgColor);
                toastMessage.textContent = message;

                // Animate in
                toast.classList.add('active'); // Use 'active' class to trigger animation
                
                // Animate out after 4 seconds
                setTimeout(() => {
                    toast.classList.remove('active'); // Remove 'active' class to trigger reverse animation
                }, 4000);
            }

            // --- Dark Mode Toggle ---
            if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
                darkModeToggle.checked = true;
            } else {
                document.documentElement.classList.remove('dark');
                darkModeToggle.checked = false;
            }

            darkModeToggle.addEventListener('change', () => {
                if (darkModeToggle.checked) {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                }
            });

            // Tab switching for auth forms
            const tabs = document.querySelectorAll('#auth-section .tab-btn');
            const tabContents = document.querySelectorAll('#auth-section .tab-content');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => {
                        t.classList.remove('active');
                        t.setAttribute('aria-selected', 'false');
                    });
                    tab.classList.add('active');
                    tab.setAttribute('aria-selected', 'true');
                    tabContents.forEach(c => c.classList.add('hidden'));
                    document.getElementById(tab.dataset.target).classList.remove('hidden');
                    authError.textContent = '';
                });
            });

            // Modal closing logic
            closeModalBtn.addEventListener('click', () => {
                modalContent.classList.remove('active'); // Remove 'active' class
                const previouslyFocusedElement = document.activeElement; // Element that opened the modal
                setTimeout(() => {
                    modal.classList.add('hidden');
                    if (previouslyFocusedElement) {
                        previouslyFocusedElement.focus();
                    }
                }, 300);
            });
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModalBtn.click();
            });

            // Close modal with Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
                    closeModalBtn.click();
                }
            });

            // Event Listeners for Filter, Sort, Search
            courseSearch.addEventListener('input', () => {
                displayCourses();
            });

            courseFilter.addEventListener('change', (e) => {
                currentFilter = e.target.value;
                displayCourses();
            });

            courseSort.addEventListener('change', (e) => {
                currentSort = e.target.value;
                displayCourses();
            });


            // --- TECHWHIZ Assistant Logic ---

            techwhizFab.addEventListener('click', () => {
                techwhizModal.classList.remove('hidden');
                techwhizModal.classList.add('flex');
                setTimeout(() => {
                    techwhizModal.querySelector('.modal-content-container').classList.add('active');
                    techwhizInput.focus();
                }, 10);
            });

            closeTechwhizModalBtn.addEventListener('click', () => {
                techwhizModal.querySelector('.modal-content-container').classList.remove('active');
                if (currentUtterance) {
                    synth.cancel(); // Stop any ongoing speech
                }
                if (isListening) { 
                    recognition.stop(); // Stop listening if active
                }
                setTimeout(() => {
                    techwhizModal.classList.add('hidden');
                    techwhizFab.focus();
                }, 300);
            });

            techwhizModal.addEventListener('click', (e) => {
                if (e.target === techwhizModal) closeTechwhizModalBtn.click();
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !techwhizModal.classList.contains('hidden')) {
                    closeTechwhizModalBtn.click();
                }
            });

            // Initialize Speech Recognition
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false; // <<< IMPORTANT CHANGE: Set to false for single command
                recognition.interimResults = false; 
                recognition.lang = 'en-US';

                recognition.onstart = () => {
                    isListening = true;
                    micBtn.classList.add('speech-active');
                    listeningStatus.classList.remove('hidden');
                    techwhizInput.placeholder = "Listening...";
                };

                recognition.onresult = (event) => {
                    let finalTranscript = '';
                    // Iterate through results to get the full transcript of the current (single) utterance
                    for (let i = event.resultIndex; i < event.results.length; ++i) {
                        if (event.results[i].isFinal) {
                            finalTranscript += event.results[i][0].transcript;
                        }
                    }
                    if (finalTranscript) {
                        techwhizInput.value = finalTranscript; 
                        appendMessage(finalTranscript, 'user');
                        processCommand(finalTranscript);
                        techwhizInput.value = ''; // Clear input after processing
                    }
                };

                recognition.onerror = (event) => {
                    console.error('Speech Recognition Error:', event.error);
                    showToast(`Speech recognition error: ${event.error}`, 'error');
                    isListening = false;
                    micBtn.classList.remove('speech-active');
                    listeningStatus.classList.add('hidden');
                    techwhizInput.placeholder = "Type your command or question...";
                };

                recognition.onend = () => { // This will now fire after each complete utterance
                    isListening = false;
                    micBtn.classList.remove('speech-active');
                    listeningStatus.classList.add('hidden');
                    techwhizInput.placeholder = "Type your command or question...";
                    techwhizFab.classList.remove('speech-active'); // Remove FAB pulse if it was active for speech
                };
            } else {
                micBtn.disabled = true;
                micBtn.title = "Speech Recognition not supported in this browser.";
                showToast("Your browser does not support Web Speech Recognition.", "warning");
            }

            micBtn.addEventListener('click', () => {
                if (isListening) {
                    recognition.stop(); // Stop current listening
                } else {
                    if (currentUtterance) {
                        synth.cancel(); // Stop any ongoing speech before listening
                    }
                    recognition.start(); // Start new single-shot listening
                }
            });

            sendBtn.addEventListener('click', () => {
                const command = techwhizInput.value.trim();
                if (command) {
                    if (currentUtterance) {
                        synth.cancel(); // Stop any ongoing speech before processing text
                    }
                    if (isListening) { 
                        recognition.stop(); // Stop listening if active
                    }
                    appendMessage(command, 'user');
                    processCommand(command);
                    techwhizInput.value = '';
                }
            });

            techwhizInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendBtn.click();
                }
            });

            stopSpeechBtn.addEventListener('click', () => {
                if (currentUtterance) {
                    synth.cancel();
                    stopSpeechBtn.classList.remove('speech-active'); // Remove animation
                }
                if (isListening) { 
                    recognition.stop(); // Also stop listening if active
                }
            });

            uploadImageBtn.addEventListener('click', () => {
                imageUploadInput.click(); // Trigger the hidden file input
            });

            imageUploadInput.addEventListener('change', async (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = async (e) => {
                        const base64Data = e.target.result.split(',')[1];
                        const mimeType = file.type;
                        const imageData = { data: base64Data, mimeType: mimeType };
                        
                        appendMessage('Analyzing image...', 'assistant'); // Show immediate feedback
                        techwhizFab.classList.add('image-processing'); // Add loading animation to FAB
                        thinkingStatus.classList.remove('hidden'); // Show thinking status
                        
                        // Display the image in chat history
                        const userImageMsg = document.createElement('div');
                        userImageMsg.className = 'chat-message user image-message'; // Added image-message class
                        userImageMsg.innerHTML = `<img src="${e.target.result}" alt="Uploaded Image" class="max-w-xs max-h-40 rounded-lg shadow-md">`;
                        chatHistory.prepend(userImageMsg); // Add image to chat history
                        chatHistory.scrollTop = chatHistory.scrollHeight;


                        try {
                            // Call processCommand with image data
                            await processCommand("describe this image", imageData);
                        } finally {
                            techwhizFab.classList.remove('image-processing'); // Remove loading animation
                            thinkingStatus.classList.add('hidden'); // Hide thinking status
                            // No need to restart recognition here, as it's single-shot now.
                        }
                    };
                    reader.readAsDataURL(file);
                }
            });

            clearChatBtn.addEventListener('click', () => {
                chatHistory.innerHTML = '<div class="chat-message assistant">Hello! I\'m TECHWHIZ, your personal assistant for E-TECH SOLUTIONS. How can I help you today?</div>';
                showToast('Chat history cleared!', 'info');
            });


            async function processCommand(command, imageData = null) {
                let responseText = '';
                const lowerCommand = command.toLowerCase();

                thinkingStatus.classList.remove('hidden'); // Show thinking status
                
                // Predefined commands
                if (lowerCommand.includes('your name')) {
                    responseText = "I am TECHWHIZ, your personal assistant for E-TECH SOLUTIONS.";

                } 

                else if (lowerCommand.includes('who is the admin') || lowerCommand.includes('who created you')) {
                    responseText = "The admin is the brilliant developer behind E-TECH SOLUTIONS, dedicated to enhancing your learning journey.";

                } 

                else if (lowerCommand.includes('what can you do') || lowerCommand.includes('your capabilities')) {
                    responseText = "I can assist you with course information, generate quizzes, suggest projects, provide career advice, troubleshoot issues, explain code, suggest components, help draft lab reports, and much more related to electronics and IoT learning!";}
                    else if (lowerCommand.includes('help') || lowerCommand.includes('support')) {
                    responseText = "Sure! You can ask me about course details, generate quizzes, suggest project ideas, get career advice, troubleshoot problems, explain code snippets, suggest electronic components, and assist with lab report drafting. How can I assist you today?";
                    }

                else if (lowerCommand.includes('about this website') || lowerCommand.includes('about this html file')) {
                    responseText = "This is the E-TECH SOLUTIONS dynamic e-learning portal. It offers various courses in electronics and IoT, features user authentication, tracks course progress, and integrates payment options.";
                }

                else if (lowerCommand.includes('generate a quiz') || lowerCommand.includes('make a quiz')) {
                    responseText = "To generate a quiz, please specify the course name or topic you'd like the quiz to be about.";
                } 
                else if (lowerCommand.includes('suggest a project') || lowerCommand.includes('project idea')) {
                    responseText = "To suggest a project idea, please provide the course name or specific area of interest within electronics or IoT.";
                } 
                else if (lowerCommand.includes('career advice') || lowerCommand.includes('career path')) {
                    responseText = "For career advice, please specify your area of interest or the course you are pursuing, and I can provide tailored suggestions.";
                }
                 else if (lowerCommand.includes('what is arduino') || lowerCommand.includes('arduino') || lowerCommand.includes('define arduino')) {
                    responseText = "Arduino is an open-source electronics platform that makes it easy to create a wide variety of interactive electronic objects and projects. It consists of two main parts: a physical programmable circuit board, known as a microcontroller, and a piece of software, or IDE (Integrated Development Environment), that runs on your computer. You use the IDE to write and upload code to the physical board.";
                } 
                else if (lowerCommand.includes('what is a resistor') || lowerCommand.includes('resistor')) {
    responseText = "A resistor is a passive two-terminal electrical component that implements electrical resistance as a circuit element. In electronic circuits, resistors are used to reduce current flow, adjust signal levels, to divide voltages, bias active elements, and terminate transmission lines, among other uses.";
}

else if (lowerCommand.includes('what is a capacitor') || lowerCommand.includes('capacitor')) {
    responseText = "A capacitor is a passive two-terminal electrical component that stores electrical energy in an electric field. The effect of a capacitor is known as capacitance. While some capacitance exists between any two electrical conductors in proximity in a circuit, a capacitor is a component designed to add capacitance to a circuit.";
}

else if (lowerCommand.includes('what is an inductor') || lowerCommand.includes('inductor')) {
    responseText = "An inductor, also called a choke, is a passive two-terminal electrical component that stores energy in a magnetic field when electric current flows through it. An inductor typically consists of a conductor such as a wire, usually wound into a coil.";
}

else if (lowerCommand.includes('what is a diode') || lowerCommand.includes('diode')) {
    responseText = "A diode is a two-terminal electronic component that conducts current primarily in one direction; it has low (ideally zero) resistance in one direction, and high (ideally infinite) resistance in the other. It's often used for rectification, converting AC to DC.";
}
else if (lowerCommand.includes('what is a transistor') || lowerCommand.includes('transistor')) {
    responseText = "A transistor is a semiconductor device used to amplify or switch electronic signals and electrical power. It is one of the basic building blocks of modern electronics and is essential in digital circuits like microprocessors, and analog circuits like audio amplifiers.";
}
else if (lowerCommand.includes('what is an LED') || lowerCommand.includes('LED')) {
    responseText = "An LED (Light Emitting Diode) is a semiconductor light source that emits light when current flows through it. Electrons in the semiconductor recombine with electron holes, releasing energy in the form of photons. LEDs are very energy-efficient and have a long lifespan.";
}
else if (lowerCommand.includes('what is a breadboard') || lowerCommand.includes('breadboard')) {
    responseText = "A breadboard is a solderless construction base used for prototyping of electronics. It allows you to quickly build temporary circuits and experiment with different component arrangements without having to solder anything.";
}
else if (lowerCommand.includes('what is Ohm\'s law') || lowerCommand.includes('ohms law') || lowerCommand.includes('define ohms law')) {
    responseText = "Ohm's Law states that the current through a conductor between two points is directly proportional to the voltage across the two points. Mathematically, it's expressed as V = I * R, where V is voltage, I is current, and R is resistance.";
}
else if (lowerCommand.includes('what is current') || lowerCommand.includes('define current')) {
    responseText = "Electric current is the rate of flow of electric charge past a point or region. A common analogy is the flow of water in a pipe, where current is the amount of water flowing per unit time.";
}
else if (lowerCommand.includes('what is voltage') || lowerCommand.includes('define voltage')) {
    responseText = "Voltage, also known as electric potential difference, is the difference in electric potential energy between two points per unit electric charge. It represents the 'push' or 'force' that drives electric current.";
}
else if (lowerCommand.includes('what is resistance') || lowerCommand.includes('define resistance')) {
    responseText = "Electrical resistance is a measure of the opposition to the flow of electric current in an electrical circuit. It's measured in ohms (Ω). Materials with high resistance are insulators, and those with low resistance are conductors.";
}
else if (lowerCommand.includes('what is an integrated circuit') || lowerCommand.includes('integrated circuit') || lowerCommand.includes('what is an IC') || lowerCommand.includes('IC')) {
    responseText = "An Integrated Circuit (IC), sometimes called a microchip, is a set of electronic circuits on one small flat piece (or 'chip') of semiconductor material, usually silicon. ICs are used in virtually all electronic equipment today.";
}
else if (lowerCommand.includes('what is a sensor') || lowerCommand.includes('define sensor')) {
    responseText = "A sensor is a device, module, machine, or subsystem whose purpose is to detect events or changes in its environment and send the information to other electronics, frequently a computer processor. It's a key component in gathering data from the physical world.";
}
else if (lowerCommand.includes('what is a microcontroller') || lowerCommand.includes('microcontroller')) {
    responseText = "A microcontroller is a small computer on a single metal-oxide-semiconductor (MOS) integrated circuit chip. It contains one or more CPUs along with memory and programmable input/output peripherals. Microcontrollers are used in automatically controlled products and devices, such as automobile engine control systems, implantable medical devices, remote controls, office machines, appliances, power tools, and toys.";
}
else if (lowerCommand.includes('what is a schematic') || lowerCommand.includes('schematic diagram')) {
    responseText = "A schematic diagram is a representation of the elements of a system using abstract, graphic symbols rather than realistic pictures. A schematic diagram of an electronic circuit shows the components of the circuit as simplified shapes, and the power and signal connections between them.";
}
else if (lowerCommand.includes('what is current flow direction') || lowerCommand.includes('conventional current')) {
    responseText = "Conventional current is the concept that electric current flows from the positive terminal to the negative terminal, even though electrons (which carry the charge) actually flow in the opposite direction. It's a historical convention still widely used in circuit analysis.";
}
else if (lowerCommand.includes('what is a series circuit') || lowerCommand.includes('series circuit')) {
    responseText = "In a series circuit, components are connected end-to-end, forming a single path for the current to flow. The current is the same through each component, but the voltage drops across each component add up to the total voltage.";
}
else if (lowerCommand.includes('what is a parallel circuit') || lowerCommand.includes('parallel circuit')) {
    responseText = "In a parallel circuit, components are connected across the same two points, creating multiple paths for the current. The voltage across each component is the same, but the total current is the sum of the currents through each path.";
}
// --- Digital Electronics ---
else if (lowerCommand.includes('what is a logic gate') || lowerCommand.includes('logic gate')) {
    responseText = "A logic gate is an elementary building block of a digital circuit. Most logic gates have two inputs and one output. At any given moment, every terminal is in one of the two binary conditions, low (0) or high (1).";
}
else if (lowerCommand.includes('what is an AND gate') || lowerCommand.includes('AND gate')) {
    responseText = "An AND gate is a digital logic gate that implements logical conjunction. It produces a high output (1) only if all its inputs are high (1). Otherwise, the output is low (0).";
}
else if (lowerCommand.includes('what is an OR gate') || lowerCommand.includes('OR gate')) {
    responseText = "An OR gate is a digital logic gate that implements logical disjunction. It produces a high output (1) if any of its inputs are high (1). The output is low (0) only if all inputs are low (0).";
}
else if (lowerCommand.includes('what is a NOT gate') || lowerCommand.includes('NOT gate') || lowerCommand.includes('inverter')) {
    responseText = "A NOT gate, also known as an inverter, is a digital logic gate with one input and one output. It performs logical negation, producing a high output (1) if the input is low (0), and a low output (0) if the input is high (1).";
}
else if (lowerCommand.includes('what is an XOR gate') || lowerCommand.includes('XOR gate')) {
    responseText = "An XOR (Exclusive-OR) gate is a digital logic gate that produces a high output (1) if an odd number of its inputs are high (1). If both inputs are the same (both 0 or both 1), the output is low (0).";
}
else if (lowerCommand.includes('what is a flip-flop') || lowerCommand.includes('flip flop')) {
    responseText = "A flip-flop is a basic storage element in sequential logic circuits, capable of storing one bit of information. It has two stable states and is used as a fundamental building block of digital memory and sequential logic.";
}
else if (lowerCommand.includes('what is combinational logic') || lowerCommand.includes('combinational logic')) {
    responseText = "Combinational logic is a type of digital logic circuit whose output is purely a function of the present inputs. It does not contain memory elements and its output changes immediately when inputs change.";
}
else if (lowerCommand.includes('what is sequential logic') || lowerCommand.includes('sequential logic')) {
    responseText = "Sequential logic is a type of digital logic circuit whose output depends not only on the present inputs but also on the sequence of past inputs, due to the presence of memory elements (like flip-flops).";
}
else if (lowerCommand.includes('what is a multiplexer') || lowerCommand.includes('mux')) {
    responseText = "A multiplexer (MUX) is a device that selects one of several analog or digital input signals and forwards the selected input into a single output line. It's essentially a multi-input, single-output switch.";
}
else if (lowerCommand.includes('what is a demultiplexer') || lowerCommand.includes('demux')) {
    responseText = "A demultiplexer (DEMUX) is a device that takes a single input signal and selects one of many data-output-lines, which is connected to the single input. It's the inverse of a multiplexer, acting as a single-input, multi-output switch.";
}
else if (lowerCommand.includes('what is an encoder') || lowerCommand.includes('encoder digital')) {
    responseText = "An encoder is a combinational logic circuit that converts a non-binary input code to a binary output code. For example, it might convert a decimal digit input to a binary-coded decimal (BCD) output.";
}
else if (lowerCommand.includes('what is a decoder') || lowerCommand.includes('decoder digital')) {
    responseText = "A decoder is a combinational logic circuit that converts n input lines into $2^n$ output lines. Only one output line is active for a given input combination. It's often used to convert binary codes into human-readable outputs.";
}
else if (lowerCommand.includes('what is a counter') || lowerCommand.includes('digital counter')) {
    responseText = "A digital counter is a sequential logic circuit that counts specific events or pulses applied to its input. It can be implemented using flip-flops and can count up, down, or in various sequences.";
}
else if (lowerCommand.includes('what is a register') || lowerCommand.includes('digital register')) {
    responseText = "A register is a small amount of fast storage available to the CPU within a microcontroller or processor. It holds data that the CPU is currently working on, significantly speeding up data access.";
}
else if (lowerCommand.includes('what is ADC') || lowerCommand.includes('Analog to Digital Converter')) {
    responseText = "An Analog-to-Digital Converter (ADC) is an electronic circuit that converts a continuous analog signal (like temperature or sound) into a discrete digital signal. This allows digital systems to process real-world analog data.";
}
else if (lowerCommand.includes('what is DAC') || lowerCommand.includes('Digital to Analog Converter')) {
    responseText = "A Digital-to-Analog Converter (DAC) is an electronic circuit that converts a digital signal (a sequence of binary numbers) into an analog signal (a continuous voltage or current). It's the opposite of an ADC.";
}
else if (lowerCommand.includes('what is a buffer') || lowerCommand.includes('digital buffer')) {
    responseText = "In digital electronics, a buffer is a logic gate that simply passes its input to its output without changing its logical state. It's used primarily to provide current amplification (buffering) to drive multiple loads or to isolate circuits.";
}
else if (lowerCommand.includes('what is CMOS') || lowerCommand.includes('CMOS logic')) {
    responseText = "CMOS (Complementary Metal-Oxide-Semiconductor) is a technology for constructing integrated circuits. It uses complementary and symmetrical pairs of p-type and n-type MOSFETs for logic functions, known for low power consumption.";
}
else if (lowerCommand.includes('what is TTL') || lowerCommand.includes('TTL logic')) {
    responseText = "TTL (Transistor-Transistor Logic) is a class of digital logic circuits constructed from bipolar junction transistors. It was widely used for digital ICs, known for its speed, but typically consumes more power than CMOS.";
}
else if (lowerCommand.includes('what is tristate logic') || lowerCommand.includes('tri-state buffer')) {
    responseText = "Tri-state logic refers to a digital output that can be in one of three states: high (1), low (0), or high-impedance (Z). The high-impedance state effectively disconnects the output, allowing multiple devices to share a bus.";
}
else if (lowerCommand.includes('what is FPGA') || lowerCommand.includes('Field-Programmable Gate Array')) {
    responseText = "An FPGA (Field-Programmable Gate Array) is an integrated circuit designed to be configured by a customer or a designer after manufacturing. FPGAs are highly flexible and can implement any digital circuit, making them suitable for rapid prototyping and custom hardware acceleration.";
}
else if (lowerCommand.includes('what is ASIC') || lowerCommand.includes('Application-Specific Integrated Circuit')) {
    responseText = "An ASIC (Application-Specific Integrated Circuit) is an integrated circuit customized for a particular use, rather than general-purpose use. ASICs are designed for specific tasks, leading to higher performance and lower power consumption for that task, but involve high initial design costs.";
}
// --- Electronic Circuits and Network Analysis (Advanced) ---
else if (lowerCommand.includes('what are Kirchhoff\'s Laws') || lowerCommand.includes('Kirchhoff\'s Laws') || lowerCommand.includes('KCL') || lowerCommand.includes('KVL')) {
    responseText = "Kirchhoff's Laws are two fundamental laws for circuit analysis. Kirchhoff's Current Law (KCL) states that the algebraic sum of currents entering a node (or a junction) is zero. Kirchhoff's Voltage Law (KVL) states that the algebraic sum of voltages around any closed loop in a circuit is zero.";
}
else if (lowerCommand.includes('what is Thevenin\'s Theorem') || lowerCommand.includes('Thevenin\'s Theorem') || lowerCommand.includes('thevenin')) {
    responseText = "Thevenin's Theorem states that any linear electrical network containing only voltage sources, current sources, and resistors can be replaced by an equivalent circuit consisting of a single voltage source (Vth) in series with a single resistor (Rth).";
}
else if (lowerCommand.includes('what is Norton\'s Theorem') || lowerCommand.includes('Norton\'s Theorem') || lowerCommand.includes('norton')) {
    responseText = "Norton's Theorem states that any linear electrical network can be replaced by an equivalent circuit consisting of a single current source (In) in parallel with a single resistor (Rn).";
}
else if (lowerCommand.includes('what is superposition theorem') || lowerCommand.includes('superposition')) {
    responseText = "The Superposition Theorem states that in any linear circuit with multiple independent sources, the total current or voltage for any element is the algebraic sum of the currents or voltages produced by each source acting alone, with all other independent sources turned off (voltage sources shorted, current sources opened).";
}
else if (lowerCommand.includes('what is maximum power transfer theorem') || lowerCommand.includes('maximum power transfer')) {
    responseText = "The Maximum Power Transfer Theorem states that to obtain maximum external power from a source with a finite internal resistance, the resistance of the load must be equal to the resistance of the source as viewed from its output terminals.";
}
else if (lowerCommand.includes('what is impedance') || lowerCommand.includes('define impedance')) {
    responseText = "Impedance is the measure of the opposition that a circuit presents to a current when a voltage is applied. In AC circuits, impedance is a more general concept than resistance, as it includes both resistance and reactance. It's represented by a complex number.";
}
else if (lowerCommand.includes('what is reactance') || lowerCommand.includes('define reactance')) {
    responseText = "Reactance is the opposition to the change of current or voltage in an electrical circuit due to inductance or capacitance. It is a component of impedance and is frequency-dependent. Inductive reactance (XL) increases with frequency, while capacitive reactance (XC) decreases with frequency.";
}
else if (lowerCommand.includes('what is admittance') || lowerCommand.includes('define admittance')) {
    responseText = "Admittance is a measure of how easily a circuit or device allows current to flow. It is the reciprocal of impedance, and in AC circuits, it's represented by a complex number. Its real part is conductance, and its imaginary part is susceptance.";
}
else if (lowerCommand.includes('what is resonance') || lowerCommand.includes('resonant frequency')) {
    responseText = "Resonance in an electrical circuit occurs when the impedance of the circuit is purely resistive, meaning the inductive and capacitive reactances cancel each other out. This typically happens at a specific resonant frequency, leading to maximum current or voltage response.";
}
else if (lowerCommand.includes('what is a low-pass filter') || lowerCommand.includes('low pass filter')) {
    responseText = "A low-pass filter is an electronic filter that passes signals with a frequency lower than a certain cutoff frequency and attenuates signals with frequencies higher than the cutoff frequency. It smooths out rapidly changing signals.";
}
else if (lowerCommand.includes('what is a high-pass filter') || lowerCommand.includes('high pass filter')) {
    responseText = "A high-pass filter is an electronic filter that passes signals with a frequency higher than a certain cutoff frequency and attenuates signals with frequencies lower than the cutoff frequency. It blocks DC components and low-frequency noise.";
}
else if (lowerCommand.includes('what is a band-pass filter') || lowerCommand.includes('band pass filter')) {
    responseText = "A band-pass filter is an electronic filter that passes signals within a certain frequency range (a 'band') and attenuates signals outside that range. It's used to isolate a specific frequency or range of frequencies.";
}
else if (lowerCommand.includes('what is a band-stop filter') || lowerCommand.includes('band stop filter') || lowerCommand.includes('notch filter')) {
    responseText = "A band-stop filter, also known as a band-rejection filter or notch filter, is an electronic filter that attenuates signals within a certain frequency range and passes signals outside that range. It's often used to remove unwanted specific frequencies, like 60Hz hum.";
}
else if (lowerCommand.includes('what is a transfer function') || lowerCommand.includes('transfer function electronics')) {
    responseText = "In electronics and control theory, a transfer function is a mathematical representation of the relationship between the output and input of a linear, time-invariant system. It's typically expressed in the Laplace domain.";
}
else if (lowerCommand.includes('what is a bode plot') || lowerCommand.includes('bode plot')) {
    responseText = "A Bode plot is a graph of the frequency response of a system. It typically consists of two plots: one for the magnitude (in decibels) and one for the phase shift (in degrees) of the transfer function, plotted against frequency.";
}
else if (lowerCommand.includes('what is the s-plane') || lowerCommand.includes('s plane') || lowerCommand.includes('laplace transform')) {
    responseText = "The s-plane is a complex plane where the horizontal axis represents the real part (sigma) and the vertical axis represents the imaginary part (omega) of the complex variable 's' used in the Laplace transform. It's a fundamental tool for analyzing linear time-invariant systems.";
}
else if (lowerCommand.includes('what is transient response') || lowerCommand.includes('transient response circuit')) {
    responseText = "The transient response of a circuit describes its behavior as it changes from one steady state to another, typically immediately after a switch is opened or closed, or a sudden change in input occurs. It's temporary and eventually settles to a steady state.";
}
else if (lowerCommand.includes('what is steady-state response') || lowerCommand.includes('steady state response circuit')) {
    responseText = "The steady-state response of a circuit is the behavior of the circuit after all transient effects have died out. For DC circuits, this is a constant value; for AC circuits, it's a sinusoidal response at the input frequency.";
}
else if (lowerCommand.includes('what is quality factor') || lowerCommand.includes('Q factor')) {
    responseText = "The Quality Factor (Q factor) is a dimensionless parameter that describes how underdamped an oscillator or resonator is. In resonant circuits, a higher Q factor indicates lower energy loss and a narrower bandwidth.";
}
// --- Analog Electronics ---
else if (lowerCommand.includes('what is an operational amplifier') || lowerCommand.includes('op-amp')) {
    responseText = "An operational amplifier (op-amp) is a DC-coupled high-gain electronic voltage amplifier with a differential input and, usually, a single-ended output. It's a versatile building block for many analog circuits, used for amplification, filtering, summing, and more.";
}
else if (lowerCommand.includes('what is negative feedback') || lowerCommand.includes('negative feedback op-amp')) {
    responseText = "Negative feedback is a method of controlling a system by feeding a portion of its output back into its input in an opposing phase. In op-amps, it stabilizes gain, reduces distortion, and improves bandwidth.";
}
else if (lowerCommand.includes('what is positive feedback') || lowerCommand.includes('positive feedback op-amp')) {
    responseText = "Positive feedback is a process in which a portion of the output signal is fed back to the input in phase with the input signal. Unlike negative feedback, it tends to increase gain, making it useful in oscillators and regenerative circuits, but can also lead to instability.";
}
else if (lowerCommand.includes('what is a voltage regulator') || lowerCommand.includes('voltage regulator')) {
    responseText = "A voltage regulator is an electronic circuit that maintains a constant output voltage regardless of changes in the input voltage or load current. They are essential for providing stable power to sensitive electronic components.";
}
else if (lowerCommand.includes('what is a rectifier') || lowerCommand.includes('rectifier circuit')) {
    responseText = "A rectifier is an electrical device that converts alternating current (AC) to direct current (DC). It typically uses diodes to allow current flow in only one direction. Common types include half-wave and full-wave rectifiers.";
}
else if (lowerCommand.includes('what is an oscillator') || lowerCommand.includes('oscillator circuit')) {
    responseText = "An oscillator is an electronic circuit that produces a repetitive, oscillating electronic signal, often a sine wave or a square wave. They are fundamental in clock generation, radio transmitters, and signal generators.";
}
else if (lowerCommand.includes('what is common-emitter configuration') || lowerCommand.includes('common emitter')) {
    responseText = "The common-emitter configuration is a type of BJT amplifier where the emitter terminal is common to both the input and output. It provides both voltage and current gain and is widely used for amplification.";
}
else if (lowerCommand.includes('what is common-collector configuration') || lowerCommand.includes('common collector') || lowerCommand.includes('emitter follower')) {
    responseText = "The common-collector configuration, also known as an emitter follower, is a type of BJT amplifier where the collector terminal is common. It provides high current gain and voltage buffering, useful for impedance matching.";
}
else if (lowerCommand.includes('what is common-base configuration') || lowerCommand.includes('common base')) {
    responseText = "The common-base configuration is a type of BJT amplifier where the base terminal is common. It provides good voltage gain but no current gain, primarily used in high-frequency applications.";
}
// --- Semiconductor Devices ---
else if (lowerCommand.includes('what is a PN junction') || lowerCommand.includes('PN junction diode')) {
    responseText = "A PN junction is the boundary or interface between two types of semiconductor materials, p-type and n-type, inside a single crystal of semiconductor. It forms the basis of all semiconductor devices like diodes, transistors, and solar cells.";
}
else if (lowerCommand.includes('what is doping') || lowerCommand.includes('semiconductor doping')) {
    responseText = "Doping is the process of intentionally introducing impurities into an intrinsic semiconductor for the purpose of modulating its electrical properties, such as its electron and hole concentrations. This creates p-type or n-type semiconductors.";
}
else if (lowerCommand.includes('what is a Zener diode') || lowerCommand.includes('zener diode')) {
    responseText = "A Zener diode is a special type of diode designed to reliably allow current to flow in the reverse direction when a certain reverse voltage, known as the Zener voltage, is reached. It's primarily used for voltage regulation.";
}
else if (lowerCommand.includes('what is a BJT') || lowerCommand.includes('Bipolar Junction Transistor')) {
    responseText = "A BJT (Bipolar Junction Transistor) is a type of transistor that uses both electron and hole charge carriers. It's a current-controlled device and comes in NPN and PNP types, used for amplification and switching.";
}
else if (lowerCommand.includes('what is an FET') || lowerCommand.includes('Field-Effect Transistor')) {
    responseText = "An FET (Field-Effect Transistor) is a type of transistor that uses an electric field to control the flow of current. Unlike BJTs, FETs are voltage-controlled devices and have high input impedance, coming in JFET and MOSFET variations.";
}
else if (lowerCommand.includes('what is a MOSFET') || lowerCommand.includes('MOSFET transistor')) {
    responseText = "A MOSFET (Metal-Oxide-Semiconductor Field-Effect Transistor) is the most common type of FET. It's a voltage-controlled device known for high input impedance and is crucial in digital circuits, power electronics, and integrated circuits due to its scalability and low power consumption.";
}
else if (lowerCommand.includes('what is an SCR') || lowerCommand.includes('Silicon Controlled Rectifier')) {
    responseText = "An SCR (Silicon Controlled Rectifier) is a four-layer solid-state device that controls current flow. It acts as a switch, remaining off until a small current is applied to its gate terminal, after which it conducts heavily until the main current is interrupted.";
}
else if (lowerCommand.includes('what is a photodiode') || lowerCommand.includes('photodiode')) {
    responseText = "A photodiode is a semiconductor device that converts light into an electrical current. When light strikes the photodiode, it creates electron-hole pairs, generating a current proportional to the light intensity.";
}
else if (lowerCommand.includes('what is a phototransistor') || lowerCommand.includes('phototransistor')) {
    responseText = "A phototransistor is a light-sensitive transistor, similar to a photodiode but with internal gain. When light strikes its base junction, it generates a much larger output current compared to a photodiode, making it more sensitive to light.";
}
else if (lowerCommand.includes('what is a thermistor') || lowerCommand.includes('thermistor')) {
    responseText = "A thermistor is a type of resistor whose resistance is strongly dependent on temperature. It's widely used as a temperature sensor, with its resistance typically decreasing significantly as temperature increases (NTC thermistor).";
}
else if (lowerCommand.includes('what is an LDR') || lowerCommand.includes('Light Dependent Resistor')) {
    responseText = "An LDR (Light Dependent Resistor), also known as a photoresistor, is a passive component whose resistance decreases with increasing incident light intensity. It's often used in light-sensing applications.";
}
// --- Sensors & Actuators (Expanded) ---
else if (lowerCommand.includes('what is a temperature sensor') || lowerCommand.includes('temperature sensor')) {
    responseText = "A temperature sensor is a device that measures temperature. Common types include thermistors, RTDs (Resistance Temperature Detectors), thermocouples, and semiconductor-based IC sensors.";
}
else if (lowerCommand.includes('what is a pressure sensor') || lowerCommand.includes('pressure sensor')) {
    responseText = "A pressure sensor is a device that measures pressure, typically of gases or liquids. Pressure is an expression of the force required to stop a fluid from expanding, and pressure sensors convert this force into an electrical signal.";
}
else if (lowerCommand.includes('what is an ultrasonic sensor') || lowerCommand.includes('ultrasonic sensor')) {
    responseText = "An ultrasonic sensor measures distance by emitting ultrasonic waves and listening for the echo. By calculating the time taken for the sound to return, it determines the distance to an object. It's common in robotics and object detection.";
}
else if (lowerCommand.includes('what is an infrared sensor') || lowerCommand.includes('IR sensor')) {
    responseText = "An infrared (IR) sensor is an electronic device that measures or detects infrared radiation in its environment. It can be used for motion detection, proximity sensing, object detection, and even thermal imaging.";
}
else if (lowerCommand.includes('what is a motion sensor') || lowerCommand.includes('PIR sensor')) {
    responseText = "A motion sensor, often a PIR (Passive Infrared) sensor, detects movement by measuring changes in infrared radiation levels in its field of view. It's commonly used in security systems and automatic lighting.";
}
else if (lowerCommand.includes('what is a humidity sensor') || lowerCommand.includes('humidity sensor')) {
    responseText = "A humidity sensor (or hygrometer) detects and measures the amount of water vapor in the air. These sensors are crucial for environmental monitoring, HVAC systems, and weather stations.";
}
else if (lowerCommand.includes('what is an accelerometer') || lowerCommand.includes('accelerometer')) {
    responseText = "An accelerometer is a device that measures proper acceleration. This is the acceleration (or rate of change of velocity) of a body in its own rest frame. It's used to detect tilt, vibration, and orientation changes.";
}
else if (lowerCommand.includes('what is a gyroscope') || lowerCommand.includes('gyroscope sensor')) {
    responseText = "A gyroscope is a device that measures or maintains orientation and angular velocity. It detects rotation around an axis and is often paired with accelerometers in IMUs (Inertial Measurement Units) for more complete motion sensing.";
}
else if (lowerCommand.includes('what is a magnetomter') || lowerCommand.includes('magnetometer')) {
    responseText = "A magnetometer is an instrument that measures magnetic field strength or direction. In electronics, they are used in compasses, navigation systems, and metal detectors.";
}
else if (lowerCommand.includes('what is a proximity sensor') || lowerCommand.includes('proximity sensor')) {
    responseText = "A proximity sensor is a non-contact sensor that detects the presence of nearby objects without any physical contact. They work by emitting an electromagnetic field or a beam of radiation and looking for changes in the return signal.";
}
else if (lowerCommand.includes('what is a force sensor') || lowerCommand.includes('force sensor') || lowerCommand.includes('load cell')) {
    responseText = "A force sensor, often called a load cell, is a transducer that converts a force into an electrical signal. The electrical signal output is proportional to the applied force. They are used in scales, robotic grippers, and industrial measurement.";
}
else if (lowerCommand.includes('what is a flex sensor') || lowerCommand.includes('flex sensor')) {
    responseText = "A flex sensor is a sensor that measures the amount of bend or deflection. As the sensor is bent, the resistance across it increases. They are commonly used in robotics, gaming, and virtual reality gloves.";
}
else if (lowerCommand.includes('what is a gas sensor') || lowerCommand.includes('gas sensor')) {
    responseText = "A gas sensor is an electronic device that detects the presence and concentration of different types of gases in an area. They are used to detect combustible, flammable, and toxic gases, as well as oxygen depletion, in various environments.";
}
else if (lowerCommand.includes('what is a pH sensor') || lowerCommand.includes('pH sensor')) {
    responseText = "A pH sensor measures the acidity or alkalinity of a liquid. It typically consists of a glass electrode that generates a voltage proportional to the hydrogen ion concentration in the solution. Important for water quality, chemical processes, and agriculture.";
}
else if (lowerCommand.includes('what is a motor') || lowerCommand.includes('electric motor')) {
    responseText = "An electric motor is an electrical machine that converts electrical energy into mechanical energy. Most electric motors operate through the interaction between the motor's magnetic field and electric current in a wire winding to generate force in the form of torque.";
}
else if (lowerCommand.includes('what is a servo motor') || lowerCommand.includes('servo motor')) {
    responseText = "A servo motor is a rotary actuator that allows for precise control of angular position, velocity, and acceleration. It consists of a motor, a feedback sensor (often an encoder), and a control circuit. Commonly used in robotics and RC applications.";
}
else if (lowerCommand.includes('what is a stepper motor') || lowerCommand.includes('stepper motor')) {
    responseText = "A stepper motor is a brushless DC electric motor that divides a full rotation into a number of equal steps. It can be commanded to move and hold at any of these steps without a feedback sensor (open-loop control), making it ideal for precise positioning.";
}
else if (lowerCommand.includes('what is an actuator') || lowerCommand.includes('define actuator')) {
    responseText = "An actuator is a component of a machine that is responsible for moving and controlling a mechanism or system. It converts electrical, hydraulic, or pneumatic energy into mechanical motion. Motors, solenoids, and relays are common actuators.";
}
else if (lowerCommand.includes('what is a solenoid') || lowerCommand.includes('solenoid')) {
    responseText = "A solenoid is a type of electromagnet, the purpose of which is to generate a controlled magnetic field. When current passes through its coil, it creates a magnetic field that can be used to pull or push a plunger, converting electrical energy into linear mechanical motion.";
}
else if (lowerCommand.includes('what is a relay') || lowerCommand.includes('relay')) {
    responseText = "A relay is an electrically operated switch. It uses an electromagnet to mechanically operate a switch, either opening or closing a circuit. Relays are used to control a high-power circuit using a low-power signal, or to control multiple circuits with one signal.";
}

// --- Microcontrollers & Embedded Systems (Expanded) ---
else if (lowerCommand.includes('what is arduino') || lowerCommand.includes('define arduino')) {
    responseText = "Arduino is an open-source electronics platform that makes it easy to create a wide variety of interactive electronic objects and projects. It consists of two main parts: a physical programmable circuit board, known as a microcontroller, and a piece of software, or IDE (Integrated Development Environment), that runs on your computer. You use the IDE to write and upload code to the physical board.";
}
else if (lowerCommand.includes('what are arduino shields') || lowerCommand.includes('arduino shield')) {
    responseText = "Arduino shields are pre-assembled circuit boards that can be easily plugged on top of an Arduino board, extending its capabilities. They provide additional functionality like Ethernet connectivity, motor control, or wireless communication, without requiring complex wiring.";
}
else if (lowerCommand.includes('what is the arduino IDE') || lowerCommand.includes('arduino IDE')) {
    responseText = "The Arduino IDE (Integrated Development Environment) is a cross-platform application written in Java, designed to write, compile, and upload code to Arduino compatible boards. It provides a simple environment for programming microcontrollers.";
}
else if (lowerCommand.includes('what is GPIO') || lowerCommand.includes('General Purpose Input/Output')) {
    responseText = "GPIO stands for General Purpose Input/Output. These are generic pins on a microcontroller that can be configured by software to either input or output digital signals (high or low voltage). They are fundamental for interacting with sensors, LEDs, buttons, and other external components.";
}
else if (lowerCommand.includes('what is UART') || lowerCommand.includes('Universal Asynchronous Receiver/Transmitter')) {
    responseText = "UART (Universal Asynchronous Receiver/Transmitter) is a hardware communication protocol that transmits and receives serial data asynchronously. It's a common method for communication between microcontrollers and other devices like computers (via USB-to-serial converters).";
}
else if (lowerCommand.includes('what is SPI') || lowerCommand.includes('Serial Peripheral Interface')) {
    responseText = "SPI (Serial Peripheral Interface) is a synchronous serial communication interface specification used for short-distance communication, primarily in embedded systems. It operates in full duplex mode and typically uses four wires: MOSI, MISO, SCK, and SS.";
}
else if (lowerCommand.includes('what is I2C') || lowerCommand.includes('IIC') || lowerCommand.includes('Inter-Integrated Circuit')) {
    responseText = "I2C (Inter-Integrated Circuit), also known as IIC, is a multi-master, multi-slave serial communication bus used for connecting low-speed peripheral ICs to processors and microcontrollers. It uses only two bidirectional lines, SDA (data) and SCL (clock), making it very efficient.";
}
else if (lowerCommand.includes('what are interrupts') || lowerCommand.includes('microcontroller interrupts')) {
    responseText = "Interrupts are signals from hardware or software that indicate an event needs immediate attention from the CPU. When an interrupt occurs, the CPU temporarily suspends its current task, executes a specific 'Interrupt Service Routine' (ISR), and then resumes its previous task.";
}
else if (lowerCommand.includes('what is PWM') || lowerCommand.includes('Pulse Width Modulation')) {
    responseText = "PWM (Pulse Width Modulation) is a technique used to control the average power delivered to an electrical device by varying the width of electrical pulses. By changing the duty cycle (on-time vs. off-time), you can effectively control brightness of LEDs, speed of motors, etc.";
}
else if (lowerCommand.includes('what is a watchdog timer') || lowerCommand.includes('watchdog timer')) {
    responseText = "A watchdog timer is an electronic timer that is used to detect and recover from malfunctions in embedded systems. If the main program fails to reset the watchdog timer periodically (e.g., due to a software error), the timer will time out and reset the system.";
}
else if (lowerCommand.includes('what is a bootloader') || lowerCommand.includes('bootloader')) {
    responseText = "A bootloader is a small piece of code that runs when a microcontroller or computer first powers on or resets. Its primary function is to initialize the system and then load a larger program (like your Arduino sketch) into memory and start its execution.";
}
else if (lowerCommand.includes('what is firmware') || lowerCommand.includes('define firmware')) {
    responseText = "Firmware is a specific class of computer software that provides low-level control for a device's specific hardware. It's typically stored in non-volatile memory (like Flash ROM) and is responsible for basic functions, allowing higher-level software to interact with the hardware.";
}
else if (lowerCommand.includes('what is an RTOS') || lowerCommand.includes('Real-Time Operating System')) {
    responseText = "An RTOS (Real-Time Operating System) is an operating system intended for real-time applications, meaning it guarantees that certain operations will be completed within specific time constraints. RTOSes are crucial in embedded systems where timely responses are critical, such as in industrial control or medical devices.";
}
else if (lowerCommand.includes('what is memory in a microcontroller') || lowerCommand.includes('microcontroller memory')) {
    responseText = "Microcontrollers typically have different types of memory: Flash memory (for storing the program code), SRAM (Static RAM, for temporary data and variables), and EEPROM (Electrically Erasable Programmable Read-Only Memory, for small amounts of persistent data).";
}
else if (lowerCommand.includes('what is an instruction set') || lowerCommand.includes('instruction set architecture')) {
    responseText = "An instruction set (or Instruction Set Architecture - ISA) is the set of all instructions that a central processing unit (CPU) can understand and execute. It defines the commands that a processor knows, including operations, data types, and memory addressing modes.";
}
else if (lowerCommand.includes('what is raspberry pi') || lowerCommand.includes('raspberry pi')) {
    responseText = "The Raspberry Pi is a series of small single-board computers (SBCs) developed in the United Kingdom by the Raspberry Pi Foundation to promote the teaching of basic computer science in schools and developing countries. Unlike Arduino, it's a full-fledged computer capable of running an operating system.";
}
else if (lowerCommand.includes('arduino vs raspberry pi') || lowerCommand.includes('difference between arduino and raspberry pi')) {
    responseText = "Arduino is a microcontroller board, ideal for controlling hardware and real-time operations, programmed in a simplified C/C++. Raspberry Pi is a single-board computer, capable of running an OS like Linux, better for complex computing tasks, networking, and software applications.";
}
else if (lowerCommand.includes('what is a resistor') || lowerCommand.includes('resistor')) {
    responseText = "A resistor is a passive two-terminal electrical component that implements electrical resistance as a circuit element. In electronic circuits, resistors are used to reduce current flow, adjust signal levels, to divide voltages, bias active elements, and terminate transmission lines, among other uses.";
}
else if (lowerCommand.includes('what is a capacitor') || lowerCommand.includes('capacitor')) {
    responseText = "A capacitor is a passive two-terminal electrical component that stores electrical energy in an electric field. The effect of a capacitor is known as capacitance. While some capacitance exists between any two electrical conductors in proximity in a circuit, a capacitor is a component designed to add capacitance to a circuit.";
}
else if (lowerCommand.includes('what is an inductor') || lowerCommand.includes('inductor')) {
    responseText = "An inductor, also called a choke, is a passive two-terminal electrical component that stores energy in a magnetic field when electric current flows through it. An inductor typically consists of a conductor such as a wire, usually wound into a coil.";
}
else if (lowerCommand.includes('what is a diode') || lowerCommand.includes('diode')) {
    responseText = "A diode is a two-terminal electronic component that conducts current primarily in one direction; it has low (ideally zero) resistance in one direction, and high (ideally infinite) resistance in the other. It's often used for rectification, converting AC to DC.";
}
else if (lowerCommand.includes('what is a transistor') || lowerCommand.includes('transistor')) {
    responseText = "A transistor is a semiconductor device used to amplify or switch electronic signals and electrical power. It is one of the basic building blocks of modern electronics and is essential in digital circuits like microprocessors, and analog circuits like audio amplifiers.";
}
else if (lowerCommand.includes('what is an LED') || lowerCommand.includes('LED')) {
    responseText = "An LED (Light Emitting Diode) is a semiconductor light source that emits light when current flows through it. Electrons in the semiconductor recombine with electron holes, releasing energy in the form of photons. LEDs are very energy-efficient and have a long lifespan.";
}
else if (lowerCommand.includes('what is a breadboard') || lowerCommand.includes('breadboard')) {
    responseText = "A breadboard is a solderless construction base used for prototyping of electronics. It allows you to quickly build temporary circuits and experiment with different component arrangements without having to solder anything.";
}
else if (lowerCommand.includes('what is Ohm\'s law') || lowerCommand.includes('ohms law') || lowerCommand.includes('define ohms law')) {
    responseText = "Ohm's Law states that the current through a conductor between two points is directly proportional to the voltage across the two points. Mathematically, it's expressed as V = I * R, where V is voltage, I is current, and R is resistance.";
}
else if (lowerCommand.includes('what is current') || lowerCommand.includes('define current')) {
    responseText = "Electric current is the rate of flow of electric charge past a point or region. A common analogy is the flow of water in a pipe, where current is the amount of water flowing per unit time.";
}
else if (lowerCommand.includes('what is voltage') || lowerCommand.includes('define voltage')) {
    responseText = "Voltage, also known as electric potential difference, is the difference in electric potential energy between two points per unit electric charge. It represents the 'push' or 'force' that drives electric current.";
}
else if (lowerCommand.includes('what is resistance') || lowerCommand.includes('define resistance')) {
    responseText = "Electrical resistance is a measure of the opposition to the flow of electric current in an electrical circuit. It's measured in ohms (Ω). Materials with high resistance are insulators, and those with low resistance are conductors.";
}
else if (lowerCommand.includes('what is an integrated circuit') || lowerCommand.includes('integrated circuit') || lowerCommand.includes('what is an IC') || lowerCommand.includes('IC')) {
    responseText = "An Integrated Circuit (IC), sometimes called a microchip, is a set of electronic circuits on one small flat piece (or 'chip') of semiconductor material, usually silicon. ICs are used in virtually all electronic equipment today.";
}
else if (lowerCommand.includes('what is a sensor') || lowerCommand.includes('define sensor')) {
    responseText = "A sensor is a device, module, machine, or subsystem whose purpose is to detect events or changes in its environment and send the information to other electronics, frequently a computer processor. It's a key component in gathering data from the physical world.";
}
else if (lowerCommand.includes('what is a microcontroller') || lowerCommand.includes('microcontroller')) {
    responseText = "A microcontroller is a small computer on a single metal-oxide-semiconductor (MOS) integrated circuit chip. It contains one or more CPUs along with memory and programmable input/output peripherals. Microcontrollers are used in automatically controlled products and devices, such as automobile engine control systems, implantable medical devices, remote controls, office machines, appliances, power tools, and toys.";
}
else if (lowerCommand.includes('what is a schematic') || lowerCommand.includes('schematic diagram')) {
    responseText = "A schematic diagram is a representation of the elements of a system using abstract, graphic symbols rather than realistic pictures. A schematic diagram of an electronic circuit shows the components of the circuit as simplified shapes, and the power and signal connections between them.";
}
else if (lowerCommand.includes('what is current flow direction') || lowerCommand.includes('conventional current')) {
    responseText = "Conventional current is the concept that electric current flows from the positive terminal to the negative terminal, even though electrons (which carry the charge) actually flow in the opposite direction. It's a historical convention still widely used in circuit analysis.";
}
else if (lowerCommand.includes('what is a series circuit') || lowerCommand.includes('series circuit')) {
    responseText = "In a series circuit, components are connected end-to-end, forming a single path for the current to flow. The current is the same through each component, but the voltage drops across each component add up to the total voltage.";
}
else if (lowerCommand.includes('what is a parallel circuit') || lowerCommand.includes('parallel circuit')) {
    responseText = "In a parallel circuit, components are connected across the same two points, creating multiple paths for the current. The voltage across each component is the same, but the total current is the sum of the currents through each path.";
}
// --- Digital Electronics ---
else if (lowerCommand.includes('what is a logic gate') || lowerCommand.includes('logic gate')) {
    responseText = "A logic gate is an elementary building block of a digital circuit. Most logic gates have two inputs and one output. At any given moment, every terminal is in one of the two binary conditions, low (0) or high (1).";
}
else if (lowerCommand.includes('what is an AND gate') || lowerCommand.includes('AND gate')) {
    responseText = "An AND gate is a digital logic gate that implements logical conjunction. It produces a high output (1) only if all its inputs are high (1). Otherwise, the output is low (0).";
}
else if (lowerCommand.includes('what is an OR gate') || lowerCommand.includes('OR gate')) {
    responseText = "An OR gate is a digital logic gate that implements logical disjunction. It produces a high output (1) if any of its inputs are high (1). The output is low (0) only if all inputs are low (0).";
}
else if (lowerCommand.includes('what is a NOT gate') || lowerCommand.includes('NOT gate') || lowerCommand.includes('inverter')) {
    responseText = "A NOT gate, also known as an inverter, is a digital logic gate with one input and one output. It performs logical negation, producing a high output (1) if the input is low (0), and a low output (0) if the input is high (1).";
}
else if (lowerCommand.includes('what is an XOR gate') || lowerCommand.includes('XOR gate')) {
    responseText = "An XOR (Exclusive-OR) gate is a digital logic gate that produces a high output (1) if an odd number of its inputs are high (1). If both inputs are the same (both 0 or both 1), the output is low (0).";
}
else if (lowerCommand.includes('what is a flip-flop') || lowerCommand.includes('flip flop')) {
    responseText = "A flip-flop is a basic storage element in sequential logic circuits, capable of storing one bit of information. It has two stable states and is used as a fundamental building block of digital memory and sequential logic.";
}
else if (lowerCommand.includes('what is combinational logic') || lowerCommand.includes('combinational logic')) {
    responseText = "Combinational logic is a type of digital logic circuit whose output is purely a function of the present inputs. It does not contain memory elements and its output changes immediately when inputs change.";
}
else if (lowerCommand.includes('what is sequential logic') || lowerCommand.includes('sequential logic')) {
    responseText = "Sequential logic is a type of digital logic circuit whose output depends not only on the present inputs but also on the sequence of past inputs, due to the presence of memory elements (like flip-flops).";
}
else if (lowerCommand.includes('what is a multiplexer') || lowerCommand.includes('mux')) {
    responseText = "A multiplexer (MUX) is a device that selects one of several analog or digital input signals and forwards the selected input into a single output line. It's essentially a multi-input, single-output switch.";
}
else if (lowerCommand.includes('what is a demultiplexer') || lowerCommand.includes('demux')) {
    responseText = "A demultiplexer (DEMUX) is a device that takes a single input signal and selects one of many data-output-lines, which is connected to the single input. It's the inverse of a multiplexer, acting as a single-input, multi-output switch.";
}
else if (lowerCommand.includes('what is an encoder') || lowerCommand.includes('encoder digital')) {
    responseText = "An encoder is a combinational logic circuit that converts a non-binary input code to a binary output code. For example, it might convert a decimal digit input to a binary-coded decimal (BCD) output.";
}
else if (lowerCommand.includes('what is a decoder') || lowerCommand.includes('decoder digital')) {
    responseText = "A decoder is a combinational logic circuit that converts n input lines into $2^n$ output lines. Only one output line is active for a given input combination. It's often used to convert binary codes into human-readable outputs.";
}
else if (lowerCommand.includes('what is a counter') || lowerCommand.includes('digital counter')) {
    responseText = "A digital counter is a sequential logic circuit that counts specific events or pulses applied to its input. It can be implemented using flip-flops and can count up, down, or in various sequences.";
}
else if (lowerCommand.includes('what is a register') || lowerCommand.includes('digital register')) {
    responseText = "A register is a small amount of fast storage available to the CPU within a microcontroller or processor. It holds data that the CPU is currently working on, significantly speeding up data access.";
}
else if (lowerCommand.includes('what is ADC') || lowerCommand.includes('Analog to Digital Converter')) {
    responseText = "An Analog-to-Digital Converter (ADC) is an electronic circuit that converts a continuous analog signal (like temperature or sound) into a discrete digital signal. This allows digital systems to process real-world analog data.";
}
else if (lowerCommand.includes('what is DAC') || lowerCommand.includes('Digital to Analog Converter')) {
    responseText = "A Digital-to-Analog Converter (DAC) is an electronic circuit that converts a digital signal (a sequence of binary numbers) into an analog signal (a continuous voltage or current). It's the opposite of an ADC.";
}
else if (lowerCommand.includes('what is a buffer') || lowerCommand.includes('digital buffer')) {
    responseText = "In digital electronics, a buffer is a logic gate that simply passes its input to its output without changing its logical state. It's used primarily to provide current amplification (buffering) to drive multiple loads or to isolate circuits.";
}
else if (lowerCommand.includes('what is CMOS') || lowerCommand.includes('CMOS logic')) {
    responseText = "CMOS (Complementary Metal-Oxide-Semiconductor) is a technology for constructing integrated circuits. It uses complementary and symmetrical pairs of p-type and n-type MOSFETs for logic functions, known for low power consumption.";
}
else if (lowerCommand.includes('what is TTL') || lowerCommand.includes('TTL logic')) {
    responseText = "TTL (Transistor-Transistor Logic) is a class of digital logic circuits constructed from bipolar junction transistors. It was widely used for digital ICs, known for its speed, but typically consumes more power than CMOS.";
}
else if (lowerCommand.includes('what is tristate logic') || lowerCommand.includes('tri-state buffer')) {
    responseText = "Tri-state logic refers to a digital output that can be in one of three states: high (1), low (0), or high-impedance (Z). The high-impedance state effectively disconnects the output, allowing multiple devices to share a bus.";
}
else if (lowerCommand.includes('what is FPGA') || lowerCommand.includes('Field-Programmable Gate Array')) {
    responseText = "An FPGA (Field-Programmable Gate Array) is an integrated circuit designed to be configured by a customer or a designer after manufacturing. FPGAs are highly flexible and can implement any digital circuit, making them suitable for rapid prototyping and custom hardware acceleration.";
}
else if (lowerCommand.includes('what is ASIC') || lowerCommand.includes('Application-Specific Integrated Circuit')) {
    responseText = "An ASIC (Application-Specific Integrated Circuit) is an integrated circuit customized for a particular use, rather than general-purpose use. ASICs are designed for specific tasks, leading to higher performance and lower power consumption for that task, but involve high initial design costs.";
}
else if (lowerCommand.includes('what is HDL') || lowerCommand.includes('Hardware Description Language')) {
    responseText = "HDL (Hardware Description Language) is a specialized computer language used to describe the structure, design, and operation of electronic circuits. VHDL and Verilog are common HDLs used for designing digital systems, particularly FPGAs and ASICs.";
}
else if (lowerCommand.includes('what is a state machine') || lowerCommand.includes('finite state machine')) {
    responseText = "A state machine (or finite state machine, FSM) is a mathematical model of computation used to design sequential logic circuits. It consists of a finite number of states, transitions between those states, and actions that can be performed upon entering a state or taking a transition.";
}
else if (lowerCommand.includes('what is DRAM') || lowerCommand.includes('Dynamic Random Access Memory')) {
    responseText = "DRAM (Dynamic Random Access Memory) is a type of random-access memory that stores each bit of data in a separate capacitor within an integrated circuit. It requires periodic refreshing of its charge to maintain the stored data, hence the term 'dynamic'.";
}
else if (lowerCommand.includes('what is SRAM') || lowerCommand.includes('Static Random Access Memory')) {
    responseText = "SRAM (Static Random Access Memory) is a type of random-access memory that uses latching circuitry (flip-flops) to store each bit. Unlike DRAM, it does not need to be refreshed periodically, making it faster but more expensive and less dense.";
}
else if (lowerCommand.includes('what is ROM') || lowerCommand.includes('Read Only Memory')) {
    responseText = "ROM (Read-Only Memory) is a type of non-volatile memory used in computers and other electronic devices. Data stored in ROM cannot be electronically modified after the manufacturing of the memory device, or requires significant effort to do so.";
}
else if (lowerCommand.includes('what is flash memory') || lowerCommand.includes('flash storage')) {
    responseText = "Flash memory is a non-volatile computer memory that can be electrically erased and reprogrammed. It is a type of EEPROM and is widely used in USB flash drives, solid-state drives (SSDs), digital cameras, and mobile phones for data storage.";
}
else if (lowerCommand.includes('what is a shift register') || lowerCommand.includes('shift register')) {
    responseText = "A shift register is a digital circuit that can store and move data by shifting bits sequentially. It's often used for serial-to-parallel conversion, parallel-to-serial conversion, or as a delay element.";
}

// --- Electronic Circuits and Network Analysis (Advanced) ---
else if (lowerCommand.includes('what are Kirchhoff\'s Laws') || lowerCommand.includes('Kirchhoff\'s Laws') || lowerCommand.includes('KCL') || lowerCommand.includes('KVL')) {
    responseText = "Kirchhoff's Laws are two fundamental laws for circuit analysis. Kirchhoff's Current Law (KCL) states that the algebraic sum of currents entering a node (or a junction) is zero. Kirchhoff's Voltage Law (KVL) states that the algebraic sum of voltages around any closed loop in a circuit is zero.";
}
else if (lowerCommand.includes('what is Thevenin\'s Theorem') || lowerCommand.includes('Thevenin\'s Theorem') || lowerCommand.includes('thevenin')) {
    responseText = "Thevenin's Theorem states that any linear electrical network containing only voltage sources, current sources, and resistors can be replaced by an equivalent circuit consisting of a single voltage source (Vth) in series with a single resistor (Rth).";
}
else if (lowerCommand.includes('what is Norton\'s Theorem') || lowerCommand.includes('Norton\'s Theorem') || lowerCommand.includes('norton')) {
    responseText = "Norton's Theorem states that any linear electrical network can be replaced by an equivalent circuit consisting of a single current source (In) in parallel with a single resistor (Rn).";
}
else if (lowerCommand.includes('what is superposition theorem') || lowerCommand.includes('superposition')) {
    responseText = "The Superposition Theorem states that in any linear circuit with multiple independent sources, the total current or voltage for any element is the algebraic sum of the currents or voltages produced by each source acting alone, with all other independent sources turned off (voltage sources shorted, current sources opened).";
}
else if (lowerCommand.includes('what is maximum power transfer theorem') || lowerCommand.includes('maximum power transfer')) {
    responseText = "The Maximum Power Transfer Theorem states that to obtain maximum external power from a source with a finite internal resistance, the resistance of the load must be equal to the resistance of the source as viewed from its output terminals.";
}
else if (lowerCommand.includes('what is impedance') || lowerCommand.includes('define impedance')) {
    responseText = "Impedance is the measure of the opposition that a circuit presents to a current when a voltage is applied. In AC circuits, impedance is a more general concept than resistance, as it includes both resistance and reactance. It's represented by a complex number.";
}
else if (lowerCommand.includes('what is reactance') || lowerCommand.includes('define reactance')) {
    responseText = "Reactance is the opposition to the change of current or voltage in an electrical circuit due to inductance or capacitance. It is a component of impedance and is frequency-dependent. Inductive reactance ($X_L$) increases with frequency, while capacitive reactance ($X_C$) decreases with frequency.";
}
else if (lowerCommand.includes('what is admittance') || lowerCommand.includes('define admittance')) {
    responseText = "Admittance is a measure of how easily a circuit or device allows current to flow. It is the reciprocal of impedance, and in AC circuits, it's represented by a complex number. Its real part is conductance, and its imaginary part is susceptance.";
}
else if (lowerCommand.includes('what is resonance') || lowerCommand.includes('resonant frequency')) {
    responseText = "Resonance in an electrical circuit occurs when the impedance of the circuit is purely resistive, meaning the inductive and capacitive reactances cancel each other out. This typically happens at a specific resonant frequency, leading to maximum current or voltage response.";
}
else if (lowerCommand.includes('what is a low-pass filter') || lowerCommand.includes('low pass filter')) {
    responseText = "A low-pass filter is an electronic filter that passes signals with a frequency lower than a certain cutoff frequency and attenuates signals with frequencies higher than the cutoff frequency. It smooths out rapidly changing signals.";
}
else if (lowerCommand.includes('what is a high-pass filter') || lowerCommand.includes('high pass filter')) {
    responseText = "A high-pass filter is an electronic filter that passes signals with a frequency higher than a certain cutoff frequency and attenuates signals with frequencies lower than the cutoff frequency. It blocks DC components and low-frequency noise.";
}
else if (lowerCommand.includes('what is a band-pass filter') || lowerCommand.includes('band pass filter')) {
    responseText = "A band-pass filter is an electronic filter that passes signals within a certain frequency range (a 'band') and attenuates signals outside that range. It's used to isolate a specific frequency or range of frequencies.";
}
else if (lowerCommand.includes('what is a band-stop filter') || lowerCommand.includes('band stop filter') || lowerCommand.includes('notch filter')) {
    responseText = "A band-stop filter, also known as a band-rejection filter or notch filter, is an electronic filter that attenuates signals within a certain frequency range and passes signals outside that range. It's often used to remove unwanted specific frequencies, like 60Hz hum.";
}
else if (lowerCommand.includes('what is a transfer function') || lowerCommand.includes('transfer function electronics')) {
    responseText = "In electronics and control theory, a transfer function is a mathematical representation of the relationship between the output and input of a linear, time-invariant system. It's typically expressed in the Laplace domain.";
}
else if (lowerCommand.includes('what is a bode plot') || lowerCommand.includes('bode plot')) {
    responseText = "A Bode plot is a graph of the frequency response of a system. It typically consists of two plots: one for the magnitude (in decibels) and one for the phase shift (in degrees) of the transfer function, plotted against frequency.";
}
else if (lowerCommand.includes('what is the s-plane') || lowerCommand.includes('s plane') || lowerCommand.includes('laplace transform')) {
    responseText = "The s-plane is a complex plane where the horizontal axis represents the real part (sigma) and the vertical axis represents the imaginary part (omega) of the complex variable 's' used in the Laplace transform. It's a fundamental tool for analyzing linear time-invariant systems.";
}
else if (lowerCommand.includes('what is transient response') || lowerCommand.includes('transient response circuit')) {
    responseText = "The transient response of a circuit describes its behavior as it changes from one steady state to another, typically immediately after a switch is opened or closed, or a sudden change in input occurs. It's temporary and eventually settles to a steady state.";
}
else if (lowerCommand.includes('what is steady-state response') || lowerCommand.includes('steady state response circuit')) {
    responseText = "The steady-state response of a circuit is the behavior of the circuit after all transient effects have died out. For DC circuits, this is a constant value; for AC circuits, it's a sinusoidal response at the input frequency.";
}
else if (lowerCommand.includes('what is quality factor') || lowerCommand.includes('Q factor')) {
    responseText = "The Quality Factor (Q factor) is a dimensionless parameter that describes how underdamped an oscillator or resonator is. In resonant circuits, a higher Q factor indicates lower energy loss and a narrower bandwidth.";
}
else if (lowerCommand.includes('what is a filter order') || lowerCommand.includes('filter order')) {
    responseText = "The order of a filter refers to the number of reactive components (capacitors and inductors) in its passive implementation, or the highest power of 's' in the denominator of its transfer function for active filters. Higher order filters generally have steeper roll-offs.";
}
else if (lowerCommand.includes('what is damping factor') || lowerCommand.includes('damping ratio')) {
    responseText = "The damping factor (or damping ratio, $\zeta$) is a dimensionless measure describing how oscillations in a system decay after a disturbance. A critically damped system ($\zeta=1$) returns to equilibrium as quickly as possible without oscillating.";
}
else if (lowerCommand.includes('what is phase margin') || lowerCommand.includes('phase margin')) {
    responseText = "Phase margin is a measure of the stability of a feedback control system. It is the amount of additional phase lag that can be added to the system at the gain crossover frequency before it becomes unstable.";
}
else if (lowerCommand.includes('what is gain margin') || lowerCommand.includes('gain margin')) {
    responseText = "Gain margin is a measure of the stability of a feedback control system. It is the amount of gain (in dB) that can be added to the system at the phase crossover frequency before it becomes unstable.";
}
else if (lowerCommand.includes('what is an equivalent circuit') || lowerCommand.includes('equivalent circuit')) {
    responseText = "An equivalent circuit is a simplified circuit that behaves identically to a more complex circuit, at least with respect to its terminals. Thevenin and Norton equivalent circuits are common examples used to simplify analysis.";
}

// --- Analog Electronics ---
else if (lowerCommand.includes('what is an operational amplifier') || lowerCommand.includes('op-amp')) {
    responseText = "An operational amplifier (op-amp) is a DC-coupled high-gain electronic voltage amplifier with a differential input and, usually, a single-ended output. It's a versatile building block for many analog circuits, used for amplification, filtering, summing, and more.";
}
else if (lowerCommand.includes('what is negative feedback') || lowerCommand.includes('negative feedback op-amp')) {
    responseText = "Negative feedback is a method of controlling a system by feeding a portion of its output back into its input in an opposing phase. In op-amps, it stabilizes gain, reduces distortion, and improves bandwidth.";
}
else if (lowerCommand.includes('what is positive feedback') || lowerCommand.includes('positive feedback op-amp')) {
    responseText = "Positive feedback is a process in which a portion of the output signal is fed back to the input in phase with the input signal. Unlike negative feedback, it tends to increase gain, making it useful in oscillators and regenerative circuits, but can also lead to instability.";
}
else if (lowerCommand.includes('what is a voltage regulator') || lowerCommand.includes('voltage regulator')) {
    responseText = "A voltage regulator is an electronic circuit that maintains a constant output voltage regardless of changes in the input voltage or load current. They are essential for providing stable power to sensitive electronic components.";
}
else if (lowerCommand.includes('what is a rectifier') || lowerCommand.includes('rectifier circuit')) {
    responseText = "A rectifier is an electrical device that converts alternating current (AC) to direct current (DC). It typically uses diodes to allow current flow in only one direction. Common types include half-wave and full-wave rectifiers.";
}
else if (lowerCommand.includes('what is an oscillator') || lowerCommand.includes('oscillator circuit')) {
    responseText = "An oscillator is an electronic circuit that produces a repetitive, oscillating electronic signal, often a sine wave or a square wave. They are fundamental in clock generation, radio transmitters, and signal generators.";
}
else if (lowerCommand.includes('what is common-emitter configuration') || lowerCommand.includes('common emitter')) {
    responseText = "The common-emitter configuration is a type of BJT amplifier where the emitter terminal is common to both the input and output. It provides both voltage and current gain and is widely used for amplification.";
}
else if (lowerCommand.includes('what is common-collector configuration') || lowerCommand.includes('common collector') || lowerCommand.includes('emitter follower')) {
    responseText = "The common-collector configuration, also known as an emitter follower, is a type of BJT amplifier where the collector terminal is common. It provides high current gain and voltage buffering, useful for impedance matching.";
}
else if (lowerCommand.includes('what is common-base configuration') || lowerCommand.includes('common base')) {
    responseText = "The common-base configuration is a type of BJT amplifier where the base terminal is common. It provides good voltage gain but no current gain, primarily used in high-frequency applications.";
}
else if (lowerCommand.includes('what is an inverter op-amp') || lowerCommand.includes('inverting amplifier')) {
    responseText = "An inverting amplifier is an op-amp configuration where the output signal is out of phase by 180 degrees with respect to the input signal, and its gain is determined by the ratio of two resistors.";
}
else if (lowerCommand.includes('what is a non-inverting amplifier') || lowerCommand.includes('non inverting amplifier')) {
    responseText = "A non-inverting amplifier is an op-amp configuration where the output signal is in phase with the input signal, and its gain is determined by the ratio of two resistors plus one.";
}
else if (lowerCommand.includes('what is a voltage follower') || lowerCommand.includes('unity gain buffer')) {
    responseText = "A voltage follower, or unity gain buffer, is an op-amp configuration that provides a gain of 1. Its primary use is for impedance matching, preventing a source from being loaded by a low-impedance load.";
}
else if (lowerCommand.includes('what is an instrumentation amplifier') || lowerCommand.includes('instrumentation amplifier')) {
    responseText = "An instrumentation amplifier is a type of differential amplifier that is highly precise and stable, commonly used for amplifying very small differential signals in noisy environments. It typically has high input impedance and high common-mode rejection ratio.";
}
else if (lowerCommand.includes('what is a comparator') || lowerCommand.includes('comparator circuit')) {
    responseText = "A comparator is an electronic circuit that compares two input voltages or currents and outputs a digital signal indicating which is larger. It's often implemented using an op-amp in an open-loop configuration.";
}
else if (lowerCommand.includes('what is hysteresis') || lowerCommand.includes('hysteresis electronic')) {
    responseText = "Hysteresis in electronics refers to the dependence of a system's output on its past inputs as well as its present input. In circuits like Schmitt triggers, it prevents rapid, unwanted switching due to noise around the threshold.";
}
else if (lowerCommand.includes('what is a voltage controlled oscillator') || lowerCommand.includes('VCO')) {
    responseText = "A VCO (Voltage Controlled Oscillator) is an electronic oscillator whose oscillation frequency is controlled by a voltage input. The applied input voltage determines the instantaneous oscillation frequency.";
}
else if (lowerCommand.includes('what is a phase-locked loop') || lowerCommand.includes('PLL')) {
    responseText = "A PLL (Phase-Locked Loop) is a control system that generates an output signal whose phase is related to the phase of an input 'reference' signal. It's used for frequency synthesis, demodulation, and clock recovery in communication systems.";
}
else if (lowerCommand.includes('what is total harmonic distortion') || lowerCommand.includes('THD')) {
    responseText = "THD (Total Harmonic Distortion) is a measurement of the harmonic distortion present in a signal. It's defined as the ratio of the sum of the powers of all harmonic components to the power of the fundamental frequency, indicating signal purity.";
}
else if (lowerCommand.includes('what is slew rate') || lowerCommand.includes('op-amp slew rate')) {
    responseText = "Slew rate is the maximum rate of change of output voltage per unit of time, typically measured in volts per microsecond (V/μs). It limits the speed at which an op-amp's output can change, affecting its performance at higher frequencies.";
}
else if (lowerCommand.includes('what is offset voltage') || lowerCommand.includes('op-amp offset voltage')) {
    responseText = "Input offset voltage is the differential DC voltage required between the two input terminals of an op-amp to make the output zero. It's an imperfection that can cause a small DC voltage at the output even with zero input.";
}

// --- Semiconductor Devices (Detailed) ---
else if (lowerCommand.includes('what is a PN junction') || lowerCommand.includes('PN junction diode')) {
    responseText = "A PN junction is the boundary or interface between two types of semiconductor materials, p-type and n-type, inside a single crystal of semiconductor. It forms the basis of all semiconductor devices like diodes, transistors, and solar cells.";
}
else if (lowerCommand.includes('what is doping') || lowerCommand.includes('semiconductor doping')) {
    responseText = "Doping is the process of intentionally introducing impurities into an intrinsic semiconductor for the purpose of modulating its electrical properties, such as its electron and hole concentrations. This creates p-type or n-type semiconductors.";
}
else if (lowerCommand.includes('what is a Zener diode') || lowerCommand.includes('zener diode')) {
    responseText = "A Zener diode is a special type of diode designed to reliably allow current to flow in the reverse direction when a certain reverse voltage, known as the Zener voltage, is reached. It's primarily used for voltage regulation.";
}
else if (lowerCommand.includes('what is a Schottky diode') || lowerCommand.includes('schottky diode')) {
    responseText = "A Schottky diode is a semiconductor diode with a very low forward voltage drop and a very fast switching action. It's formed by a metal-semiconductor junction, rather than a p-n junction, making it useful in high-speed switching and RF applications.";
}
else if (lowerCommand.includes('what is a BJT') || lowerCommand.includes('Bipolar Junction Transistor')) {
    responseText = "A BJT (Bipolar Junction Transistor) is a type of transistor that uses both electron and hole charge carriers. It's a current-controlled device and comes in NPN and PNP types, used for amplification and switching.";
}
else if (lowerCommand.includes('what is an FET') || lowerCommand.includes('Field-Effect Transistor')) {
    responseText = "An FET (Field-Effect Transistor) is a type of transistor that uses an electric field to control the flow of current. Unlike BJTs, FETs are voltage-controlled devices and have high input impedance, coming in JFET and MOSFET variations.";
}
else if (lowerCommand.includes('what is a MOSFET') || lowerCommand.includes('MOSFET transistor')) {
    responseText = "A MOSFET (Metal-Oxide-Semiconductor Field-Effect Transistor) is the most common type of FET. It's a voltage-controlled device known for high input impedance and is crucial in digital circuits, power electronics, and integrated circuits due to its scalability and low power consumption.";
}
else if (lowerCommand.includes('what is an SCR') || lowerCommand.includes('Silicon Controlled Rectifier')) {
    responseText = "An SCR (Silicon Controlled Rectifier) is a four-layer solid-state device that controls current flow. It acts as a switch, remaining off until a small current is applied to its gate terminal, after which it conducts heavily until the main current is interrupted.";
}
else if (lowerCommand.includes('what is a TRIAC') || lowerCommand.includes('triac')) {
    responseText = "A TRIAC (Triode for Alternating Current) is a three-terminal electronic component that conducts current in either direction when triggered by a gate signal. It's commonly used in AC power control applications like light dimmers and motor speed controls.";
}
else if (lowerCommand.includes('what is a DIAC') || lowerCommand.includes('diac')) {
    responseText = "A DIAC (Diode for Alternating Current) is a two-terminal, three-layer semiconductor device that conducts electrical current only after its breakdown voltage has been reached. It's often used to trigger TRIACs.";
}
else if (lowerCommand.includes('what is an IGBT') || lowerCommand.includes('Insulated Gate Bipolar Transistor')) {
    responseText = "An IGBT (Insulated Gate Bipolar Transistor) is a three-terminal power semiconductor device primarily used as an electronic switch. It combines the high input impedance of a MOSFET with the low on-state voltage drop and high current handling capability of a BJT.";
}
else if (lowerCommand.includes('what is a photodiode') || lowerCommand.includes('photodiode')) {
    responseText = "A photodiode is a semiconductor device that converts light into an electrical current. When light strikes the photodiode, it creates electron-hole pairs, generating a current proportional to the light intensity.";
}
else if (lowerCommand.includes('what is a phototransistor') || lowerCommand.includes('phototransistor')) {
    responseText = "A phototransistor is a light-sensitive transistor, similar to a photodiode but with internal gain. When light strikes its base junction, it generates a much larger output current compared to a photodiode, making it more sensitive to light.";
}
else if (lowerCommand.includes('what is a thermistor') || lowerCommand.includes('thermistor')) {
    responseText = "A thermistor is a type of resistor whose resistance is strongly dependent on temperature. It's widely used as a temperature sensor, with its resistance typically decreasing significantly as temperature increases (NTC thermistor).";
}
else if (lowerCommand.includes('what is an LDR') || lowerCommand.includes('Light Dependent Resistor')) {
    responseText = "An LDR (Light Dependent Resistor), also known as a photoresistor, is a passive component whose resistance decreases with increasing incident light intensity. It's often used in light-sensing applications.";
}
else if (lowerCommand.includes('what is a varactor diode') || lowerCommand.includes('varicap diode')) {
    responseText = "A varactor diode (or varicap diode) is a type of diode whose capacitance varies with the reverse voltage applied across its terminals. This property makes them useful in voltage-controlled oscillators, frequency multipliers, and tunable filters.";
}
else if (lowerCommand.includes('what is an optocoupler') || lowerCommand.includes('optocoupler') || lowerCommand.includes('opt-isolator')) {
    responseText = "An optocoupler (or opto-isolator) is an electronic component that transfers electrical signals between two isolated circuits by using light. It prevents high voltages or rapid voltage transients in one part of a system from affecting the other, providing electrical isolation.";
}

// --- Sensors & Actuators (Expanded) ---
else if (lowerCommand.includes('what is a temperature sensor') || lowerCommand.includes('temperature sensor')) {
    responseText = "A temperature sensor is a device that measures temperature. Common types include thermistors, RTDs (Resistance Temperature Detectors), thermocouples, and semiconductor-based IC sensors.";
}
else if (lowerCommand.includes('what is an RTD') || lowerCommand.includes('Resistance Temperature Detector')) {
    responseText = "An RTD (Resistance Temperature Detector) is a temperature sensor that changes its resistance with temperature. It's known for high accuracy and stability, often made of platinum, copper, or nickel.";
}
else if (lowerCommand.includes('what is a thermocouple') || lowerCommand.includes('thermocouple')) {
    responseText = "A thermocouple is a temperature sensor consisting of two dissimilar electrical conductors forming electrical junctions at differing temperatures. It produces a temperature-dependent voltage as a result of the Seebeck effect, allowing for temperature measurement over wide ranges.";
}
else if (lowerCommand.includes('what is a pressure sensor') || lowerCommand.includes('pressure sensor')) {
    responseText = "A pressure sensor is a device that measures pressure, typically of gases or liquids. Pressure is an expression of the force required to stop a fluid from expanding, and pressure sensors convert this force into an electrical signal.";
}
else if (lowerCommand.includes('what is an ultrasonic sensor') || lowerCommand.includes('ultrasonic sensor')) {
    responseText = "An ultrasonic sensor measures distance by emitting ultrasonic waves and listening for the echo. By calculating the time taken for the sound to return, it determines the distance to an object. It's common in robotics and object detection.";
}
else if (lowerCommand.includes('what is an infrared sensor') || lowerCommand.includes('IR sensor')) {
    responseText = "An infrared (IR) sensor is an electronic device that measures or detects infrared radiation in its environment. It can be used for motion detection, proximity sensing, object detection, and even thermal imaging.";
}
else if (lowerCommand.includes('what is a motion sensor') || lowerCommand.includes('PIR sensor')) {
    responseText = "A motion sensor, often a PIR (Passive Infrared) sensor, detects movement by measuring changes in infrared radiation levels in its field of view. It's commonly used in security systems and automatic lighting.";
}
else if (lowerCommand.includes('what is a humidity sensor') || lowerCommand.includes('humidity sensor')) {
    responseText = "A humidity sensor (or hygrometer) detects and measures the amount of water vapor in the air. These sensors are crucial for environmental monitoring, HVAC systems, and weather stations.";
}
else if (lowerCommand.includes('what is an accelerometer') || lowerCommand.includes('accelerometer')) {
    responseText = "An accelerometer is a device that measures proper acceleration. This is the acceleration (or rate of change of velocity) of a body in its own rest frame. It's used to detect tilt, vibration, and orientation changes.";
}
else if (lowerCommand.includes('what is a gyroscope') || lowerCommand.includes('gyroscope sensor')) {
    responseText = "A gyroscope is a device that measures or maintains orientation and angular velocity. It detects rotation around an axis and is often paired with accelerometers in IMUs (Inertial Measurement Units) for more complete motion sensing.";
}
else if (lowerCommand.includes('what is a magnetomter') || lowerCommand.includes('magnetometer')) {
    responseText = "A magnetometer is an instrument that measures magnetic field strength or direction. In electronics, they are used in compasses, navigation systems, and metal detectors.";
}
else if (lowerCommand.includes('what is a proximity sensor') || lowerCommand.includes('proximity sensor')) {
    responseText = "A proximity sensor is a non-contact sensor that detects the presence of nearby objects without any physical contact. They work by emitting an electromagnetic field or a beam of radiation and looking for changes in the return signal.";
}
else if (lowerCommand.includes('what is a force sensor') || lowerCommand.includes('force sensor') || lowerCommand.includes('load cell')) {
    responseText = "A force sensor, often called a load cell, is a transducer that converts a force into an electrical signal. The electrical signal output is proportional to the applied force. They are used in scales, robotic grippers, and industrial measurement.";
}
else if (lowerCommand.includes('what is a flex sensor') || lowerCommand.includes('flex sensor')) {
    responseText = "A flex sensor is a sensor that measures the amount of bend or deflection. As the sensor is bent, the resistance across it increases. They are commonly used in robotics, gaming, and virtual reality gloves.";
}
else if (lowerCommand.includes('what is a gas sensor') || lowerCommand.includes('gas sensor')) {
    responseText = "A gas sensor is an electronic device that detects the presence and concentration of different types of gases in an area. They are used to detect combustible, flammable, and toxic gases, as well as oxygen depletion, in various environments.";
}
else if (lowerCommand.includes('what is a pH sensor') || lowerCommand.includes('pH sensor')) {
    responseText = "A pH sensor measures the acidity or alkalinity of a liquid. It typically consists of a glass electrode that generates a voltage proportional to the hydrogen ion concentration in the solution. Important for water quality, chemical processes, and agriculture.";
}
else if (lowerCommand.includes('what is a photoelectric sensor') || lowerCommand.includes('photoelectric sensor')) {
    responseText = "A photoelectric sensor detects the presence or absence of an object by emitting a light beam (usually infrared) and detecting whether the light is returned. They are widely used in automation and industrial applications.";
}
else if (lowerCommand.includes('what is an encoder sensor') || lowerCommand.includes('rotary encoder')) {
    responseText = "An encoder sensor converts linear or rotary motion into digital signals. Rotary encoders, for example, detect angular position or motion and are commonly used for precise control in robotics and industrial machinery.";
}
else if (lowerCommand.includes('what is an IMU') || lowerCommand.includes('Inertial Measurement Unit')) {
    responseText = "An IMU (Inertial Measurement Unit) is an electronic device that measures and reports a body's specific force, angular rate, and sometimes the magnetic field surrounding the body, using a combination of accelerometers, gyroscopes, and often magnetometers.";
}
else if (lowerCommand.includes('what is a motor') || lowerCommand.includes('electric motor')) {
    responseText = "An electric motor is an electrical machine that converts electrical energy into mechanical energy. Most electric motors operate through the interaction between the motor's magnetic field and electric current in a wire winding to generate force in the form of torque.";
}
else if (lowerCommand.includes('what is a servo motor') || lowerCommand.includes('servo motor')) {
    responseText = "A servo motor is a rotary actuator that allows for precise control of angular position, velocity, and acceleration. It consists of a motor, a feedback sensor (often an encoder), and a control circuit. Commonly used in robotics and RC applications.";
}
else if (lowerCommand.includes('what is a stepper motor') || lowerCommand.includes('stepper motor')) {
    responseText = "A stepper motor is a brushless DC electric motor that divides a full rotation into a number of equal steps. It can be commanded to move and hold at any of these steps without a feedback sensor (open-loop control), making it ideal for precise positioning.";
}
else if (lowerCommand.includes('what is an actuator') || lowerCommand.includes('define actuator')) {
    responseText = "An actuator is a component of a machine that is responsible for moving and controlling a mechanism or system. It converts electrical, hydraulic, or pneumatic energy into mechanical motion. Motors, solenoids, and relays are common actuators.";
}
else if (lowerCommand.includes('what is a solenoid') || lowerCommand.includes('solenoid')) {
    responseText = "A solenoid is a type of electromagnet, the purpose of which is to generate a controlled magnetic field. When current passes through its coil, it creates a magnetic field that can be used to pull or push a plunger, converting electrical energy into linear mechanical motion.";
}
else if (lowerCommand.includes('what is a relay') || lowerCommand.includes('relay')) {
    responseText = "A relay is an electrically operated switch. It uses an electromagnet to mechanically operate a switch, either opening or closing a circuit. Relays are used to control a high-power circuit using a low-power signal, or to control multiple circuits with one signal.";
}
else if (lowerCommand.includes('what is a haptic actuator') || lowerCommand.includes('haptic feedback')) {
    responseText = "A haptic actuator is a device that creates a sense of touch by applying forces, vibrations, or motions to the user. It's used in touchscreens, gaming controllers, and virtual reality to provide haptic feedback.";
}

// --- Microcontrollers & Embedded Systems (Expanded) ---
else if (lowerCommand.includes('what is arduino') || lowerCommand.includes('define arduino')) {
    responseText = "Arduino is an open-source electronics platform that makes it easy to create a wide variety of interactive electronic objects and projects. It consists of two main parts: a physical programmable circuit board, known as a microcontroller, and a piece of software, or IDE (Integrated Development Environment), that runs on your computer. You use the IDE to write and upload code to the physical board.";
}
else if (lowerCommand.includes('what are arduino shields') || lowerCommand.includes('arduino shield')) {
    responseText = "Arduino shields are pre-assembled circuit boards that can be easily plugged on top of an Arduino board, extending its capabilities. They provide additional functionality like Ethernet connectivity, motor control, or wireless communication, without requiring complex wiring.";
}
else if (lowerCommand.includes('what is the arduino IDE') || lowerCommand.includes('arduino IDE')) {
    responseText = "The Arduino IDE (Integrated Development Environment) is a cross-platform application written in Java, designed to write, compile, and upload code to Arduino compatible boards. It provides a simple environment for programming microcontrollers.";
}
else if (lowerCommand.includes('what is GPIO') || lowerCommand.includes('General Purpose Input/Output')) {
    responseText = "GPIO stands for General Purpose Input/Output. These are generic pins on a microcontroller that can be configured by software to either input or output digital signals (high or low voltage). They are fundamental for interacting with sensors, LEDs, buttons, and other external components.";
}
else if (lowerCommand.includes('what is UART') || lowerCommand.includes('Universal Asynchronous Receiver/Transmitter')) {
    responseText = "UART (Universal Asynchronous Receiver/Transmitter) is a hardware communication protocol that transmits and receives serial data asynchronously. It's a common method for communication between microcontrollers and other devices like computers (via USB-to-serial converters).";
}
else if (lowerCommand.includes('what is SPI') || lowerCommand.includes('Serial Peripheral Interface')) {
    responseText = "SPI (Serial Peripheral Interface) is a synchronous serial communication interface specification used for short-distance communication, primarily in embedded systems. It operates in full duplex mode and typically uses four wires: MOSI, MISO, SCK, and SS.";
}
else if (lowerCommand.includes('what is I2C') || lowerCommand.includes('IIC') || lowerCommand.includes('Inter-Integrated Circuit')) {
    responseText = "I2C (Inter-Integrated Circuit), also known as IIC, is a multi-master, multi-slave serial communication bus used for connecting low-speed peripheral ICs to processors and microcontrollers. It uses only two bidirectional lines, SDA (data) and SCL (clock), making it very efficient.";
}
else if (lowerCommand.includes('what are interrupts') || lowerCommand.includes('microcontroller interrupts')) {
    responseText = "Interrupts are signals from hardware or software that indicate an event needs immediate attention from the CPU. When an interrupt occurs, the CPU temporarily suspends its current task, executes a specific 'Interrupt Service Routine' (ISR), and then resumes its previous task.";
}
else if (lowerCommand.includes('what is PWM') || lowerCommand.includes('Pulse Width Modulation')) {
    responseText = "PWM (Pulse Width Modulation) is a technique used to control the average power delivered to an electrical device by varying the width of electrical pulses. By changing the duty cycle (on-time vs. off-time), you can effectively control brightness of LEDs, speed of motors, etc.";
}
else if (lowerCommand.includes('what is a watchdog timer') || lowerCommand.includes('watchdog timer')) {
    responseText = "A watchdog timer is an electronic timer that is used to detect and recover from malfunctions in embedded systems. If the main program fails to reset the watchdog timer periodically (e.g., due to a software error), the timer will time out and reset the system.";
}
else if (lowerCommand.includes('what is a bootloader') || lowerCommand.includes('bootloader')) {
    responseText = "A bootloader is a small piece of code that runs when a microcontroller or computer first powers on or resets. Its primary function is to initialize the system and then load a larger program (like your Arduino sketch) into memory and start its execution.";
}
else if (lowerCommand.includes('what is firmware') || lowerCommand.includes('define firmware')) {
    responseText = "Firmware is a specific class of computer software that provides low-level control for a device's specific hardware. It's typically stored in non-volatile memory (like Flash ROM) and is responsible for basic functions, allowing higher-level software to interact with the hardware.";
}
else if (lowerCommand.includes('what is an RTOS') || lowerCommand.includes('Real-Time Operating System')) {
    responseText = "An RTOS (Real-Time Operating System) is an operating system intended for real-time applications, meaning it guarantees that certain operations will be completed within specific time constraints. RTOSes are crucial in embedded systems where timely responses are critical, such as in industrial control or medical devices.";
}
else if (lowerCommand.includes('what is memory in a microcontroller') || lowerCommand.includes('microcontroller memory')) {
    responseText = "Microcontrollers typically have different types of memory: Flash memory (for storing the program code), SRAM (Static RAM, for temporary data and variables), and EEPROM (Electrically Erasable Programmable Read-Only Memory, for small amounts of persistent data).";
}
else if (lowerCommand.includes('what is an instruction set') || lowerCommand.includes('instruction set architecture')) {
    responseText = "An instruction set (or Instruction Set Architecture - ISA) is the set of all instructions that a central processing unit (CPU) can understand and execute. It defines the commands that a processor knows, including operations, data types, and memory addressing modes.";
}
else if (lowerCommand.includes('what is raspberry pi') || lowerCommand.includes('raspberry pi')) {
    responseText = "The Raspberry Pi is a series of small single-board computers (SBCs) developed in the United Kingdom by the Raspberry Pi Foundation to promote the teaching of basic computer science in schools and developing countries. Unlike Arduino, it's a full-fledged computer capable of running an operating system.";
}
else if (lowerCommand.includes('arduino vs raspberry pi') || lowerCommand.includes('difference between arduino and raspberry pi')) {
    responseText = "Arduino is a microcontroller board, ideal for controlling hardware and real-time operations, programmed in a simplified C/C++. Raspberry Pi is a single-board computer, capable of running an OS like Linux, better for complex computing tasks, networking, and software applications.";
}
else if (lowerCommand.includes('what is an embedded system') || lowerCommand.includes('embedded system')) {
    responseText = "An embedded system is a computer system—a combination of a computer processor, computer memory, and input/output peripheral devices—that has a dedicated function within a larger mechanical or electrical system. It's designed to perform a specific task, often with real-time computing constraints.";
}
else if (lowerCommand.includes('what is cross-compilation') || lowerCommand.includes('cross compilation')) {
    responseText = "Cross-compilation is the process of compiling code on one computer architecture (the host) for execution on a different computer architecture (the target). This is common in embedded systems development, where code for a microcontroller is compiled on a desktop PC.";
}
else if (lowerCommand.includes('what is an IDE') || lowerCommand.includes('Integrated Development Environment')) {
    responseText = "An IDE (Integrated Development Environment) is a software application that provides comprehensive facilities to computer programmers for software development. It typically consists of a source code editor, build automation tools, and a debugger.";
}
else if (lowerCommand.includes('what is a debugger') || lowerCommand.includes('debugger electronics')) {
    responseText = "A debugger is a computer program that is used to test and debug other programs (the 'target' program). It allows a programmer to step through code, inspect variables, and set breakpoints to find and fix errors.";
}
else if (lowerCommand.includes('what is an SDK') || lowerCommand.includes('Software Development Kit')) {
    responseText = "An SDK (Software Development Kit) is a collection of software development tools in one installable package. It typically includes libraries, documentation, code samples, processes, and guides that developers can use to create applications for a specific platform.";
}

// --- Internet of Things (IoT) ---
else if (lowerCommand.includes('what is IoT') || lowerCommand.includes('Internet of Things') || lowerCommand.includes('define IoT')) {
    responseText = "IoT (Internet of Things) refers to the network of physical objects embedded with sensors, software, and other technologies for the purpose of connecting and exchanging data with other devices and systems over the internet. It enables objects to 'talk' to each other and the cloud.";
}
else if (lowerCommand.includes('what is an IoT device') || lowerCommand.includes('IoT device')) {
    responseText = "An IoT device is any physical object that contains embedded technology allowing it to connect to the internet and interact with other devices. This can range from smart home appliances and wearable tech to industrial sensors.";
}
else if (lowerCommand.includes('what is an IoT gateway') || lowerCommand.includes('IoT gateway')) {
    responseText = "An IoT gateway is a physical device or a software program that serves as a connection point between the cloud and controllers, sensors, and intelligent devices. It acts as a bridge, aggregating, filtering, and transmitting data securely.";
}
else if (lowerCommand.includes('what is edge computing') || lowerCommand.includes('edge computing IoT')) {
    responseText = "Edge computing in IoT involves processing data closer to where it's generated, rather than sending it all to a centralized cloud. This reduces latency, saves bandwidth, and can improve security and real-time decision-making.";
}
else if (lowerCommand.includes('what is cloud computing') || lowerCommand.includes('cloud computing IoT')) {
    responseText = "Cloud computing in IoT refers to using remote servers, storage, databases, networking, software, analytics, and intelligence over the Internet ('the cloud') to process and store data from IoT devices. It provides scalable resources for large-scale IoT deployments.";
}
else if (lowerCommand.includes('what is an IoT platform') || lowerCommand.includes('IoT platform')) {
    responseText = "An IoT platform is a multi-layered technology that connects physical devices to the cloud and other applications. It provides tools for device management, data acquisition, processing, analytics, and application development for IoT solutions.";
}
else if (lowerCommand.includes('what is MQTT') || lowerCommand.includes('MQTT protocol')) {
    responseText = "MQTT (Message Queuing Telemetry Transport) is a lightweight, publish-subscribe network protocol that transports messages between devices. It's designed for constrained devices and low-bandwidth, high-latency, or unreliable networks, making it popular for IoT applications.";
}
else if (lowerCommand.includes('what is CoAP') || lowerCommand.includes('CoAP protocol')) {
    responseText = "CoAP (Constrained Application Protocol) is a specialized web transfer protocol for use with constrained nodes and constrained networks in the Internet of Things. It's designed for use by small, low-power sensors, switches, and other devices.";
}
else if (lowerCommand.includes('what is LoRaWAN') || lowerCommand.includes('LoRaWAN protocol')) {
    responseText = "LoRaWAN is a Low Power Wide Area Network (LPWAN) specification for wireless, battery-operated IoT devices. It defines the communication protocol and system architecture for the network, offering long-range and low-power connectivity.";
}
else if (lowerCommand.includes('what is Zigbee') || lowerCommand.includes('Zigbee protocol')) {
    responseText = "Zigbee is a wireless technology standard that operates on IEEE 802.15.4, designed for low-power, low-data-rate, short-range wireless networking. It's commonly used in smart homes, building automation, and industrial control systems.";
}
else if (lowerCommand.includes('what is Bluetooth Low Energy') || lowerCommand.includes('BLE')) {
    responseText = "Bluetooth Low Energy (BLE) is a wireless personal area network technology designed and marketed by the Bluetooth Special Interest Group. It's optimized for very low power consumption, making it ideal for small, battery-powered IoT devices and wearables.";
}
else if (lowerCommand.includes('what is smart home') || lowerCommand.includes('smart home technology')) {
    responseText = "A smart home is a residence that uses internet-connected devices to enable the remote monitoring and management of appliances and systems, such as lighting, heating, and security. It aims to enhance comfort, convenience, energy efficiency, and security.";
}
else if (lowerCommand.includes('what is industrial IoT') || lowerCommand.includes('IIoT')) {
    responseText = "Industrial IoT (IIoT) refers to the application of IoT technologies in industrial settings, such as manufacturing, energy management, and supply chain logistics. It focuses on improving operational efficiency, predictive maintenance, and overall productivity.";
}
else if (lowerCommand.includes('what is a digital twin') || lowerCommand.includes('digital twin IoT')) {
    responseText = "A digital twin is a virtual representation of a physical object, system, or process. In IoT, digital twins use real-time data from sensors to create an accurate virtual model, enabling monitoring, simulation, and analysis to optimize performance and predict issues.";
}
else if (lowerCommand.includes('what is fog computing') || lowerCommand.includes('fog computing IoT')) {
    responseText = "Fog computing extends cloud computing to the edge of the network, placing data, compute, storage, and application services closer to end-devices and users. It bridges the gap between edge devices and the cloud, offering faster processing for certain IoT applications.";
}
else if (lowerCommand.includes('what is M2M communication') || lowerCommand.includes('Machine to Machine communication')) {
    responseText = "M2M (Machine-to-Machine) communication refers to the direct communication between devices using any communication channel, including wired and wireless. It's a foundational concept for IoT, enabling devices to exchange data and act without human intervention.";
}
else if (lowerCommand.includes('what is LPWAN') || lowerCommand.includes('Low Power Wide Area Network')) {
    responseText = "LPWAN (Low Power Wide Area Network) is a type of wireless telecommunication network designed to allow long-range communications at a low bit rate among things (connected objects) that are battery-powered, for a period of months or years.";
}
else if (lowerCommand.includes('what is NB-IoT') || lowerCommand.includes('Narrowband IoT')) {
    responseText = "NB-IoT (Narrowband IoT) is a low-power wide-area (LPWA) technology standard published by 3GPP for cellular devices and services. It's designed to enable a wide range of new IoT devices and services, offering extended battery life and deep coverage.";
}

// --- Analog and Digital Communication Systems (More Specific) ---
else if (lowerCommand.includes('what is modulation') || lowerCommand.includes('define modulation')) {
    responseText = "Modulation is the process of varying one or more properties of a carrier wave with a modulating signal that contains information. This allows the information to be transmitted over long distances or different mediums.";
}
else if (lowerCommand.includes('what is AM') || lowerCommand.includes('amplitude modulation')) {
    responseText = "AM stands for Amplitude Modulation. It's a modulation technique used in electronic communication, most commonly for transmitting information via a radio carrier wave. In AM, the amplitude (signal strength) of the carrier wave is varied in proportion to that of the message signal.";
}
else if (lowerCommand.includes('what is FM') || lowerCommand.includes('frequency modulation')) {
    responseText = "FM stands for Frequency Modulation. It's a modulation technique in which the frequency of the carrier wave is varied in proportion to that of the message signal, while its amplitude remains constant. FM is less susceptible to noise than AM.";
}
else if (lowerCommand.includes('what is PM') || lowerCommand.includes('Phase Modulation')) {
    responseText = "PM stands for Phase Modulation. It's a modulation technique where the phase of the carrier wave is varied in proportion to the message signal. PM is closely related to FM and is often used in digital communication.";
}
else if (lowerCommand.includes('what is sampling') || lowerCommand.includes('define sampling in communication')) {
    responseText = "In digital communication, sampling is the process of converting a continuous-time analog signal into a discrete-time signal by taking a series of measurements (samples) at regular intervals. The sampling rate must be at least twice the highest frequency in the signal (Nyquist-Shannon theorem).";
}
else if (lowerCommand.includes('what is quantization') || lowerCommand.includes('define quantization')) {
    responseText = "Quantization is the process of converting a continuous range of values (like sampled amplitudes) into a finite number of discrete steps or levels. In digital communication, after sampling, the amplitude of each sample is rounded to the nearest allowed discrete value.";
}
else if (lowerCommand.includes('what is encoding') || lowerCommand.includes('encoding digital communication')) {
    responseText = "In digital communication, encoding is the process of assigning a unique binary code (a sequence of bits) to each quantized sample or symbol. This allows the digital representation of the information to be transmitted.";
}
else if (lowerCommand.includes('what is PCM') || lowerCommand.includes('Pulse Code Modulation')) {
    responseText = "PCM (Pulse Code Modulation) is a method used to digitally represent sampled analog signals. It's the standard form of digital audio in computers and other digital communication systems. PCM involves three main steps: sampling, quantization, and encoding.";
}
else if (lowerCommand.includes('what is ASK') || lowerCommand.includes('Amplitude Shift Keying')) {
    responseText = "ASK (Amplitude Shift Keying) is a digital modulation technique where the amplitude of a carrier wave is varied to represent binary data (0s and 1s). It's simple but susceptible to noise.";
}
else if (lowerCommand.includes('what is FSK') || lowerCommand.includes('Frequency Shift Keying')) {
    responseText = "FSK (Frequency Shift Keying) is a digital modulation technique where the frequency of the carrier wave is shifted between different values to represent binary data. It's more robust to noise than ASK.";
}
else if (lowerCommand.includes('what is PSK') || lowerCommand.includes('Phase Shift Keying')) {
    responseText = "PSK (Phase Shift Keying) is a digital modulation technique where the phase of the carrier wave is varied to represent binary data. Different phase shifts correspond to different symbols (e.g., 0 and 1).";
}
else if (lowerCommand.includes('what is QAM') || lowerCommand.includes('Quadrature Amplitude Modulation')) {
    responseText = "QAM (Quadrature Amplitude Modulation) is a digital modulation scheme that conveys data by changing (modulating) the amplitude of two carrier waves. These two waves are out of phase with each other by 90 degrees (quadrature). It's efficient for high data rates.";
}
else if (lowerCommand.includes('what is multiplexing') || lowerCommand.includes('define multiplexing')) {
    responseText = "Multiplexing is a method by which multiple analog or digital signals are combined into one signal over a shared medium. The aim is to share a costly resource (e.g., a transmission medium) among multiple independent users.";
}
else if (lowerCommand.includes('what is TDM') || lowerCommand.includes('Time Division Multiplexing')) {
    responseText = "TDM (Time Division Multiplexing) is a technique where different signals are transmitted over a single communication channel by dividing the channel's time into slots. Each signal gets a brief turn to use the channel.";
}
else if (lowerCommand.includes('what is FDM') || lowerCommand.includes('Frequency Division Multiplexing')) {
    responseText = "FDM (Frequency Division Multiplexing) is a technique where multiple signals are transmitted simultaneously over a single communication channel by assigning each signal a different frequency band. This is common in radio broadcasting.";
}
else if (lowerCommand.includes('what is WDM') || lowerCommand.includes('Wavelength Division Multiplexing')) {
    responseText = "WDM (Wavelength Division Multiplexing) is a technology that multiplexes multiple optical carrier signals onto a single optical fiber by using different wavelengths (colors) of laser light. It greatly increases the capacity of optical fiber communication systems.";
}
else if (lowerCommand.includes('what is noise in communication') || lowerCommand.includes('communication noise')) {
    responseText = "Noise in communication systems refers to unwanted random disturbances that interfere with the desired signal. It can degrade the quality and intelligibility of transmitted information, making it harder to recover the original message.";
}
else if (lowerCommand.includes('what is an antenna') || lowerCommand.includes('define antenna')) {
    responseText = "An antenna is a transducer designed to transmit or receive electromagnetic waves. It converts electrical signals into electromagnetic waves for transmission, and vice versa for reception. Antennas come in various shapes and sizes depending on their application.";
}
else if (lowerCommand.includes('what is bandwidth') || lowerCommand.includes('define bandwidth')) {
    responseText = "Bandwidth in communication refers to the range of frequencies occupied by a signal, or the capacity of a transmission medium to carry data. A larger bandwidth generally means more data can be transmitted in a given time.";
}
else if (lowerCommand.includes('what is data rate') || lowerCommand.includes('define data rate')) {
    responseText = "Data rate, or bit rate, is the number of bits that are conveyed or processed per unit of time. It's typically measured in bits per second (bps) and represents the speed at which digital information is transferred.";
}
else if (lowerCommand.includes('what is channel capacity') || lowerCommand.includes('channel capacity')) {
    responseText = "Channel capacity is the maximum rate at which information can be transmitted over a communication channel with arbitrarily small error probability. It's often defined by the Shannon-Hartley theorem, which relates it to bandwidth and signal-to-noise ratio.";
}
else if (lowerCommand.includes('what is signal to noise ratio') || lowerCommand.includes('SNR')) {
    responseText = "Signal-to-Noise Ratio (SNR) is a measure used in science and engineering that compares the level of a desired signal to the level of background noise. A higher SNR indicates a clearer signal with less contamination from noise.";
}
else if (lowerCommand.includes('what is a transmission line') || lowerCommand.includes('transmission line')) {
    responseText = "A transmission line is a specialized cable or other structure designed to carry alternating current of radio frequency, as well as data or power, with minimal signal loss. Examples include coaxial cables and waveguides.";
}
else if (lowerCommand.includes('what is impedance matching') || lowerCommand.includes('impedance matching')) {
    responseText = "Impedance matching is the practice of designing the input impedance of an electrical load or the output impedance of its corresponding signal source to maximize power transfer or minimize signal reflection. It's crucial in RF and audio systems.";
}
else if (lowerCommand.includes('what is reflection coefficient') || lowerCommand.includes('reflection coefficient')) {
    responseText = "The reflection coefficient ($\Gamma$) in a transmission line describes the proportion of an electromagnetic wave that is reflected by an impedance discontinuity in the transmission medium. It's a complex number ranging from -1 to 1.";
}
else if (lowerCommand.includes('what is VSWR') || lowerCommand.includes('Voltage Standing Wave Ratio')) {
    responseText = "VSWR (Voltage Standing Wave Ratio) is a measure of impedance mismatch in a transmission line. It's the ratio of the maximum to minimum voltage in a standing wave pattern, indicating how much power is reflected back toward the source.";
}
else if (lowerCommand.includes('what is spread spectrum') || lowerCommand.includes('spread spectrum communication')) {
    responseText = "Spread spectrum is a technique in telecommunication in which a signal is deliberately spread in the frequency domain, resulting in a wider bandwidth than the information content, for the purpose of making it more robust to interference and jamming.";
}
else if (lowerCommand.includes('what is OFDM') || lowerCommand.includes('Orthogonal Frequency Division Multiplexing')) {
    responseText = "OFDM (Orthogonal Frequency Division Multiplexing) is a method of encoding digital data on multiple carrier frequencies. It's a robust modulation technique used in modern high-speed communication systems like Wi-Fi, 4G/5G, and DSL.";
}
else if (lowerCommand.includes('what is MIMO') || lowerCommand.includes('Multiple-Input Multiple-Output')) {
    responseText = "MIMO (Multiple-Input Multiple-Output) is an antenna technology for wireless communications in which multiple antennas are used at both the transmitter and receiver. It enhances data throughput and link range without requiring additional bandwidth or transmit power.";
}
else if (lowerCommand.includes('what is CDMA') || lowerCommand.includes('Code Division Multiple Access')) {
    responseText = "CDMA (Code Division Multiple Access) is a channel access method used by various radio communication technologies. It allows multiple users to share a common channel simultaneously by assigning a unique code to each user, differentiating their signals.";
}

// --- Power Electronics ---
else if (lowerCommand.includes('what is a DC-DC converter') || lowerCommand.includes('DC to DC converter')) {
    responseText = "A DC-DC converter is an electronic circuit that converts a source of direct current (DC) from one voltage level to another. They are essential in portable electronic devices and renewable energy systems.";
}
else if (lowerCommand.includes('what is a buck converter') || lowerCommand.includes('buck converter')) {
    responseText = "A buck converter (step-down converter) is a type of DC-DC converter that converts a higher input DC voltage to a lower output DC voltage. It's widely used in power supplies.";
}
else if (lowerCommand.includes('what is a boost converter') || lowerCommand.includes('boost converter')) {
    responseText = "A boost converter (step-up converter) is a type of DC-DC converter that converts a lower input DC voltage to a higher output DC voltage. It's used in applications requiring a higher voltage than the available source.";
}
else if (lowerCommand.includes('what is a buck-boost converter') || lowerCommand.includes('buck boost converter')) {
    responseText = "A buck-boost converter is a type of DC-DC converter that can produce an output voltage magnitude that is either greater than or less than the input voltage magnitude. The output voltage is of opposite polarity to the input.";
}
else if (lowerCommand.includes('what is an inverter') || lowerCommand.includes('power inverter')) {
    responseText = "An inverter is an electronic device that converts direct current (DC) to alternating current (AC). It's crucial for applications like solar power systems, UPS (Uninterruptible Power Supplies), and variable frequency drives for AC motors.";
}
else if (lowerCommand.includes('what is a switch mode power supply') || lowerCommand.includes('SMPS')) {
    responseText = "An SMPS (Switch-Mode Power Supply) is an electronic power supply that incorporates a switching regulator to convert electrical power efficiently. It rapidly switches a power device between ON and OFF states to regulate the output voltage, offering high efficiency compared to linear power supplies.";
}
else if (lowerCommand.includes('what is power factor') || lowerCommand.includes('power factor electronics')) {
    responseText = "Power factor is a dimensionless quantity in AC circuits, defined as the ratio of real power flowing to the load to the apparent power in the circuit. It indicates how effectively electrical power is being used. A power factor closer to 1 (unity) is desirable.";
}
else if (lowerCommand.includes('what is a transformer') || lowerCommand.includes('transformer electronics')) {
    responseText = "A transformer is a passive electrical device that transfers electrical energy from one electrical circuit to another, or multiple circuits. A varying current in one coil of the transformer produces a varying magnetic flux in the transformer's core, which in turn induces a varying electromotive force across a second coil.";
}
else if (lowerCommand.includes('what is a UPS') || lowerCommand.includes('Uninterruptible Power Supply')) {
    responseText = "A UPS (Uninterruptible Power Supply) is an electrical apparatus that provides emergency power to a load when the input power source or mains power fails. It typically contains a battery and an inverter, ensuring continuous power to critical equipment.";
}

// --- Instrumentation & Measurement ---
else if (lowerCommand.includes('what is an oscilloscope') || lowerCommand.includes('oscilloscope')) {
    responseText = "An oscilloscope is an electronic test instrument that graphically displays varying signal voltages, usually as a two-dimensional plot of one or more signals as a function of time. It's indispensable for observing and analyzing waveforms.";
}
else if (lowerCommand.includes('what is a multimeter') || lowerCommand.includes('multimeter')) {
    responseText = "A multimeter is an electronic measuring instrument that combines several measurement functions in one unit. A typical multimeter can measure voltage, current, and resistance, and some can also measure capacitance, frequency, and temperature.";
}
else if (lowerCommand.includes('what is a function generator') || lowerCommand.includes('function generator')) {
    responseText = "A function generator is a piece of electronic test equipment used to generate various types of electrical waveforms over a wide range of frequencies. Common waveforms include sine, square, triangle, and sawtooth waves.";
}
else if (lowerCommand.includes('what is a logic analyzer') || lowerCommand.includes('logic analyzer')) {
    responseText = "A logic analyzer is an electronic instrument that captures and displays multiple digital signals from a digital system or circuit. Unlike an oscilloscope, which displays analog waveforms, a logic analyzer focuses on the timing and logic states (high/low) of digital signals.";
}
else if (lowerCommand.includes('what is a spectrum analyzer') || lowerCommand.includes('spectrum analyzer')) {
    responseText = "A spectrum analyzer is an electronic instrument that measures the magnitude of an input signal versus frequency within the full frequency range of the instrument. Its primary use is to measure the power of the spectrum of known and unknown signals.";
}
else if (lowerCommand.includes('what is a signal generator') || lowerCommand.includes('signal generator')) {
    responseText = "A signal generator is an electronic device that generates repeating or non-repeating electronic signals (waveforms) in either the analog or digital domain. These are used as stimuli for testing electronic designs, for example, to test the frequency response of an amplifier.";
}
else if (lowerCommand.includes('what is an LCR meter') || lowerCommand.includes('LCR meter')) {
    responseText = "An LCR meter is a piece of electronic test equipment used to measure the inductance (L), capacitance (C), and resistance (R) of an electronic component. It can also measure other derived parameters like Q factor and dissipation factor.";
}
else if (lowerCommand.includes('what is a power supply') || lowerCommand.includes('lab power supply')) {
    responseText = "A power supply is an electrical device that supplies electric power to an electrical load. It's typically used to convert one form of electrical energy to another, regulating the output voltage and current to provide stable power for testing and operating circuits.";
}
else if (lowerCommand.includes('what is calibration') || lowerCommand.includes('instrument calibration')) {
    responseText = "Calibration is the process of configuring an instrument to provide a result for a sample within an acceptable range. It involves comparing the readings of a measurement device against a known standard to ensure accuracy.";
}

// --- Materials and Fabrication ---
else if (lowerCommand.includes('what is a PCB') || lowerCommand.includes('Printed Circuit Board')) {
    responseText = "A PCB (Printed Circuit Board) is a board used to mechanically support and electrically connect electronic components using conductive pathways, tracks, or signal traces etched from copper sheets laminated onto a non-conductive substrate. It's the foundation of almost all electronic devices.";
}
else if (lowerCommand.includes('what is soldering') || lowerCommand.includes('soldering electronics')) {
    responseText = "Soldering is a process in which two or more items are joined together by melting and putting a filler metal (solder) into the joint, with the filler metal having a lower melting point than the adjoining metal. It's a common method for making electrical connections.";
}
else if (lowerCommand.includes('what is surface mount technology') || lowerCommand.includes('SMT')) {
    responseText = "SMT (Surface-Mount Technology) is a method for producing electronic circuits in which the components are mounted directly onto the surface of printed circuit boards (PCBs). This contrasts with through-hole technology, where components have leads that are inserted into holes.";
}
else if (lowerCommand.includes('what is through-hole technology') || lowerCommand.includes('THT')) {
    responseText = "Through-Hole Technology (THT) is a method for constructing electronic circuits by inserting components' leads through holes in printed circuit boards (PCBs) and soldering them on the opposite side. It's a traditional method, often more robust than SMT for certain components.";
}
else if (lowerCommand.includes('what is a semiconductor') || lowerCommand.includes('semiconductor material')) {
    responseText = "A semiconductor is a material that has electrical conductivity between that of a conductor (like copper) and an insulator (like glass). Their conductivity can be controlled, making them fundamental to modern electronics.";
}
else if (lowerCommand.includes('what is silicon') || lowerCommand.includes('silicon electronics')) {
    responseText = "Silicon (Si) is a chemical element that is the most common semiconductor material used in electronic devices. Its unique atomic structure allows it to be easily doped, forming the basis for integrated circuits, transistors, and solar cells.";
}
else if (lowerCommand.includes('what is gallium nitride') || lowerCommand.includes('GaN electronics')) {
    responseText = "Gallium Nitride (GaN) is a wide-bandgap semiconductor material that is becoming increasingly important in power electronics and RF applications. It offers higher efficiency, faster switching speeds, and smaller form factors compared to traditional silicon devices.";
}

// --- Control Systems ---
else if (lowerCommand.includes('what is a control system') || lowerCommand.includes('control system')) {
    responseText = "A control system is a device or set of devices that manages, commands, directs, or regulates the behavior of other devices or systems. It's designed to achieve a desired output by controlling various inputs.";
}
else if (lowerCommand.includes('what is open-loop control') || lowerCommand.includes('open loop control')) {
    responseText = "An open-loop control system is a type of control system where the control action is independent of the output. The system does not use feedback to determine if the desired output has been achieved, making it simpler but less accurate.";
}
else if (lowerCommand.includes('what is closed-loop control') || lowerCommand.includes('closed loop control') || lowerCommand.includes('feedback control')) {
    responseText = "A closed-loop control system, or feedback control system, is a type of control system where the control action is dependent on the output. It uses feedback from the output to adjust its control action, aiming to achieve and maintain a desired setpoint.";
}
else if (lowerCommand.includes('what is PID control') || lowerCommand.includes('PID controller')) {
    responseText = "PID (Proportional-Integral-Derivative) control is a widely used feedback control loop mechanism in industrial control systems and other applications requiring continuously modulated control. It continuously calculates an error value and applies a correction based on proportional, integral, and derivative terms.";
}
else if (lowerCommand.includes('what is a setpoint') || lowerCommand.includes('setpoint control')) {
    responseText = "In a control system, the setpoint is the desired or target value for the controlled variable. The controller's goal is to manipulate inputs to bring the system's actual output as close as possible to the setpoint.";
}
else if (lowerCommand.includes('what is stability in control systems') || lowerCommand.includes('control system stability')) {
    responseText = "Stability in control systems refers to the ability of a system to return to its equilibrium state or desired operating point after being disturbed. An unstable system will exhibit unbounded oscillations or diverge from its operating point.";
}

// --- Programming Languages and Platforms ---
else if (lowerCommand.includes('what is c pro') || lowerCommand.includes('what is c programming') || lowerCommand.includes('c programming')) {
    responseText = "C programming (often referred to as 'C Pro' in a general sense for professional application) is a powerful, general-purpose programming language widely used for system programming, embedded systems, and applications where performance is critical. It's a foundational language for many other languages.";
}
else if (lowerCommand.includes('what is matlab') || lowerCommand.includes('matlab')) {
    responseText = "MATLAB (Matrix Laboratory) is a proprietary multi-paradigm programming language and numerical computing environment developed by MathWorks. It's primarily used for numerical computation, visualization, and programming, especially in engineering and scientific fields.";
}
else if (lowerCommand.includes('what is arduino language') || lowerCommand.includes('arduino programming language')) {
    responseText = "The Arduino programming language is a simplified version of C/C++. It consists of two main functions: 'setup()' for initialization and 'loop()' for the main program logic, and uses a set of specific functions and libraries designed to easily interact with the Arduino hardware.";
}
else if (lowerCommand.includes('what is python for electronics') || lowerCommand.includes('python electronics')) {
    responseText = "Python is a high-level, interpreted programming language widely used in electronics for data analysis, automation (e.g., controlling test equipment), scripting for Raspberry Pi and other SBCs, and developing user interfaces for embedded systems. Its simplicity and extensive libraries make it very versatile.";
}
else if (lowerCommand.includes('what is assembly language') || lowerCommand.includes('assembly language electronics')) {
    responseText = "Assembly language is a low-level programming language that is very close to machine code. Each instruction in assembly language typically corresponds to a single machine instruction. It's used for highly optimized code in embedded systems where direct hardware control and performance are critical.";
}


// --- Internet of Things (IoT) ---
else if (lowerCommand.includes('what is IoT') || lowerCommand.includes('Internet of Things') || lowerCommand.includes('define IoT')) {
    responseText = "IoT (Internet of Things) refers to the network of physical objects embedded with sensors, software, and other technologies for the purpose of connecting and exchanging data with other devices and systems over the internet. It enables objects to 'talk' to each other and the cloud.";
}

else if (lowerCommand.includes('what is an IoT device') || lowerCommand.includes('IoT device')) {
    responseText = "An IoT device is any physical object that contains embedded technology allowing it to connect to the internet and interact with other devices. This can range from smart home appliances and wearable tech to industrial sensors.";
}

else if (lowerCommand.includes('what is an IoT gateway') || lowerCommand.includes('IoT gateway')) {
    responseText = "An IoT gateway is a physical device or a software program that serves as a connection point between the cloud and controllers, sensors, and intelligent devices. It acts as a bridge, aggregating, filtering, and transmitting data securely.";
}
else if (lowerCommand.includes('what is edge computing') || lowerCommand.includes('edge computing IoT')) {
    responseText = "Edge computing in IoT involves processing data closer to where it's generated, rather than sending it all to a centralized cloud. This reduces latency, saves bandwidth, and can improve security and real-time decision-making.";
}
else if (lowerCommand.includes('what is cloud computing') || lowerCommand.includes('cloud computing IoT')) {
    responseText = "Cloud computing in IoT refers to using remote servers, storage, databases, networking, software, analytics, and intelligence over the Internet ('the cloud') to process and store data from IoT devices. It provides scalable resources for large-scale IoT deployments.";
}
else if (lowerCommand.includes('what is an IoT platform') || lowerCommand.includes('IoT platform')) {
    responseText = "An IoT platform is a multi-layered technology that connects physical devices to the cloud and other applications. It provides tools for device management, data acquisition, processing, analytics, and application development for IoT solutions.";
}
else if (lowerCommand.includes('what is MQTT') || lowerCommand.includes('MQTT protocol')) {
    responseText = "MQTT (Message Queuing Telemetry Transport) is a lightweight, publish-subscribe network protocol that transports messages between devices. It's designed for constrained devices and low-bandwidth, high-latency, or unreliable networks, making it popular for IoT applications.";
}
else if (lowerCommand.includes('what is CoAP') || lowerCommand.includes('CoAP protocol')) {
    responseText = "CoAP (Constrained Application Protocol) is a specialized web transfer protocol for use with constrained nodes and constrained networks in the Internet of Things. It's designed for use by small, low-power sensors, switches, and other devices.";
}
else if (lowerCommand.includes('what is LoRaWAN') || lowerCommand.includes('LoRaWAN protocol')) {
    responseText = "LoRaWAN is a Low Power Wide Area Network (LPWAN) specification for wireless, battery-operated IoT devices. It defines the communication protocol and system architecture for the network, offering long-range and low-power connectivity.";
}
else if (lowerCommand.includes('what is Zigbee') || lowerCommand.includes('Zigbee protocol')) {
    responseText = "Zigbee is a wireless technology standard that operates on IEEE 802.15.4, designed for low-power, low-data-rate, short-range wireless networking. It's commonly used in smart homes, building automation, and industrial control systems.";
}
else if (lowerCommand.includes('what is smart home') || lowerCommand.includes('smart home technology')) {
    responseText = "A smart home is a residence that uses internet-connected devices to enable the remote monitoring and management of appliances and systems, such as lighting, heating, and security. It aims to enhance comfort, convenience, energy efficiency, and security.";
}
else if (lowerCommand.includes('what is industrial IoT') || lowerCommand.includes('IIoT')) {
    responseText = "Industrial IoT (IIoT) refers to the application of IoT technologies in industrial settings, such as manufacturing, energy management, and supply chain logistics. It focuses on improving operational efficiency, predictive maintenance, and overall productivity.";
}
else if (lowerCommand.includes('what is a digital twin') || lowerCommand.includes('digital twin IoT')) {
    responseText = "A digital twin is a virtual representation of a physical object, system, or process. In IoT, digital twins use real-time data from sensors to create an accurate virtual model, enabling monitoring, simulation, and analysis to optimize performance and predict issues.";
}
// Add more conditions here for electronics and its components and definitions

else if (lowerCommand.includes('what is a resistor') || lowerCommand.includes('resistor')) {
    responseText = "A resistor is a passive two-terminal electrical component that implements electrical resistance as a circuit element. In electronic circuits, resistors are used to reduce current flow, adjust signal levels, to divide voltages, bias active elements, and terminate transmission lines, among other uses.";
}
else if (lowerCommand.includes('what is a capacitor') || lowerCommand.includes('capacitor')) {
    responseText = "A capacitor is a passive two-terminal electrical component that stores electrical energy in an electric field. The effect of a capacitor is known as capacitance. While some capacitance exists between any two electrical conductors in proximity in a circuit, a capacitor is a component designed to add capacitance to a circuit.";
}
else if (lowerCommand.includes('what is an inductor') || lowerCommand.includes('inductor')) {
    responseText = "An inductor, also called a choke, is a passive two-terminal electrical component that stores energy in a magnetic field when electric current flows through it. An inductor typically consists of a conductor such as a wire, usually wound into a coil.";
}
else if (lowerCommand.includes('what is a diode') || lowerCommand.includes('diode')) {
    responseText = "A diode is a two-terminal electronic component that conducts current primarily in one direction; it has low (ideally zero) resistance in one direction, and high (ideally infinite) resistance in the other. It's often used for rectification, converting AC to DC.";
}
else if (lowerCommand.includes('what is a transistor') || lowerCommand.includes('transistor')) {
    responseText = "A transistor is a semiconductor device used to amplify or switch electronic signals and electrical power. It is one of the basic building blocks of modern electronics and is essential in digital circuits like microprocessors, and analog circuits like audio amplifiers.";
}
else if (lowerCommand.includes('what is an LED') || lowerCommand.includes('LED')) {
    responseText = "An LED (Light Emitting Diode) is a semiconductor light source that emits light when current flows through it. Electrons in the semiconductor recombine with electron holes, releasing energy in the form of photons. LEDs are very energy-efficient and have a long lifespan.";
}
else if (lowerCommand.includes('what is a breadboard') || lowerCommand.includes('breadboard')) {
    responseText = "A breadboard is a solderless construction base used for prototyping of electronics. It allows you to quickly build temporary circuits and experiment with different component arrangements without having to solder anything.";
}
else if (lowerCommand.includes('what is Ohm\'s law') || lowerCommand.includes('ohms law') || lowerCommand.includes('define ohms law')) {
    responseText = "Ohm's Law states that the current through a conductor between two points is directly proportional to the voltage across the two points. Mathematically, it's expressed as V = I * R, where V is voltage, I is current, and R is resistance.";
}
else if (lowerCommand.includes('what is current') || lowerCommand.includes('define current')) {
    responseText = "Electric current is the rate of flow of electric charge past a point or region. A common analogy is the flow of water in a pipe, where current is the amount of water flowing per unit time.";
}
else if (lowerCommand.includes('what is voltage') || lowerCommand.includes('define voltage')) {
    responseText = "Voltage, also known as electric potential difference, is the difference in electric potential energy between two points per unit electric charge. It represents the 'push' or 'force' that drives electric current.";
}
else if (lowerCommand.includes('what is resistance') || lowerCommand.includes('define resistance')) {
    responseText = "Electrical resistance is a measure of the opposition to the flow of electric current in an electrical circuit. It's measured in ohms (Ω). Materials with high resistance are insulators, and those with low resistance are conductors.";
}
else if (lowerCommand.includes('what is an integrated circuit') || lowerCommand.includes('integrated circuit') || lowerCommand.includes('what is an IC') || lowerCommand.includes('IC')) {
    responseText = "An Integrated Circuit (IC), sometimes called a microchip, is a set of electronic circuits on one small flat piece (or 'chip') of semiconductor material, usually silicon. ICs are used in virtually all electronic equipment today.";
}
else if (lowerCommand.includes('what is a sensor') || lowerCommand.includes('define sensor')) {
    responseText = "A sensor is a device, module, machine, or subsystem whose purpose is to detect events or changes in its environment and send the information to other electronics, frequently a computer processor. It's a key component in gathering data from the physical world.";
}
else if (lowerCommand.includes('what is a microcontroller') || lowerCommand.includes('microcontroller')) {
    responseText = "A microcontroller is a small computer on a single metal-oxide-semiconductor (MOS) integrated circuit chip. It contains one or more CPUs along with memory and programmable input/output peripherals. Microcontrollers are used in automatically controlled products and devices, such as automobile engine control systems, implantable medical devices, remote controls, office machines, appliances, power tools, and toys.";
}
else if (lowerCommand.includes('what is a schematic') || lowerCommand.includes('schematic diagram')) {
    responseText = "A schematic diagram is a representation of the elements of a system using abstract, graphic symbols rather than realistic pictures. A schematic diagram of an electronic circuit shows the components of the circuit as simplified shapes, and the power and signal connections between them.";
}
else if (lowerCommand.includes('what is current flow direction') || lowerCommand.includes('conventional current')) {
    responseText = "Conventional current is the concept that electric current flows from the positive terminal to the negative terminal, even though electrons (which carry the charge) actually flow in the opposite direction. It's a historical convention still widely used in circuit analysis.";
}
else if (lowerCommand.includes('what is a series circuit') || lowerCommand.includes('series circuit')) {
    responseText = "In a series circuit, components are connected end-to-end, forming a single path for the current to flow. The current is the same through each component, but the voltage drops across each component add up to the total voltage.";
}
else if (lowerCommand.includes('what is a parallel circuit') || lowerCommand.includes('parallel circuit')) {
    responseText = "In a parallel circuit, components are connected across the same two points, creating multiple paths for the current. The voltage across each component is the same, but the total current is the sum of the currents through each path.";
}
// --- Digital Electronics ---
else if (lowerCommand.includes('what is a logic gate') || lowerCommand.includes('logic gate')) {
    responseText = "A logic gate is an elementary building block of a digital circuit. Most logic gates have two inputs and one output. At any given moment, every terminal is in one of the two binary conditions, low (0) or high (1).";
}
else if (lowerCommand.includes('what is an AND gate') || lowerCommand.includes('AND gate')) {
    responseText = "An AND gate is a digital logic gate that implements logical conjunction. It produces a high output (1) only if all its inputs are high (1). Otherwise, the output is low (0).";
}
else if (lowerCommand.includes('what is an OR gate') || lowerCommand.includes('OR gate')) {
    responseText = "An OR gate is a digital logic gate that implements logical disjunction. It produces a high output (1) if any of its inputs are high (1). The output is low (0) only if all inputs are low (0).";
}
else if (lowerCommand.includes('what is a NOT gate') || lowerCommand.includes('NOT gate') || lowerCommand.includes('inverter')) {
    responseText = "A NOT gate, also known as an inverter, is a digital logic gate with one input and one output. It performs logical negation, producing a high output (1) if the input is low (0), and a low output (0) if the input is high (1).";
}
else if (lowerCommand.includes('what is an XOR gate') || lowerCommand.includes('XOR gate')) {
    responseText = "An XOR (Exclusive-OR) gate is a digital logic gate that produces a high output (1) if an odd number of its inputs are high (1). If both inputs are the same (both 0 or both 1), the output is low (0).";
}
else if (lowerCommand.includes('what is a flip-flop') || lowerCommand.includes('flip flop')) {
    responseText = "A flip-flop is a basic storage element in sequential logic circuits, capable of storing one bit of information. It has two stable states and is used as a fundamental building block of digital memory and sequential logic.";
}
else if (lowerCommand.includes('what is combinational logic') || lowerCommand.includes('combinational logic')) {
    responseText = "Combinational logic is a type of digital logic circuit whose output is purely a function of the present inputs. It does not contain memory elements and its output changes immediately when inputs change.";
}
else if (lowerCommand.includes('what is sequential logic') || lowerCommand.includes('sequential logic')) {
    responseText = "Sequential logic is a type of digital logic circuit whose output depends not only on the present inputs but also on the sequence of past inputs, due to the presence of memory elements (like flip-flops).";
}
else if (lowerCommand.includes('what is a multiplexer') || lowerCommand.includes('mux')) {
    responseText = "A multiplexer (MUX) is a device that selects one of several analog or digital input signals and forwards the selected input into a single output line. It's essentially a multi-input, single-output switch.";
}
else if (lowerCommand.includes('what is a demultiplexer') || lowerCommand.includes('demux')) {
    responseText = "A demultiplexer (DEMUX) is a device that takes a single input signal and selects one of many data-output-lines, which is connected to the single input. It's the inverse of a multiplexer, acting as a single-input, multi-output switch.";
}
else if (lowerCommand.includes('what is an encoder') || lowerCommand.includes('encoder digital')) {
    responseText = "An encoder is a combinational logic circuit that converts a non-binary input code to a binary output code. For example, it might convert a decimal digit input to a binary-coded decimal (BCD) output.";
}
else if (lowerCommand.includes('what is a decoder') || lowerCommand.includes('decoder digital')) {
    responseText = "A decoder is a combinational logic circuit that converts n input lines into $2^n$ output lines. Only one output line is active for a given input combination. It's often used to convert binary codes into human-readable outputs.";
}
else if (lowerCommand.includes('what is a counter') || lowerCommand.includes('digital counter')) {
    responseText = "A digital counter is a sequential logic circuit that counts specific events or pulses applied to its input. It can be implemented using flip-flops and can count up, down, or in various sequences.";
}
else if (lowerCommand.includes('what is a register') || lowerCommand.includes('digital register')) {
    responseText = "A register is a small amount of fast storage available to the CPU within a microcontroller or processor. It holds data that the CPU is currently working on, significantly speeding up data access.";
}
else if (lowerCommand.includes('what is ADC') || lowerCommand.includes('Analog to Digital Converter')) {
    responseText = "An Analog-to-Digital Converter (ADC) is an electronic circuit that converts a continuous analog signal (like temperature or sound) into a discrete digital signal. This allows digital systems to process real-world analog data.";
}
else if (lowerCommand.includes('what is DAC') || lowerCommand.includes('Digital to Analog Converter')) {
    responseText = "A Digital-to-Analog Converter (DAC) is an electronic circuit that converts a digital signal (a sequence of binary numbers) into an analog signal (a continuous voltage or current). It's the opposite of an ADC.";
}
else if (lowerCommand.includes('what is a buffer') || lowerCommand.includes('digital buffer')) {
    responseText = "In digital electronics, a buffer is a logic gate that simply passes its input to its output without changing its logical state. It's used primarily to provide current amplification (buffering) to drive multiple loads or to isolate circuits.";
}
else if (lowerCommand.includes('what is CMOS') || lowerCommand.includes('CMOS logic')) {
    responseText = "CMOS (Complementary Metal-Oxide-Semiconductor) is a technology for constructing integrated circuits. It uses complementary and symmetrical pairs of p-type and n-type MOSFETs for logic functions, known for low power consumption.";
}
else if (lowerCommand.includes('what is TTL') || lowerCommand.includes('TTL logic')) {
    responseText = "TTL (Transistor-Transistor Logic) is a class of digital logic circuits constructed from bipolar junction transistors. It was widely used for digital ICs, known for its speed, but typically consumes more power than CMOS.";
}
else if (lowerCommand.includes('what is tristate logic') || lowerCommand.includes('tri-state buffer')) {
    responseText = "Tri-state logic refers to a digital output that can be in one of three states: high (1), low (0), or high-impedance (Z). The high-impedance state effectively disconnects the output, allowing multiple devices to share a bus.";
}
else if (lowerCommand.includes('what is FPGA') || lowerCommand.includes('Field-Programmable Gate Array')) {
    responseText = "An FPGA (Field-Programmable Gate Array) is an integrated circuit designed to be configured by a customer or a designer after manufacturing. FPGAs are highly flexible and can implement any digital circuit, making them suitable for rapid prototyping and custom hardware acceleration.";
}
else if (lowerCommand.includes('what is ASIC') || lowerCommand.includes('Application-Specific Integrated Circuit')) {
    responseText = "An ASIC (Application-Specific Integrated Circuit) is an integrated circuit customized for a particular use, rather than general-purpose use. ASICs are designed for specific tasks, leading to higher performance and lower power consumption for that task, but involve high initial design costs.";
}
else if (lowerCommand.includes('what is HDL') || lowerCommand.includes('Hardware Description Language')) {
    responseText = "HDL (Hardware Description Language) is a specialized computer language used to describe the structure, design, and operation of electronic circuits. VHDL and Verilog are common HDLs used for designing digital systems, particularly FPGAs and ASICs.";
}
else if (lowerCommand.includes('what is a state machine') || lowerCommand.includes('finite state machine')) {
    responseText = "A state machine (or finite state machine, FSM) is a mathematical model of computation used to design sequential logic circuits. It consists of a finite number of states, transitions between those states, and actions that can be performed upon entering a state or taking a transition.";
}
else if (lowerCommand.includes('what is DRAM') || lowerCommand.includes('Dynamic Random Access Memory')) {
    responseText = "DRAM (Dynamic Random Access Memory) is a type of random-access memory that stores each bit of data in a separate capacitor within an integrated circuit. It requires periodic refreshing of its charge to maintain the stored data, hence the term 'dynamic'.";
}
else if (lowerCommand.includes('what is SRAM') || lowerCommand.includes('Static Random Access Memory')) {
    responseText = "SRAM (Static Random Access Memory) is a type of random-access memory that uses latching circuitry (flip-flops) to store each bit. Unlike DRAM, it does not need to be refreshed periodically, making it faster but more expensive and less dense.";
}
else if (lowerCommand.includes('what is ROM') || lowerCommand.includes('Read Only Memory')) {
    responseText = "ROM (Read-Only Memory) is a type of non-volatile memory used in computers and other electronic devices. Data stored in ROM cannot be electronically modified after the manufacturing of the memory device, or requires significant effort to do so.";
}
else if (lowerCommand.includes('what is flash memory') || lowerCommand.includes('flash storage')) {
    responseText = "Flash memory is a non-volatile computer memory that can be electrically erased and reprogrammed. It is a type of EEPROM and is widely used in USB flash drives, solid-state drives (SSDs), digital cameras, and mobile phones for data storage.";
}
else if (lowerCommand.includes('what is a shift register') || lowerCommand.includes('shift register')) {
    responseText = "A shift register is a digital circuit that can store and move data by shifting bits sequentially. It's often used for serial-to-parallel conversion, parallel-to-serial conversion, or as a delay element.";
}
else if (lowerCommand.includes('what is a NAND gate') || lowerCommand.includes('NAND gate')) {
    responseText = "A NAND gate is a digital logic gate that produces a low output (0) only if all its inputs are high (1). If any input is low (0), the output is high (1). It's considered a universal gate because any other logic gate can be implemented using only NAND gates.";
}
else if (lowerCommand.includes('what is a NOR gate') || lowerCommand.includes('NOR gate')) {
    responseText = "A NOR gate is a digital logic gate that produces a high output (1) only if all its inputs are low (0). If any input is high (1), the output is low (0). It's also a universal gate.";
}
else if (lowerCommand.includes('what is an XNOR gate') || lowerCommand.includes('XNOR gate')) {
    responseText = "An XNOR (Exclusive-NOR) gate is a digital logic gate that produces a high output (1) if both of its inputs are the same (both 0 or both 1). If the inputs are different, the output is low (0). It's the complement of an XOR gate.";
}
else if (lowerCommand.includes('what is a D flip-flop') || lowerCommand.includes('D flip flop')) {
    responseText = "A D (Data) flip-flop is a basic storage element that stores the value present on its data input (D) when the clock signal transitions. It's used for storing a single bit of data and is fundamental in registers and memory.";
}
else if (lowerCommand.includes('what is a JK flip-flop') || lowerCommand.includes('JK flip flop')) {
    responseText = "A JK flip-flop is a versatile type of flip-flop with two inputs, J (set) and K (reset), which can cause the output to toggle, set, or reset depending on the input combination and clock signal. It can behave as a SR flip-flop or a T flip-flop.";
}
else if (lowerCommand.includes('what is a counter type') || lowerCommand.includes('ripple counter')) {
    responseText = "A ripple counter (or asynchronous counter) is a sequential logic circuit where the flip-flop output of one stage serves as the clock input for the next stage. The clock signal 'ripples' through the stages, leading to a propagation delay.";
}
else if (lowerCommand.includes('what is a synchronous counter') || lowerCommand.includes('synchronous counter')) {
    responseText = "A synchronous counter is a sequential logic circuit where all flip-flops are clocked simultaneously by a common clock signal. This eliminates the propagation delay issues seen in ripple counters, allowing for higher operating speeds.";
}
else if (lowerCommand.includes('what is EEPROM') || lowerCommand.includes('Electrically Erasable Programmable Read-Only Memory')) {
    responseText = "EEPROM (Electrically Erasable Programmable Read-Only Memory) is a type of non-volatile memory that can be erased and reprogrammed electrically, usually a byte at a time. It's commonly used for storing small amounts of configuration data in microcontrollers and other devices.";
}
else if (lowerCommand.includes('what is a microprocessor') || lowerCommand.includes('microprocessor')) {
    responseText = "A microprocessor (MPU) is a computer processor on a single integrated circuit. It contains the central processing unit (CPU) but typically requires external memory and peripheral components to form a complete system. It's more powerful than a microcontroller for general-purpose computing.";
}

// --- Electronic Circuits and Network Analysis (Advanced) ---
else if (lowerCommand.includes('what are Kirchhoff\'s Laws') || lowerCommand.includes('Kirchhoff\'s Laws') || lowerCommand.includes('KCL') || lowerCommand.includes('KVL')) {
    responseText = "Kirchhoff's Laws are two fundamental laws for circuit analysis. Kirchhoff's Current Law (KCL) states that the algebraic sum of currents entering a node (or a junction) is zero. Kirchhoff's Voltage Law (KVL) states that the algebraic sum of voltages around any closed loop in a circuit is zero.";
}
else if (lowerCommand.includes('what is Thevenin\'s Theorem') || lowerCommand.includes('Thevenin\'s Theorem') || lowerCommand.includes('thevenin')) {
    responseText = "Thevenin's Theorem states that any linear electrical network containing only voltage sources, current sources, and resistors can be replaced by an equivalent circuit consisting of a single voltage source (Vth) in series with a single resistor (Rth).";
}
else if (lowerCommand.includes('what is Norton\'s Theorem') || lowerCommand.includes('Norton\'s Theorem') || lowerCommand.includes('norton')) {
    responseText = "Norton's Theorem states that any linear electrical network can be replaced by an equivalent circuit consisting of a single current source (In) in parallel with a single resistor (Rn).";
}
else if (lowerCommand.includes('what is superposition theorem') || lowerCommand.includes('superposition')) {
    responseText = "The Superposition Theorem states that in any linear circuit with multiple independent sources, the total current or voltage for any element is the algebraic sum of the currents or voltages produced by each source acting alone, with all other independent sources turned off (voltage sources shorted, current sources opened).";
}
else if (lowerCommand.includes('what is maximum power transfer theorem') || lowerCommand.includes('maximum power transfer')) {
    responseText = "The Maximum Power Transfer Theorem states that to obtain maximum external power from a source with a finite internal resistance, the resistance of the load must be equal to the resistance of the source as viewed from its output terminals.";
}
else if (lowerCommand.includes('what is impedance') || lowerCommand.includes('define impedance')) {
    responseText = "Impedance is the measure of the opposition that a circuit presents to a current when a voltage is applied. In AC circuits, impedance is a more general concept than resistance, as it includes both resistance and reactance. It's represented by a complex number.";
}
else if (lowerCommand.includes('what is reactance') || lowerCommand.includes('define reactance')) {
    responseText = "Reactance is the opposition to the change of current or voltage in an electrical circuit due to inductance or capacitance. It is a component of impedance and is frequency-dependent. Inductive reactance ($X_L$) increases with frequency, while capacitive reactance ($X_C$) decreases with frequency.";
}
else if (lowerCommand.includes('what is admittance') || lowerCommand.includes('define admittance')) {
    responseText = "Admittance is a measure of how easily a circuit or device allows current to flow. It is the reciprocal of impedance, and in AC circuits, it's represented by a complex number. Its real part is conductance, and its imaginary part is susceptance.";
}
else if (lowerCommand.includes('what is resonance') || lowerCommand.includes('resonant frequency')) {
    responseText = "Resonance in an electrical circuit occurs when the impedance of the circuit is purely resistive, meaning the inductive and capacitive reactances cancel each other out. This typically happens at a specific resonant frequency, leading to maximum current or voltage response.";
}
else if (lowerCommand.includes('what is a low-pass filter') || lowerCommand.includes('low pass filter')) {
    responseText = "A low-pass filter is an electronic filter that passes signals with a frequency lower than a certain cutoff frequency and attenuates signals with frequencies higher than the cutoff frequency. It smooths out rapidly changing signals.";
}
else if (lowerCommand.includes('what is a high-pass filter') || lowerCommand.includes('high pass filter')) {
    responseText = "A high-pass filter is an electronic filter that passes signals with a frequency higher than a certain cutoff frequency and attenuates signals with frequencies lower than the cutoff frequency. It blocks DC components and low-frequency noise.";
}
else if (lowerCommand.includes('what is a band-pass filter') || lowerCommand.includes('band pass filter')) {
    responseText = "A band-pass filter is an electronic filter that passes signals within a certain frequency range (a 'band') and attenuates signals outside that range. It's used to isolate a specific frequency or range of frequencies.";
}
else if (lowerCommand.includes('what is a band-stop filter') || lowerCommand.includes('band stop filter') || lowerCommand.includes('notch filter')) {
    responseText = "A band-stop filter, also known as a band-rejection filter or notch filter, is an electronic filter that attenuates signals within a certain frequency range and passes signals outside that range. It's often used to remove unwanted specific frequencies, like 60Hz hum.";
}
else if (lowerCommand.includes('what is a transfer function') || lowerCommand.includes('transfer function electronics')) {
    responseText = "In electronics and control theory, a transfer function is a mathematical representation of the relationship between the output and input of a linear, time-invariant system. It's typically expressed in the Laplace domain.";
}
else if (lowerCommand.includes('what is a bode plot') || lowerCommand.includes('bode plot')) {
    responseText = "A Bode plot is a graph of the frequency response of a system. It typically consists of two plots: one for the magnitude (in decibels) and one for the phase shift (in degrees) of the transfer function, plotted against frequency.";
}
else if (lowerCommand.includes('what is the s-plane') || lowerCommand.includes('s plane') || lowerCommand.includes('laplace transform')) {
    responseText = "The s-plane is a complex plane where the horizontal axis represents the real part (sigma) and the vertical axis represents the imaginary part (omega) of the complex variable 's' used in the Laplace transform. It's a fundamental tool for analyzing linear time-invariant systems.";
}
else if (lowerCommand.includes('what is transient response') || lowerCommand.includes('transient response circuit')) {
    responseText = "The transient response of a circuit describes its behavior as it changes from one steady state to another, typically immediately after a switch is opened or closed, or a sudden change in input occurs. It's temporary and eventually settles to a steady state.";
}
else if (lowerCommand.includes('what is steady-state response') || lowerCommand.includes('steady state response circuit')) {
    responseText = "The steady-state response of a circuit is the behavior of the circuit after all transient effects have died out. For DC circuits, this is a constant value; for AC circuits, it's a sinusoidal response at the input frequency.";
}
else if (lowerCommand.includes('what is quality factor') || lowerCommand.includes('Q factor')) {
    responseText = "The Quality Factor (Q factor) is a dimensionless parameter that describes how underdamped an oscillator or resonator is. In resonant circuits, a higher Q factor indicates lower energy loss and a narrower bandwidth.";
}
else if (lowerCommand.includes('what is a filter order') || lowerCommand.includes('filter order')) {
    responseText = "The order of a filter refers to the number of reactive components (capacitors and inductors) in its passive implementation, or the highest power of 's' in the denominator of its transfer function for active filters. Higher order filters generally have steeper roll-offs.";
}
else if (lowerCommand.includes('what is damping factor') || lowerCommand.includes('damping ratio')) {
    responseText = "The damping factor (or damping ratio, $\zeta$) is a dimensionless measure describing how oscillations in a system decay after a disturbance. A critically damped system ($\zeta=1$) returns to equilibrium as quickly as possible without oscillating.";
}
else if (lowerCommand.includes('what is phase margin') || lowerCommand.includes('phase margin')) {
    responseText = "Phase margin is a measure of the stability of a feedback control system. It is the amount of additional phase lag that can be added to the system at the gain crossover frequency before it becomes unstable.";
}
else if (lowerCommand.includes('what is gain margin') || lowerCommand.includes('gain margin')) {
    responseText = "Gain margin is a measure of the stability of a feedback control system. It is the amount of gain (in dB) that can be added to the system at the phase crossover frequency before it becomes unstable.";
}
else if (lowerCommand.includes('what is an equivalent circuit') || lowerCommand.includes('equivalent circuit')) {
    responseText = "An equivalent circuit is a simplified circuit that behaves identically to a more complex circuit, at least with respect to its terminals. Thevenin and Norton equivalent circuits are common examples used to simplify analysis.";
}
else if (lowerCommand.includes('what is mesh analysis') || lowerCommand.includes('mesh analysis')) {
    responseText = "Mesh analysis is a circuit analysis technique used to solve for unknown currents in a circuit. It applies Kirchhoff's Voltage Law (KVL) to each closed loop (mesh) in the circuit, resulting in a set of simultaneous equations.";
}
else if (lowerCommand.includes('what is nodal analysis') || lowerCommand.includes('nodal analysis')) {
    responseText = "Nodal analysis is a circuit analysis technique used to solve for unknown node voltages in a circuit. It applies Kirchhoff's Current Law (KCL) to each non-reference node, resulting in a set of simultaneous equations.";
}
else if (lowerCommand.includes('what are phasors') || lowerCommand.includes('phasor diagram')) {
    responseText = "Phasors are complex numbers that represent sinusoidal waveforms in AC circuit analysis. They simplify the representation and analysis of AC circuits by converting time-domain sine waves into frequency-domain vectors.";
}
else if (lowerCommand.includes('what is complex power') || lowerCommand.includes('complex power')) {
    responseText = "Complex power (S) in an AC circuit is the sum of real power (P, in Watts) and reactive power (Q, in VARs). It's a complex number where the real part is real power and the imaginary part is reactive power. It's used to analyze power flow in AC systems.";
}
else if (lowerCommand.includes('what is power factor correction') || lowerCommand.includes('power factor correction')) {
    responseText = "Power factor correction is the technique of improving the power factor of an AC electrical power system. This is typically achieved by adding capacitors to the circuit to compensate for the reactive power caused by inductive loads, reducing energy waste.";
}
else if (lowerCommand.includes('what is a linear circuit') || lowerCommand.includes('linear circuit')) {
    responseText = "A linear circuit is an electrical circuit whose output is directly proportional to its input. It obeys the principles of superposition and homogeneity (scaling), meaning that its behavior can be described by linear differential equations.";
}
else if (lowerCommand.includes('what is a nonlinear circuit') || lowerCommand.includes('nonlinear circuit')) {
    responseText = "A nonlinear circuit is an electrical circuit that contains at least one nonlinear component (e.g., diodes, transistors in certain operating regions) whose output is not directly proportional to its input. These circuits do not obey superposition and are harder to analyze.";
}

// --- Analog Electronics ---
else if (lowerCommand.includes('what is an operational amplifier') || lowerCommand.includes('op-amp')) {
    responseText = "An operational amplifier (op-amp) is a DC-coupled high-gain electronic voltage amplifier with a differential input and, usually, a single-ended output. It's a versatile building block for many analog circuits, used for amplification, filtering, summing, and more.";
}
else if (lowerCommand.includes('what is negative feedback') || lowerCommand.includes('negative feedback op-amp')) {
    responseText = "Negative feedback is a method of controlling a system by feeding a portion of its output back into its input in an opposing phase. In op-amps, it stabilizes gain, reduces distortion, and improves bandwidth.";
}
else if (lowerCommand.includes('what is positive feedback') || lowerCommand.includes('positive feedback op-amp')) {
    responseText = "Positive feedback is a process in which a portion of the output signal is fed back to the input in phase with the input signal. Unlike negative feedback, it tends to increase gain, making it useful in oscillators and regenerative circuits, but can also lead to instability.";
}
else if (lowerCommand.includes('what is a voltage regulator') || lowerCommand.includes('voltage regulator')) {
    responseText = "A voltage regulator is an electronic circuit that maintains a constant output voltage regardless of changes in the input voltage or load current. They are essential for providing stable power to sensitive electronic components.";
}
else if (lowerCommand.includes('what is a rectifier') || lowerCommand.includes('rectifier circuit')) {
    responseText = "A rectifier is an electrical device that converts alternating current (AC) to direct current (DC). It typically uses diodes to allow current flow in only one direction. Common types include half-wave and full-wave rectifiers.";
}
else if (lowerCommand.includes('what is an oscillator') || lowerCommand.includes('oscillator circuit')) {
    responseText = "An oscillator is an electronic circuit that produces a repetitive, oscillating electronic signal, often a sine wave or a square wave. They are fundamental in clock generation, radio transmitters, and signal generators.";
}
else if (lowerCommand.includes('what is common-emitter configuration') || lowerCommand.includes('common emitter')) {
    responseText = "The common-emitter configuration is a type of BJT amplifier where the emitter terminal is common to both the input and output. It provides both voltage and current gain and is widely used for amplification.";
}
else if (lowerCommand.includes('what is common-collector configuration') || lowerCommand.includes('common collector') || lowerCommand.includes('emitter follower')) {
    responseText = "The common-collector configuration, also known as an emitter follower, is a type of BJT amplifier where the collector terminal is common. It provides high current gain and voltage buffering, useful for impedance matching.";
}
else if (lowerCommand.includes('what is common-base configuration') || lowerCommand.includes('common base')) {
    responseText = "The common-base configuration is a type of BJT amplifier where the base terminal is common. It provides good voltage gain but no current gain, primarily used in high-frequency applications.";
}
else if (lowerCommand.includes('what is an inverter op-amp') || lowerCommand.includes('inverting amplifier')) {
    responseText = "An inverting amplifier is an op-amp configuration where the output signal is out of phase by 180 degrees with respect to the input signal, and its gain is determined by the ratio of two resistors.";
}
else if (lowerCommand.includes('what is a non-inverting amplifier') || lowerCommand.includes('non inverting amplifier')) {
    responseText = "A non-inverting amplifier is an op-amp configuration where the output signal is in phase with the input signal, and its gain is determined by the ratio of two resistors plus one.";
}
else if (lowerCommand.includes('what is a voltage follower') || lowerCommand.includes('unity gain buffer')) {
    responseText = "A voltage follower, or unity gain buffer, is an op-amp configuration that provides a gain of 1. Its primary use is for impedance matching, preventing a source from being loaded by a low-impedance load.";
}
else if (lowerCommand.includes('what is an instrumentation amplifier') || lowerCommand.includes('instrumentation amplifier')) {
    responseText = "An instrumentation amplifier is a type of differential amplifier that is highly precise and stable, commonly used for amplifying very small differential signals in noisy environments. It typically has high input impedance and high common-mode rejection ratio.";
}
else if (lowerCommand.includes('what is a comparator') || lowerCommand.includes('comparator circuit')) {
    responseText = "A comparator is an electronic circuit that compares two input voltages or currents and outputs a digital signal indicating which is larger. It's often implemented using an op-amp in an open-loop configuration.";
}
else if (lowerCommand.includes('what is hysteresis') || lowerCommand.includes('hysteresis electronic')) {
    responseText = "Hysteresis in electronics refers to the dependence of a system's output on its past inputs as well as its present input. In circuits like Schmitt triggers, it prevents rapid, unwanted switching due to noise around the threshold.";
}
else if (lowerCommand.includes('what is a voltage controlled oscillator') || lowerCommand.includes('VCO')) {
    responseText = "A VCO (Voltage Controlled Oscillator) is an electronic oscillator whose oscillation frequency is controlled by a voltage input. The applied input voltage determines the instantaneous oscillation frequency.";
}
else if (lowerCommand.includes('what is a phase-locked loop') || lowerCommand.includes('PLL')) {
    responseText = "A PLL (Phase-Locked Loop) is a control system that generates an output signal whose phase is related to the phase of an input 'reference' signal. It's used for frequency synthesis, demodulation, and clock recovery in communication systems.";
}
else if (lowerCommand.includes('what is total harmonic distortion') || lowerCommand.includes('THD')) {
    responseText = "THD (Total Harmonic Distortion) is a measurement of the harmonic distortion present in a signal. It's defined as the ratio of the sum of the powers of all harmonic components to the power of the fundamental frequency, indicating signal purity.";
}
else if (lowerCommand.includes('what is slew rate') || lowerCommand.includes('op-amp slew rate')) {
    responseText = "Slew rate is the maximum rate of change of output voltage per unit of time, typically measured in volts per microsecond (V/μs). It limits the speed at which an op-amp's output can change, affecting its performance at higher frequencies.";
}
else if (lowerCommand.includes('what is offset voltage') || lowerCommand.includes('op-amp offset voltage')) {
    responseText = "Input offset voltage is the differential DC voltage required between the two input terminals of an op-amp to make the output zero. It's an imperfection that can cause a small DC voltage at the output even with zero input.";
}
else if (lowerCommand.includes('what is a differential amplifier') || lowerCommand.includes('differential amplifier')) {
    responseText = "A differential amplifier is a type of electronic amplifier that amplifies the difference between two input signals while rejecting any common-mode signals. It's a fundamental building block for op-amps and instrumentation amplifiers.";
}
else if (lowerCommand.includes('what is a power amplifier') || lowerCommand.includes('power amplifier')) {
    responseText = "A power amplifier is an electronic amplifier that amplifies low-power electronic audio or radio signals to a level strong enough for driving loudspeakers, radio transmitters, or other output devices. Its main goal is to deliver significant power to a load.";
}
else if (lowerCommand.includes('what is a preamplifier') || lowerCommand.includes('preamp')) {
    responseText = "A preamplifier (preamp) is an electronic amplifier that converts a weak electrical signal into an output signal strong enough to be noise-tolerant and transmitted to a main amplifier or further processing. It's typically used to boost signals from sensors or microphones.";
}
else if (lowerCommand.includes('what is a filter type') || lowerCommand.includes('active filter')) {
    responseText = "An active filter is a type of electronic filter that uses active components like op-amps or transistors in addition to passive components (resistors, capacitors). Active filters can achieve higher gain, steeper roll-offs, and do not require inductors, making them more suitable for low-frequency applications.";
}
else if (lowerCommand.includes('what is a passive filter') || lowerCommand.includes('passive filter')) {
    responseText = "A passive filter is a type of electronic filter that is composed only of passive components such as resistors, capacitors, and inductors. They are generally simpler and less expensive than active filters but offer less flexibility in terms of gain and Q factor.";
}
else if (lowerCommand.includes('what is a Butterworth filter') || lowerCommand.includes('Butterworth filter')) {
    responseText = "A Butterworth filter is a type of signal processing filter designed to have a frequency response that is as flat as possible in the passband. It's known for its maximally flat magnitude response, without ripples in the passband or stopband.";
}
else if (lowerCommand.includes('what is a Chebyshev filter') || lowerCommand.includes('Chebyshev filter')) {
    responseText = "A Chebyshev filter is a type of electronic filter that has a steeper roll-off and more ripple in the passband (Type I) or stopband (Type II) than a Butterworth filter. It achieves a faster transition from passband to stopband at the expense of ripple.";
}

// --- Semiconductor Devices (Detailed) ---
else if (lowerCommand.includes('what is a PN junction') || lowerCommand.includes('PN junction diode')) {
    responseText = "A PN junction is the boundary or interface between two types of semiconductor materials, p-type and n-type, inside a single crystal of semiconductor. It forms the basis of all semiconductor devices like diodes, transistors, and solar cells.";
}
else if (lowerCommand.includes('what is doping') || lowerCommand.includes('semiconductor doping')) {
    responseText = "Doping is the process of intentionally introducing impurities into an intrinsic semiconductor for the purpose of modulating its electrical properties, such as its electron and hole concentrations. This creates p-type or n-type semiconductors.";
}
else if (lowerCommand.includes('what is a Zener diode') || lowerCommand.includes('zener diode')) {
    responseText = "A Zener diode is a special type of diode designed to reliably allow current to flow in the reverse direction when a certain reverse voltage, known as the Zener voltage, is reached. It's primarily used for voltage regulation.";
}
else if (lowerCommand.includes('what is a Schottky diode') || lowerCommand.includes('schottky diode')) {
    responseText = "A Schottky diode is a semiconductor diode with a very low forward voltage drop and a very fast switching action. It's formed by a metal-semiconductor junction, rather than a p-n junction, making it useful in high-speed switching and RF applications.";
}
else if (lowerCommand.includes('what is a BJT') || lowerCommand.includes('Bipolar Junction Transistor')) {
    responseText = "A BJT (Bipolar Junction Transistor) is a type of transistor that uses both electron and hole charge carriers. It's a current-controlled device and comes in NPN and PNP types, used for amplification and switching.";
}
else if (lowerCommand.includes('what is an FET') || lowerCommand.includes('Field-Effect Transistor')) {
    responseText = "An FET (Field-Effect Transistor) is a type of transistor that uses an electric field to control the flow of current. Unlike BJTs, FETs are voltage-controlled devices and have high input impedance, coming in JFET and MOSFET variations.";
}
else if (lowerCommand.includes('what is a MOSFET') || lowerCommand.includes('MOSFET transistor')) {
    responseText = "A MOSFET (Metal-Oxide-Semiconductor Field-Effect Transistor) is the most common type of FET. It's a voltage-controlled device known for high input impedance and is crucial in digital circuits, power electronics, and integrated circuits due to its scalability and low power consumption.";
}
else if (lowerCommand.includes('what is an SCR') || lowerCommand.includes('Silicon Controlled Rectifier')) {
    responseText = "An SCR (Silicon Controlled Rectifier) is a four-layer solid-state device that controls current flow. It acts as a switch, remaining off until a small current is applied to its gate terminal, after which it conducts heavily until the main current is interrupted.";
}
else if (lowerCommand.includes('what is a TRIAC') || lowerCommand.includes('triac')) {
    responseText = "A TRIAC (Triode for Alternating Current) is a three-terminal electronic component that conducts current in either direction when triggered by a gate signal. It's commonly used in AC power control applications like light dimmers and motor speed controls.";
}
else if (lowerCommand.includes('what is a DIAC') || lowerCommand.includes('diac')) {
    responseText = "A DIAC (Diode for Alternating Current) is a two-terminal, three-layer semiconductor device that conducts electrical current only after its breakdown voltage has been reached. It's often used to trigger TRIACs.";
}
else if (lowerCommand.includes('what is an IGBT') || lowerCommand.includes('Insulated Gate Bipolar Transistor')) {
    responseText = "An IGBT (Insulated Gate Bipolar Transistor) is a three-terminal power semiconductor device primarily used as an electronic switch. It combines the high input impedance of a MOSFET with the low on-state voltage drop and high current handling capability of a BJT.";
}
else if (lowerCommand.includes('what is a photodiode') || lowerCommand.includes('photodiode')) {
    responseText = "A photodiode is a semiconductor device that converts light into an electrical current. When light strikes the photodiode, it creates electron-hole pairs, generating a current proportional to the light intensity.";
}
else if (lowerCommand.includes('what is a phototransistor') || lowerCommand.includes('phototransistor')) {
    responseText = "A phototransistor is a light-sensitive transistor, similar to a photodiode but with internal gain. When light strikes its base junction, it generates a much larger output current compared to a photodiode, making it more sensitive to light.";
}
else if (lowerCommand.includes('what is a thermistor') || lowerCommand.includes('thermistor')) {
    responseText = "A thermistor is a type of resistor whose resistance is strongly dependent on temperature. It's widely used as a temperature sensor, with its resistance typically decreasing significantly as temperature increases (NTC thermistor).";
}
else if (lowerCommand.includes('what is an LDR') || lowerCommand.includes('Light Dependent Resistor')) {
    responseText = "An LDR (Light Dependent Resistor), also known as a photoresistor, is a passive component whose resistance decreases with increasing incident light intensity. It's often used in light-sensing applications.";
}
else if (lowerCommand.includes('what is a varactor diode') || lowerCommand.includes('varicap diode')) {
    responseText = "A varactor diode (or varicap diode) is a type of diode whose capacitance varies with the reverse voltage applied across its terminals. This property makes them useful in voltage-controlled oscillators, frequency multipliers, and tunable filters.";
}
else if (lowerCommand.includes('what is an optocoupler') || lowerCommand.includes('optocoupler') || lowerCommand.includes('opt-isolator')) {
    responseText = "An optocoupler (or opto-isolator) is an electronic component that transfers electrical signals between two isolated circuits by using light. It prevents high voltages or rapid voltage transients in one part of a system from affecting the other, providing electrical isolation.";
}
else if (lowerCommand.includes('what is a laser diode') || lowerCommand.includes('laser diode')) {
    responseText = "A laser diode is a semiconductor device that emits coherent light through a process called stimulated emission. It's similar to an LED but produces a highly directional, monochromatic, and coherent light beam, used in fiber optics, barcode scanners, and laser pointers.";
}
else if (lowerCommand.includes('what is an LED type') || lowerCommand.includes('OLED') || lowerCommand.includes('organic light emitting diode')) {
    responseText = "An OLED (Organic Light-Emitting Diode) is a type of LED that uses an organic compound as the electroluminescent material. OLED displays are known for their high contrast, deep blacks, wide viewing angles, and faster response times compared to traditional LCDs.";
}
else if (lowerCommand.includes('what is a unijunction transistor') || lowerCommand.includes('UJT')) {
    responseText = "A UJT (Unijunction Transistor) is a three-terminal semiconductor device that has only one PN junction. It's primarily used as an electronically controlled switch or for triggering other devices like SCRs and TRIACs in timing and oscillator circuits.";
}
else if (lowerCommand.includes('what is a programmable unijunction transistor') || lowerCommand.includes('PUT')) {
    responseText = "A PUT (Programmable Unijunction Transistor) is a type of thyristor that acts like a UJT but its firing voltage can be set by an external voltage divider. It's useful in precision timer circuits and oscillators.";
}
else if (lowerCommand.includes('what is IC packaging') || lowerCommand.includes('integrated circuit packaging')) {
    responseText = "IC packaging refers to the housing or enclosure for an integrated circuit (IC) chip. It protects the chip from physical damage and corrosion, and provides electrical connections for power and signals. Common packages include DIP, SOP, QFN, and BGA.";
}

// --- Sensors & Actuators (Expanded) ---
else if (lowerCommand.includes('what is a temperature sensor') || lowerCommand.includes('temperature sensor')) {
    responseText = "A temperature sensor is a device that measures temperature. Common types include thermistors, RTDs (Resistance Temperature Detectors), thermocouples, and semiconductor-based IC sensors.";
}
else if (lowerCommand.includes('what is an RTD') || lowerCommand.includes('Resistance Temperature Detector')) {
    responseText = "An RTD (Resistance Temperature Detector) is a temperature sensor that changes its resistance with temperature. It's known for high accuracy and stability, often made of platinum, copper, or nickel.";
}
else if (lowerCommand.includes('what is a thermocouple') || lowerCommand.includes('thermocouple')) {
    responseText = "A thermocouple is a temperature sensor consisting of two dissimilar electrical conductors forming electrical junctions at differing temperatures. It produces a temperature-dependent voltage as a result of the Seebeck effect, allowing for temperature measurement over wide ranges.";
}
else if (lowerCommand.includes('what is a pressure sensor') || lowerCommand.includes('pressure sensor')) {
    responseText = "A pressure sensor is a device that measures pressure, typically of gases or liquids. Pressure is an expression of the force required to stop a fluid from expanding, and pressure sensors convert this force into an electrical signal.";
}
else if (lowerCommand.includes('what is an ultrasonic sensor') || lowerCommand.includes('ultrasonic sensor')) {
    responseText = "An ultrasonic sensor measures distance by emitting ultrasonic waves and listening for the echo. By calculating the time taken for the sound to return, it determines the distance to an object. It's common in robotics and object detection.";
}
else if (lowerCommand.includes('what is an infrared sensor') || lowerCommand.includes('IR sensor')) {
    responseText = "An infrared (IR) sensor is an electronic device that measures or detects infrared radiation in its environment. It can be used for motion detection, proximity sensing, object detection, and even thermal imaging.";
}
else if (lowerCommand.includes('what is a motion sensor') || lowerCommand.includes('PIR sensor')) {
    responseText = "A motion sensor, often a PIR (Passive Infrared) sensor, detects movement by measuring changes in infrared radiation levels in its field of view. It's commonly used in security systems and automatic lighting.";
}
else if (lowerCommand.includes('what is a humidity sensor') || lowerCommand.includes('humidity sensor')) {
    responseText = "A humidity sensor (or hygrometer) detects and measures the amount of water vapor in the air. These sensors are crucial for environmental monitoring, HVAC systems, and weather stations.";
}
else if (lowerCommand.includes('what is an accelerometer') || lowerCommand.includes('accelerometer')) {
    responseText = "An accelerometer is a device that measures proper acceleration. This is the acceleration (or rate of change of velocity) of a body in its own rest frame. It's used to detect tilt, vibration, and orientation changes.";
}
else if (lowerCommand.includes('what is a gyroscope') || lowerCommand.includes('gyroscope sensor')) {
    responseText = "A gyroscope is a device that measures or maintains orientation and angular velocity. It detects rotation around an axis and is often paired with accelerometers in IMUs (Inertial Measurement Units) for more complete motion sensing.";
}
else if (lowerCommand.includes('what is a magnetomter') || lowerCommand.includes('magnetometer')) {
    responseText = "A magnetometer is an instrument that measures magnetic field strength or direction. In electronics, they are used in compasses, navigation systems, and metal detectors.";
}
else if (lowerCommand.includes('what is a proximity sensor') || lowerCommand.includes('proximity sensor')) {
    responseText = "A proximity sensor is a non-contact sensor that detects the presence of nearby objects without any physical contact. They work by emitting an electromagnetic field or a beam of radiation and looking for changes in the return signal.";
}
else if (lowerCommand.includes('what is a force sensor') || lowerCommand.includes('force sensor') || lowerCommand.includes('load cell')) {
    responseText = "A force sensor, often called a load cell, is a transducer that converts a force into an electrical signal. The electrical signal output is proportional to the applied force. They are used in scales, robotic grippers, and industrial measurement.";
}
else if (lowerCommand.includes('what is a flex sensor') || lowerCommand.includes('flex sensor')) {
    responseText = "A flex sensor is a sensor that measures the amount of bend or deflection. As the sensor is bent, the resistance across it increases. They are commonly used in robotics, gaming, and virtual reality gloves.";
}
else if (lowerCommand.includes('what is a gas sensor') || lowerCommand.includes('gas sensor')) {
    responseText = "A gas sensor is an electronic device that detects the presence and concentration of different types of gases in an area. They are used to detect combustible, flammable, and toxic gases, as well as oxygen depletion, in various environments.";
}
else if (lowerCommand.includes('what is a pH sensor') || lowerCommand.includes('pH sensor')) {
    responseText = "A pH sensor measures the acidity or alkalinity of a liquid. It typically consists of a glass electrode that generates a voltage proportional to the hydrogen ion concentration in the solution. Important for water quality, chemical processes, and agriculture.";
}
else if (lowerCommand.includes('what is a photoelectric sensor') || lowerCommand.includes('photoelectric sensor')) {
    responseText = "A photoelectric sensor detects the presence or absence of an object by emitting a light beam (usually infrared) and detecting whether the light is returned. They are widely used in automation and industrial applications.";
}
else if (lowerCommand.includes('what is an encoder sensor') || lowerCommand.includes('rotary encoder')) {
    responseText = "An encoder sensor converts linear or rotary motion into digital signals. Rotary encoders, for example, detect angular position or motion and are commonly used for precise control in robotics and industrial machinery.";
}
else if (lowerCommand.includes('what is an IMU') || lowerCommand.includes('Inertial Measurement Unit')) {
    responseText = "An IMU (Inertial Measurement Unit) is an electronic device that measures and reports a body's specific force, angular rate, and sometimes the magnetic field surrounding the body, using a combination of accelerometers, gyroscopes, and often magnetometers.";
}
else if (lowerCommand.includes('what is a motor') || lowerCommand.includes('electric motor')) {
    responseText = "An electric motor is an electrical machine that converts electrical energy into mechanical energy. Most electric motors operate through the interaction between the motor's magnetic field and electric current in a wire winding to generate force in the form of torque.";
}
else if (lowerCommand.includes('what is a servo motor') || lowerCommand.includes('servo motor')) {
    responseText = "A servo motor is a rotary actuator that allows for precise control of angular position, velocity, and acceleration. It consists of a motor, a feedback sensor (often an encoder), and a control circuit. Commonly used in robotics and RC applications.";
}
else if (lowerCommand.includes('what is a stepper motor') || lowerCommand.includes('stepper motor')) {
    responseText = "A stepper motor is a brushless DC electric motor that divides a full rotation into a number of equal steps. It can be commanded to move and hold at any of these steps without a feedback sensor (open-loop control), making it ideal for precise positioning.";
}
else if (lowerCommand.includes('what is an actuator') || lowerCommand.includes('define actuator')) {
    responseText = "An actuator is a component of a machine that is responsible for moving and controlling a mechanism or system. It converts electrical, hydraulic, or pneumatic energy into mechanical motion. Motors, solenoids, and relays are common actuators.";
}
else if (lowerCommand.includes('what is a solenoid') || lowerCommand.includes('solenoid')) {
    responseText = "A solenoid is a type of electromagnet, the purpose of which is to generate a controlled magnetic field. When current passes through its coil, it creates a magnetic field that can be used to pull or push a plunger, converting electrical energy into linear mechanical motion.";
}
else if (lowerCommand.includes('what is a relay') || lowerCommand.includes('relay')) {
    responseText = "A relay is an electrically operated switch. It uses an electromagnet to mechanically operate a switch, either opening or closing a circuit. Relays are used to control a high-power circuit using a low-power signal, or to control multiple circuits with one signal.";
}
else if (lowerCommand.includes('what is a haptic actuator') || lowerCommand.includes('haptic feedback')) {
    responseText = "A haptic actuator is a device that creates a sense of touch by applying forces, vibrations, or motions to the user. It's used in touchscreens, gaming controllers, and virtual reality to provide haptic feedback.";
}
else if (lowerCommand.includes('what is a flow sensor') || lowerCommand.includes('flow sensor')) {
    responseText = "A flow sensor is a device that measures the rate of fluid or gas movement. It's critical in industrial processes, water management, and HVAC systems for monitoring and control.";
}
else if (lowerCommand.includes('what is a level sensor') || lowerCommand.includes('level sensor')) {
    responseText = "A level sensor is a device that detects the level of liquids, solids, or granular materials within a container or in open air. They are used in tanks, bins, and silos to monitor fill levels and prevent overfilling or running dry.";
}
else if (lowerCommand.includes('what is a strain gauge') || lowerCommand.includes('strain gauge')) {
    responseText = "A strain gauge is a sensor whose resistance varies with applied force. It converts force, pressure, tension, and weight into an electrical signal that can be measured. They are fundamental in load cells and structural health monitoring.";
}
else if (lowerCommand.includes('what is a hall effect sensor') || lowerCommand.includes('hall effect sensor')) {
    responseText = "A Hall effect sensor is a transducer that varies its output voltage in response to a magnetic field. It can be used for proximity sensing, positioning, speed detection, and current sensing.";
}
else if (lowerCommand.includes('what is a lidar sensor') || lowerCommand.includes('lidar')) {
    responseText = "Lidar (Light Detection and Ranging) is a remote sensing method that uses pulsed laser light to measure ranges (variable distances) to the Earth. It creates 3D point clouds and is used in autonomous vehicles, robotics, and mapping.";
}
else if (lowerCommand.includes('what is a radar sensor') || lowerCommand.includes('radar')) {
    responseText = "Radar (Radio Detection and Ranging) is a detection system that uses radio waves to determine the range, angle, or velocity of objects. It's used in automotive safety, weather forecasting, and air traffic control.";
}
else if (lowerCommand.includes('what is a MEMS sensor') || lowerCommand.includes('MEMS')) {
    responseText = "MEMS (Micro-Electro-Mechanical Systems) sensors are miniature devices that combine electrical and mechanical components on a microscopic scale. They are widely used in accelerometers, gyroscopes, pressure sensors, and microphones found in smartphones and wearables.";
}

// --- Microcontrollers & Embedded Systems (Expanded) ---
else if (lowerCommand.includes('what is arduino') || lowerCommand.includes('define arduino')) {
    responseText = "Arduino is an open-source electronics platform that makes it easy to create a wide variety of interactive electronic objects and projects. It consists of two main parts: a physical programmable circuit board, known as a microcontroller, and a piece of software, or IDE (Integrated Development Environment), that runs on your computer. You use the IDE to write and upload code to the physical board.";
}
else if (lowerCommand.includes('what are arduino shields') || lowerCommand.includes('arduino shield')) {
    responseText = "Arduino shields are pre-assembled circuit boards that can be easily plugged on top of an Arduino board, extending its capabilities. They provide additional functionality like Ethernet connectivity, motor control, or wireless communication, without requiring complex wiring.";
}
else if (lowerCommand.includes('what is the arduino IDE') || lowerCommand.includes('arduino IDE')) {
    responseText = "The Arduino IDE (Integrated Development Environment) is a cross-platform application written in Java, designed to write, compile, and upload code to Arduino compatible boards. It provides a simple environment for programming microcontrollers.";
}
else if (lowerCommand.includes('what is GPIO') || lowerCommand.includes('General Purpose Input/Output')) {
    responseText = "GPIO stands for General Purpose Input/Output. These are generic pins on a microcontroller that can be configured by software to either input or output digital signals (high or low voltage). They are fundamental for interacting with sensors, LEDs, buttons, and other external components.";
}
else if (lowerCommand.includes('what is UART') || lowerCommand.includes('Universal Asynchronous Receiver/Transmitter')) {
    responseText = "UART (Universal Asynchronous Receiver/Transmitter) is a hardware communication protocol that transmits and receives serial data asynchronously. It's a common method for communication between microcontrollers and other devices like computers (via USB-to-serial converters).";
}
else if (lowerCommand.includes('what is SPI') || lowerCommand.includes('Serial Peripheral Interface')) {
    responseText = "SPI (Serial Peripheral Interface) is a synchronous serial communication interface specification used for short-distance communication, primarily in embedded systems. It operates in full duplex mode and typically uses four wires: MOSI, MISO, SCK, and SS.";
}
else if (lowerCommand.includes('what is I2C') || lowerCommand.includes('IIC') || lowerCommand.includes('Inter-Integrated Circuit')) {
    responseText = "I2C (Inter-Integrated Circuit), also known as IIC, is a multi-master, multi-slave serial communication bus used for connecting low-speed peripheral ICs to processors and microcontrollers. It uses only two bidirectional lines, SDA (data) and SCL (clock), making it very efficient.";
}
else if (lowerCommand.includes('what are interrupts') || lowerCommand.includes('microcontroller interrupts')) {
    responseText = "Interrupts are signals from hardware or software that indicate an event needs immediate attention from the CPU. When an interrupt occurs, the CPU temporarily suspends its current task, executes a specific 'Interrupt Service Routine' (ISR), and then resumes its previous task.";
}
else if (lowerCommand.includes('what is PWM') || lowerCommand.includes('Pulse Width Modulation')) {
    responseText = "PWM (Pulse Width Modulation) is a technique used to control the average power delivered to an electrical device by varying the width of electrical pulses. By changing the duty cycle (on-time vs. off-time), you can effectively control brightness of LEDs, speed of motors, etc.";
}
else if (lowerCommand.includes('what is a watchdog timer') || lowerCommand.includes('watchdog timer')) {
    responseText = "A watchdog timer is an electronic timer that is used to detect and recover from malfunctions in embedded systems. If the main program fails to reset the watchdog timer periodically (e.g., due to a software error), the timer will time out and reset the system.";
}
else if (lowerCommand.includes('what is a bootloader') || lowerCommand.includes('bootloader')) {
    responseText = "A bootloader is a small piece of code that runs when a microcontroller or computer first powers on or resets. Its primary function is to initialize the system and then load a larger program (like your Arduino sketch) into memory and start its execution.";
}
else if (lowerCommand.includes('what is firmware') || lowerCommand.includes('define firmware')) {
    responseText = "Firmware is a specific class of computer software that provides low-level control for a device's specific hardware. It's typically stored in non-volatile memory (like Flash ROM) and is responsible for basic functions, allowing higher-level software to interact with the hardware.";
}
else if (lowerCommand.includes('what is an RTOS') || lowerCommand.includes('Real-Time Operating System')) {
    responseText = "An RTOS (Real-Time Operating System) is an operating system intended for real-time applications, meaning it guarantees that certain operations will be completed within specific time constraints. RTOSes are crucial in embedded systems where timely responses are critical, such as in industrial control or medical devices.";
}
else if (lowerCommand.includes('what is memory in a microcontroller') || lowerCommand.includes('microcontroller memory')) {
    responseText = "Microcontrollers typically have different types of memory: Flash memory (for storing the program code), SRAM (Static RAM, for temporary data and variables), and EEPROM (Electrically Erasable Programmable Read-Only Memory, for small amounts of persistent data).";
}
else if (lowerCommand.includes('what is an instruction set') || lowerCommand.includes('instruction set architecture')) {
    responseText = "An instruction set (or Instruction Set Architecture - ISA) is the set of all instructions that a central processing unit (CPU) can understand and execute. It defines the commands that a processor knows, including operations, data types, and memory addressing modes.";
}
else if (lowerCommand.includes('what is raspberry pi') || lowerCommand.includes('raspberry pi')) {
    responseText = "The Raspberry Pi is a series of small single-board computers (SBCs) developed in the United Kingdom by the Raspberry Pi Foundation to promote the teaching of basic computer science in schools and developing countries. Unlike Arduino, it's a full-fledged computer capable of running an operating system.";
}
else if (lowerCommand.includes('arduino vs raspberry pi') || lowerCommand.includes('difference between arduino and raspberry pi')) {
    responseText = "Arduino is a microcontroller board, ideal for controlling hardware and real-time operations, programmed in a simplified C/C++. Raspberry Pi is a single-board computer, capable of running an OS like Linux, better for complex computing tasks, networking, and software applications.";
}
else if (lowerCommand.includes('what is an embedded system') || lowerCommand.includes('embedded system')) {
    responseText = "An embedded system is a computer system—a combination of a computer processor, computer memory, and input/output peripheral devices—that has a dedicated function within a larger mechanical or electrical system. It's designed to perform a specific task, often with real-time computing constraints.";
}
else if (lowerCommand.includes('what is cross-compilation') || lowerCommand.includes('cross compilation')) {
    responseText = "Cross-compilation is the process of compiling code on one computer architecture (the host) for execution on a different computer architecture (the target). This is common in embedded systems development, where code for a microcontroller is compiled on a desktop PC.";
}
else if (lowerCommand.includes('what is an IDE') || lowerCommand.includes('Integrated Development Environment')) {
    responseText = "An IDE (Integrated Development Environment) is a software application that provides comprehensive facilities to computer programmers for software development. It typically consists of a source code editor, build automation tools, and a debugger.";
}
else if (lowerCommand.includes('what is a debugger') || lowerCommand.includes('debugger electronics')) {
    responseText = "A debugger is a computer program that is used to test and debug other programs (the 'target' program). It allows a programmer to step through code, inspect variables, and set breakpoints to find and fix errors.";
}
else if (lowerCommand.includes('what is an SDK') || lowerCommand.includes('Software Development Kit')) {
    responseText = "An SDK (Software Development Kit) is a collection of software development tools in one installable package. It typically includes libraries, documentation, code samples, processes, and guides that developers can use to create applications for a specific platform.";
}
else if (lowerCommand.includes('what is CAN bus') || lowerCommand.includes('CAN protocol')) {
    responseText = "CAN (Controller Area Network) bus is a robust vehicle bus standard designed to allow microcontrollers and devices to communicate with each other in applications without a host computer. It's widely used in automotive and industrial automation.";
}
else if (lowerCommand.includes('what is Ethernet for embedded systems') || lowerCommand.includes('embedded ethernet')) {
    responseText = "Ethernet in embedded systems allows devices to connect to local area networks (LANs) and the internet using standard Ethernet protocols. This enables high-speed data transfer, remote monitoring, and integration with existing network infrastructure.";
}
else if (lowerCommand.includes('what is USB for embedded systems') || lowerCommand.includes('embedded USB')) {
    responseText = "USB (Universal Serial Bus) in embedded systems provides a common interface for connecting peripheral devices like sensors, displays, and storage to microcontrollers. It supports various data rates and power delivery, simplifying connectivity.";
}
else if (lowerCommand.includes('what is memory organization in microcontroller') || lowerCommand.includes('microcontroller memory organization')) {
    responseText = "Memory organization in a microcontroller refers to how different types of memory (Flash, SRAM, EEPROM) are structured and addressed by the CPU. Understanding this is crucial for efficient programming and resource management.";
}
else if (lowerCommand.includes('what is pipelining in CPU') || lowerCommand.includes('CPU pipelining')) {
    responseText = "Pipelining is a technique used in microprocessor design where multiple instructions are executed concurrently in different stages of the CPU pipeline. This increases instruction throughput and overall processor performance.";
}
else if (lowerCommand.includes('what is latency in embedded systems') || lowerCommand.includes('embedded system latency')) {
    responseText = "Latency in embedded systems refers to the delay between when an event occurs (e.g., a sensor reading) and when the system reacts to it. Low latency is critical for real-time applications.";
}
else if (lowerCommand.includes('what is jitter in embedded systems') || lowerCommand.includes('embedded system jitter')) {
    responseText = "Jitter in embedded systems refers to the variation in latency or the deviation from true periodicity of a signal or event. Excessive jitter can degrade the performance of real-time control systems and communication links.";
}

// --- Internet of Things (IoT) ---
else if (lowerCommand.includes('what is IoT') || lowerCommand.includes('Internet of Things') || lowerCommand.includes('define IoT')) {
    responseText = "IoT (Internet of Things) refers to the network of physical objects embedded with sensors, software, and other technologies for the purpose of connecting and exchanging data with other devices and systems over the internet. It enables objects to 'talk' to each other and the cloud.";
}
else if (lowerCommand.includes('what is an IoT device') || lowerCommand.includes('IoT device')) {
    responseText = "An IoT device is any physical object that contains embedded technology allowing it to connect to the internet and interact with other devices. This can range from smart home appliances and wearable tech to industrial sensors.";
}
else if (lowerCommand.includes('what is an IoT gateway') || lowerCommand.includes('IoT gateway')) {
    responseText = "An IoT gateway is a physical device or a software program that serves as a connection point between the cloud and controllers, sensors, and intelligent devices. It acts as a bridge, aggregating, filtering, and transmitting data securely.";
}
else if (lowerCommand.includes('what is edge computing') || lowerCommand.includes('edge computing IoT')) {
    responseText = "Edge computing in IoT involves processing data closer to where it's generated, rather than sending it all to a centralized cloud. This reduces latency, saves bandwidth, and can improve security and real-time decision-making.";
}
else if (lowerCommand.includes('what is cloud computing') || lowerCommand.includes('cloud computing IoT')) {
    responseText = "Cloud computing in IoT refers to using remote servers, storage, databases, networking, software, analytics, and intelligence over the Internet ('the cloud') to process and store data from IoT devices. It provides scalable resources for large-scale IoT deployments.";
}
else if (lowerCommand.includes('what is an IoT platform') || lowerCommand.includes('IoT platform')) {
    responseText = "An IoT platform is a multi-layered technology that connects physical devices to the cloud and other applications. It provides tools for device management, data acquisition, processing, analytics, and application development for IoT solutions.";
}
else if (lowerCommand.includes('what is MQTT') || lowerCommand.includes('MQTT protocol')) {
    responseText = "MQTT (Message Queuing Telemetry Transport) is a lightweight, publish-subscribe network protocol that transports messages between devices. It's designed for constrained devices and low-bandwidth, high-latency, or unreliable networks, making it popular for IoT applications.";
}
else if (lowerCommand.includes('what is CoAP') || lowerCommand.includes('CoAP protocol')) {
    responseText = "CoAP (Constrained Application Protocol) is a specialized web transfer protocol for use with constrained nodes and constrained networks in the Internet of Things. It's designed for use by small, low-power sensors, switches, and other devices.";
}
else if (lowerCommand.includes('what is LoRaWAN') || lowerCommand.includes('LoRaWAN protocol')) {
    responseText = "LoRaWAN is a Low Power Wide Area Network (LPWAN) specification for wireless, battery-operated IoT devices. It defines the communication protocol and system architecture for the network, offering long-range and low-power connectivity.";
}
else if (lowerCommand.includes('what is Zigbee') || lowerCommand.includes('Zigbee protocol')) {
    responseText = "Zigbee is a wireless technology standard that operates on IEEE 802.15.4, designed for low-power, low-data-rate, short-range wireless networking. It's commonly used in smart homes, building automation, and industrial control systems.";
}
else if (lowerCommand.includes('what is Bluetooth Low Energy') || lowerCommand.includes('BLE')) {
    responseText = "Bluetooth Low Energy (BLE) is a wireless personal area network technology designed and marketed by the Bluetooth Special Interest Group. It's optimized for very low power consumption, making it ideal for small, battery-powered IoT devices and wearables.";
}
else if (lowerCommand.includes('what is smart home') || lowerCommand.includes('smart home technology')) {
    responseText = "A smart home is a residence that uses internet-connected devices to enable the remote monitoring and management of appliances and systems, such as lighting, heating, and security. It aims to enhance comfort, convenience, energy efficiency, and security.";
}
else if (lowerCommand.includes('what is industrial IoT') || lowerCommand.includes('IIoT')) {
    responseText = "Industrial IoT (IIoT) refers to the application of IoT technologies in industrial settings, such as manufacturing, energy management, and supply chain logistics. It focuses on improving operational efficiency, predictive maintenance, and overall productivity.";
}
else if (lowerCommand.includes('what is a digital twin') || lowerCommand.includes('digital twin IoT')) {
    responseText = "A digital twin is a virtual representation of a physical object, system, or process. In IoT, digital twins use real-time data from sensors to create an accurate virtual model, enabling monitoring, simulation, and analysis to optimize performance and predict issues.";
}
else if (lowerCommand.includes('what is fog computing') || lowerCommand.includes('fog computing IoT')) {
    responseText = "Fog computing extends cloud computing to the edge of the network, placing data, compute, storage, and application services closer to end-devices and users. It bridges the gap between edge devices and the cloud, offering faster processing for certain IoT applications.";
}
else if (lowerCommand.includes('what is M2M communication') || lowerCommand.includes('Machine to Machine communication')) {
    responseText = "M2M (Machine-to-Machine) communication refers to the direct communication between devices using any communication channel, including wired and wireless. It's a foundational concept for IoT, enabling devices to exchange data and act without human intervention.";
}
else if (lowerCommand.includes('what is LPWAN') || lowerCommand.includes('Low Power Wide Area Network')) {
    responseText = "LPWAN (Low Power Wide Area Network) is a type of wireless telecommunication network designed to allow long-range communications at a low bit rate among things (connected objects) that are battery-powered, for a period of months or years.";
}
else if (lowerCommand.includes('what is NB-IoT') || lowerCommand.includes('Narrowband IoT')) {
    responseText = "NB-IoT (Narrowband IoT) is a low-power wide-area (LPWA) technology standard published by 3GPP for cellular devices and services. It's designed to enable a wide range of new IoT devices and services, offering extended battery life and deep coverage.";
}
else if (lowerCommand.includes('what is OPC UA') || lowerCommand.includes('OPC Unified Architecture')) {
    responseText = "OPC UA (Open Platform Communications Unified Architecture) is an industrial interoperability standard that enables the secure and reliable exchange of data between industrial equipment and systems from different vendors. It's crucial for IIoT communication.";
}
else if (lowerCommand.includes('what is a message broker') || lowerCommand.includes('IoT message broker')) {
    responseText = "An IoT message broker is a server that handles message routing and queuing between IoT devices and applications. It facilitates communication in publish-subscribe models, ensuring messages are delivered reliably and efficiently, even with many connected devices.";
}

// --- Analog and Digital Communication Systems (More Specific) ---
else if (lowerCommand.includes('what is modulation') || lowerCommand.includes('define modulation')) {
    responseText = "Modulation is the process of varying one or more properties of a carrier wave with a modulating signal that contains information. This allows the information to be transmitted over long distances or different mediums.";
}
else if (lowerCommand.includes('what is AM') || lowerCommand.includes('amplitude modulation')) {
    responseText = "AM stands for Amplitude Modulation. It's a modulation technique used in electronic communication, most commonly for transmitting information via a radio carrier wave. In AM, the amplitude (signal strength) of the carrier wave is varied in proportion to that of the message signal.";
}
else if (lowerCommand.includes('what is FM') || lowerCommand.includes('frequency modulation')) {
    responseText = "FM stands for Frequency Modulation. It's a modulation technique in which the frequency of the carrier wave is varied in proportion to that of the message signal, while its amplitude remains constant. FM is less susceptible to noise than AM.";
}
else if (lowerCommand.includes('what is PM') || lowerCommand.includes('Phase Modulation')) {
    responseText = "PM stands for Phase Modulation. It's a modulation technique where the phase of the carrier wave is varied in proportion to the message signal. PM is closely related to FM and is often used in digital communication.";
}
else if (lowerCommand.includes('what is sampling') || lowerCommand.includes('define sampling in communication')) {
    responseText = "In digital communication, sampling is the process of converting a continuous-time analog signal into a discrete-time signal by taking a series of measurements (samples) at regular intervals. The sampling rate must be at least twice the highest frequency in the signal (Nyquist-Shannon theorem).";
}
else if (lowerCommand.includes('what is quantization') || lowerCommand.includes('define quantization')) {
    responseText = "Quantization is the process of converting a continuous range of values (like sampled amplitudes) into a finite number of discrete steps or levels. In digital communication, after sampling, the amplitude of each sample is rounded to the nearest allowed discrete value.";
}
else if (lowerCommand.includes('what is encoding') || lowerCommand.includes('encoding digital communication')) {
    responseText = "In digital communication, encoding is the process of assigning a unique binary code (a sequence of bits) to each quantized sample or symbol. This allows the digital representation of the information to be transmitted.";
}
else if (lowerCommand.includes('what is PCM') || lowerCommand.includes('Pulse Code Modulation')) {
    responseText = "PCM (Pulse Code Modulation) is a method used to digitally represent sampled analog signals. It's the standard form of digital audio in computers and other digital communication systems. PCM involves three main steps: sampling, quantization, and encoding.";
}
else if (lowerCommand.includes('what is ASK') || lowerCommand.includes('Amplitude Shift Keying')) {
    responseText = "ASK (Amplitude Shift Keying) is a digital modulation technique where the amplitude of a carrier wave is varied to represent binary data (0s and 1s). It's simple but susceptible to noise.";
}
else if (lowerCommand.includes('what is FSK') || lowerCommand.includes('Frequency Shift Keying')) {
    responseText = "FSK (Frequency Shift Keying) is a digital modulation technique where the frequency of the carrier wave is shifted between different values to represent binary data. It's more robust to noise than ASK.";
}
else if (lowerCommand.includes('what is PSK') || lowerCommand.includes('Phase Shift Keying')) {
    responseText = "PSK (Phase Shift Keying) is a digital modulation technique where the phase of the carrier wave is varied to represent binary data. Different phase shifts correspond to different symbols (e.g., 0 and 1).";
}
else if (lowerCommand.includes('what is QAM') || lowerCommand.includes('Quadrature Amplitude Modulation')) {
    responseText = "QAM (Quadrature Amplitude Modulation) is a digital modulation scheme that conveys data by changing (modulating) the amplitude of two carrier waves. These two waves are out of phase with each other by 90 degrees (quadrature). It's efficient for high data rates.";
}
else if (lowerCommand.includes('what is multiplexing') || lowerCommand.includes('define multiplexing')) {
    responseText = "Multiplexing is a method by which multiple analog or digital signals are combined into one signal over a shared medium. The aim is to share a costly resource (e.g., a transmission medium) among multiple independent users.";
}
else if (lowerCommand.includes('what is TDM') || lowerCommand.includes('Time Division Multiplexing')) {
    responseText = "TDM (Time Division Multiplexing) is a technique where different signals are transmitted over a single communication channel by dividing the channel's time into slots. Each signal gets a brief turn to use the channel.";
}
else if (lowerCommand.includes('what is FDM') || lowerCommand.includes('Frequency Division Multiplexing')) {
    responseText = "FDM (Frequency Division Multiplexing) is a technique where multiple signals are transmitted simultaneously over a single communication channel by assigning each signal a different frequency band. This is common in radio broadcasting.";
}
else if (lowerCommand.includes('what is WDM') || lowerCommand.includes('Wavelength Division Multiplexing')) {
    responseText = "WDM (Wavelength Division Multiplexing) is a technology that multiplexes multiple optical carrier signals onto a single optical fiber by using different wavelengths (colors) of laser light. It greatly increases the capacity of optical fiber communication systems.";
}
else if (lowerCommand.includes('what is noise in communication') || lowerCommand.includes('communication noise')) {
    responseText = "Noise in communication systems refers to unwanted random disturbances that interfere with the desired signal. It can degrade the quality and intelligibility of transmitted information, making it harder to recover the original message.";
}
else if (lowerCommand.includes('what is an antenna') || lowerCommand.includes('define antenna')) {
    responseText = "An antenna is a transducer designed to transmit or receive electromagnetic waves. It converts electrical signals into electromagnetic waves for transmission, and vice versa for reception. Antennas come in various shapes and sizes depending on their application.";
}
else if (lowerCommand.includes('what is bandwidth') || lowerCommand.includes('define bandwidth')) {
    responseText = "Bandwidth in communication refers to the range of frequencies occupied by a signal, or the capacity of a transmission medium to carry data. A larger bandwidth generally means more data can be transmitted in a given time.";
}
else if (lowerCommand.includes('what is data rate') || lowerCommand.includes('define data rate')) {
    responseText = "Data rate, or bit rate, is the number of bits that are conveyed or processed per unit of time. It's typically measured in bits per second (bps) and represents the speed at which digital information is transferred.";
}
else if (lowerCommand.includes('what is channel capacity') || lowerCommand.includes('channel capacity')) {
    responseText = "Channel capacity is the maximum rate at which information can be transmitted over a communication channel with arbitrarily small error probability. It's often defined by the Shannon-Hartley theorem, which relates it to bandwidth and signal-to-noise ratio.";
}
else if (lowerCommand.includes('what is signal to noise ratio') || lowerCommand.includes('SNR')) {
    responseText = "Signal-to-Noise Ratio (SNR) is a measure used in science and engineering that compares the level of a desired signal to the level of background noise. A higher SNR indicates a clearer signal with less contamination from noise.";
}
else if (lowerCommand.includes('what is a transmission line') || lowerCommand.includes('transmission line')) {
    responseText = "A transmission line is a specialized cable or other structure designed to carry alternating current of radio frequency, as well as data or power, with minimal signal loss. Examples include coaxial cables and waveguides.";
}
else if (lowerCommand.includes('what is impedance matching') || lowerCommand.includes('impedance matching')) {
    responseText = "Impedance matching is the practice of designing the input impedance of an electrical load or the output impedance of its corresponding signal source to maximize power transfer or minimize signal reflection. It's crucial in RF and audio systems.";
}
else if (lowerCommand.includes('what is reflection coefficient') || lowerCommand.includes('reflection coefficient')) {
    responseText = "The reflection coefficient ($\Gamma$) in a transmission line describes the proportion of an electromagnetic wave that is reflected by an impedance discontinuity in the transmission medium. It's a complex number ranging from -1 to 1.";
}
else if (lowerCommand.includes('what is VSWR') || lowerCommand.includes('Voltage Standing Wave Ratio')) {
    responseText = "VSWR (Voltage Standing Wave Ratio) is a measure of impedance mismatch in a transmission line. It's the ratio of the maximum to minimum voltage in a standing wave pattern, indicating how much power is reflected back toward the source.";
}
else if (lowerCommand.includes('what is spread spectrum') || lowerCommand.includes('spread spectrum communication')) {
    responseText = "Spread spectrum is a technique in telecommunication in which a signal is deliberately spread in the frequency domain, resulting in a wider bandwidth than the information content, for the purpose of making it more robust to interference and jamming.";
}
else if (lowerCommand.includes('what is OFDM') || lowerCommand.includes('Orthogonal Frequency Division Multiplexing')) {
    responseText = "OFDM (Orthogonal Frequency Division Multiplexing) is a method of encoding digital data on multiple carrier frequencies. It's a robust modulation technique used in modern high-speed communication systems like Wi-Fi, 4G/5G, and DSL.";
}
else if (lowerCommand.includes('what is MIMO') || lowerCommand.includes('Multiple-Input Multiple-Output')) {
    responseText = "MIMO (Multiple-Input Multiple-Output) is an antenna technology for wireless communications in which multiple antennas are used at both the transmitter and receiver. It enhances data throughput and link range without requiring additional bandwidth or transmit power.";
}
else if (lowerCommand.includes('what is CDMA') || lowerCommand.includes('Code Division Multiple Access')) {
    responseText = "CDMA (Code Division Multiple Access) is a channel access method used by various radio communication technologies. It allows multiple users to share a common channel simultaneously by assigning a unique code to each user, differentiating their signals.";
}
else if (lowerCommand.includes('what is simplex communication') || lowerCommand.includes('simplex mode')) {
    responseText = "Simplex communication is a communication mode where data can flow in only one direction, from the transmitter to the receiver. Examples include traditional radio broadcasting or a security camera streaming video.";
}
else if (lowerCommand.includes('what is half-duplex communication') || lowerCommand.includes('half duplex mode')) {
    responseText = "Half-duplex communication is a communication mode where data can flow in both directions, but not simultaneously. Devices must take turns transmitting and receiving, like a walkie-talkie.";
}
else if (lowerCommand.includes('what is full-duplex communication') || lowerCommand.includes('full duplex mode')) {
    responseText = "Full-duplex communication is a communication mode where data can flow in both directions simultaneously. This allows for continuous two-way communication, such as in a telephone conversation or Ethernet network.";
}
else if (lowerCommand.includes('what is error detection and correction') || lowerCommand.includes('error correction communication')) {
    responseText = "Error detection and correction techniques are methods used in digital communication to identify and fix errors that may occur during data transmission due to noise or interference. Common methods include parity checks, checksums, and Hamming codes.";
}
else if (lowerCommand.includes('what is a waveguide') || lowerCommand.includes('waveguide RF')) {
    responseText = "A waveguide is a structure that guides waves, such as electromagnetic waves or sound waves. In RF and microwave applications, it's typically a hollow metal pipe used to transmit high-frequency electromagnetic waves with low loss.";
}
else if (lowerCommand.includes('what are S-parameters') || lowerCommand.includes('S parameters')) {
    responseText = "S-parameters (scattering parameters) are a mathematical construct used in electrical engineering to describe the electrical behavior of linear electrical networks when undergoing various steady state stimuli by electrical signals. They are particularly useful for characterizing high-frequency components and transmission lines.";
}
else if (lowerCommand.includes('what is an impedance matching network') || lowerCommand.includes('matching network')) {
    responseText = "An impedance matching network is an electrical network designed to transform the impedance of a source to match the impedance of a load. This maximizes power transfer and minimizes signal reflections in RF and microwave circuits.";
}
else if (lowerCommand.includes('what is satellite communication') || lowerCommand.includes('satellite communication')) {
    responseText = "Satellite communication is a method of communication that uses artificial satellites to relay radio signals between Earth stations. It allows for global coverage and is used for television broadcasting, internet access, and mobile communication.";
}
else if (lowerCommand.includes('what is cellular communication') || lowerCommand.includes('cellular network')) {
    responseText = "Cellular communication is a type of wireless communication where the service area is divided into smaller geographical areas called 'cells,' each served by a base station. This allows for efficient use of spectrum and high user capacity, as seen in mobile phone networks.";
}
else if (lowerCommand.includes('what is fiber optic communication') || lowerCommand.includes('fiber optics')) {
    responseText = "Fiber optic communication is a method of transmitting information from one place to another by sending pulses of light through an optical fiber. It offers high bandwidth, long-distance transmission, and immunity to electromagnetic interference.";
}
else if (lowerCommand.includes('what is a modem') || lowerCommand.includes('modem')) {
    responseText = "A modem (modulator-demodulator) is a network hardware device that modulates one or more carrier wave signals to encode digital information for transmission and demodulates signals to decode the transmitted information. It's used to connect computers to the internet over telephone lines, cable, or fiber.";
}

// --- Power Electronics ---
else if (lowerCommand.includes('what is a DC-DC converter') || lowerCommand.includes('DC to DC converter')) {
    responseText = "A DC-DC converter is an electronic circuit that converts a source of direct current (DC) from one voltage level to another. They are essential in portable electronic devices and renewable energy systems.";
}
else if (lowerCommand.includes('what is a buck converter') || lowerCommand.includes('buck converter')) {
    responseText = "A buck converter (step-down converter) is a type of DC-DC converter that converts a higher input DC voltage to a lower output DC voltage. It's widely used in power supplies.";
}
else if (lowerCommand.includes('what is a boost converter') || lowerCommand.includes('boost converter')) {
    responseText = "A boost converter (step-up converter) is a type of DC-DC converter that converts a lower input DC voltage to a higher output DC voltage. It's used in applications requiring a higher voltage than the available source.";
}
else if (lowerCommand.includes('what is a buck-boost converter') || lowerCommand.includes('buck boost converter')) {
    responseText = "A buck-boost converter is a type of DC-DC converter that can produce an output voltage magnitude that is either greater than or less than the input voltage magnitude. The output voltage is of opposite polarity to the input.";
}
else if (lowerCommand.includes('what is an inverter') || lowerCommand.includes('power inverter')) {
    responseText = "An inverter is an electronic device that converts direct current (DC) to alternating current (AC). It's crucial for applications like solar power systems, UPS (Uninterruptible Power Supplies), and variable frequency drives for AC motors.";
}
else if (lowerCommand.includes('what is a switch mode power supply') || lowerCommand.includes('SMPS')) {
    responseText = "An SMPS (Switch-Mode Power Supply) is an electronic power supply that incorporates a switching regulator to convert electrical power efficiently. It rapidly switches a power device between ON and OFF states to regulate the output voltage, offering high efficiency compared to linear power supplies.";
}
else if (lowerCommand.includes('what is power factor') || lowerCommand.includes('power factor electronics')) {
    responseText = "Power factor is a dimensionless quantity in AC circuits, defined as the ratio of real power flowing to the load to the apparent power in the circuit. It indicates how effectively electrical power is being used. A power factor closer to 1 (unity) is desirable.";
}
else if (lowerCommand.includes('what is a transformer') || lowerCommand.includes('transformer electronics')) {
    responseText = "A transformer is a passive electrical device that transfers electrical energy from one electrical circuit to another, or multiple circuits. A varying current in one coil of the transformer produces a varying magnetic flux in the transformer's core, which in turn induces a varying electromotive force across a second coil.";
}
else if (lowerCommand.includes('what is a UPS') || lowerCommand.includes('Uninterruptible Power Supply')) {
    responseText = "A UPS (Uninterruptible Power Supply) is an electrical apparatus that provides emergency power to a load when the input power source or mains power fails. It typically contains a battery and an inverter, ensuring continuous power to critical equipment.";
}
else if (lowerCommand.includes('what is a full-wave rectifier') || lowerCommand.includes('full wave rectifier')) {
    responseText = "A full-wave rectifier is an electrical circuit that converts both halves of an alternating current (AC) input into a pulsating direct current (DC) output. This makes it more efficient than a half-wave rectifier, providing a smoother DC output after filtering.";
}
else if (lowerCommand.includes('what is a bridge rectifier') || lowerCommand.includes('bridge rectifier')) {
    responseText = "A bridge rectifier is a type of full-wave rectifier circuit that uses four diodes to provide an efficient conversion of alternating current (AC) input to direct current (DC) output. It's commonly used in power supplies for its simplicity and effectiveness.";
}
else if (lowerCommand.includes('what is a linear power supply') || lowerCommand.includes('linear power supply')) {
    responseText = "A linear power supply is a power supply that uses a linear regulator to maintain a constant output voltage. It achieves regulation by dissipating excess voltage as heat, making it less efficient but often resulting in lower noise and ripple compared to SMPS.";
}
else if (lowerCommand.includes('what is active power') || lowerCommand.includes('real power')) {
    responseText = "Active power (also known as real power) is the actual power consumed by the load in an AC circuit. It is the component of power that results in the dissipation of energy, such as heat, light, or mechanical work, measured in Watts (W).";
}
else if (lowerCommand.includes('what is reactive power') || lowerCommand.includes('reactive power')) {
    responseText = "Reactive power is the power that oscillates between the source and the reactive components (inductors and capacitors) in an AC circuit. It does not perform any useful work but is necessary for the operation of inductive loads. It is measured in Volt-Ampere Reactive (VAR).";
}

// --- Instrumentation & Measurement ---
else if (lowerCommand.includes('what is an oscilloscope') || lowerCommand.includes('oscilloscope')) {
    responseText = "An oscilloscope is an electronic test instrument that graphically displays varying signal voltages, usually as a two-dimensional plot of one or more signals as a function of time. It's indispensable for observing and analyzing waveforms.";
}
else if (lowerCommand.includes('what is a multimeter') || lowerCommand.includes('multimeter')) {
    responseText = "A multimeter is an electronic measuring instrument that combines several measurement functions in one unit. A typical multimeter can measure voltage, current, and resistance, and some can also measure capacitance, frequency, and temperature.";
}
else if (lowerCommand.includes('what is a function generator') || lowerCommand.includes('function generator')) {
    responseText = "A function generator is a piece of electronic test equipment used to generate various types of electrical waveforms over a wide range of frequencies. Common waveforms include sine, square, triangle, and sawtooth waves.";
}
else if (lowerCommand.includes('what is a logic analyzer') || lowerCommand.includes('logic analyzer')) {
    responseText = "A logic analyzer is an electronic instrument that captures and displays multiple digital signals from a digital system or circuit. Unlike an oscilloscope, which displays analog waveforms, a logic analyzer focuses on the timing and logic states (high/low) of digital signals.";
}
else if (lowerCommand.includes('what is a spectrum analyzer') || lowerCommand.includes('spectrum analyzer')) {
    responseText = "A spectrum analyzer is an electronic instrument that measures the magnitude of an input signal versus frequency within the full frequency range of the instrument. Its primary use is to measure the power of the spectrum of known and unknown signals.";
}
else if (lowerCommand.includes('what is a signal generator') || lowerCommand.includes('signal generator')) {
    responseText = "A signal generator is an electronic device that generates repeating or non-repeating electronic signals (waveforms) in either the analog or digital domain. These are used as stimuli for testing electronic designs, for example, to test the frequency response of an amplifier.";
}
else if (lowerCommand.includes('what is an LCR meter') || lowerCommand.includes('LCR meter')) {
    responseText = "An LCR meter is a piece of electronic test equipment used to measure the inductance (L), capacitance (C), and resistance (R) of an electronic component. It can also measure other derived parameters like Q factor and dissipation factor.";
}
else if (lowerCommand.includes('what is a power supply') || lowerCommand.includes('lab power supply')) {
    responseText = "A power supply is an electrical device that supplies electric power to an electrical load. It's typically used to convert one form of electrical energy to another, regulating the output voltage and current to provide stable power for testing and operating circuits.";
}
else if (lowerCommand.includes('what is calibration') || lowerCommand.includes('instrument calibration')) {
    responseText = "Calibration is the process of configuring an instrument to provide a result for a sample within an acceptable range. It involves comparing the readings of a measurement device against a known standard to ensure accuracy.";
}
else if (lowerCommand.includes('what is a data logger') || lowerCommand.includes('data logger')) {
    responseText = "A data logger is an electronic device that records data over time or in relation to location either with a built-in instrument or sensor or via external instruments and sensors. They are used for long-term monitoring of environmental conditions, process parameters, and more.";
}
else if (lowerCommand.includes('what is an arbitrary waveform generator') || lowerCommand.includes('AWG')) {
    responseText = "An Arbitrary Waveform Generator (AWG) is an electronic test equipment that can generate any desired waveform, unlike a standard function generator which produces only predefined waveforms (sine, square, etc.). AWGs are highly versatile for complex signal generation.";
}
else if (lowerCommand.includes('what is ground in electronics') || lowerCommand.includes('ground electronics')) {
    responseText = "Ground in electronics is the reference point in an electrical circuit from which voltages are measured. It also serves as a common return path for electric current and can provide a safety path for fault currents.";
}
else if (lowerCommand.includes('what is a short circuit') || lowerCommand.includes('short circuit')) {
    responseText = "A short circuit is an electrical circuit that allows current to travel along an unintended path with very low electrical impedance. This can cause excessive current flow, leading to overheating, damage to components, or fire.";
}
else if (lowerCommand.includes('what is an open circuit') || lowerCommand.includes('open circuit')) {
    responseText = "An open circuit is an electrical circuit in which the continuity has been broken, so that current cannot flow. This results in infinite resistance and zero current flow through the open part of the circuit.";
}

// --- Materials and Fabrication ---
else if (lowerCommand.includes('what is a PCB') || lowerCommand.includes('Printed Circuit Board')) {
    responseText = "A PCB (Printed Circuit Board) is a board used to mechanically support and electrically connect electronic components using conductive pathways, tracks, or signal traces etched from copper sheets laminated onto a non-conductive substrate. It's the foundation of almost all electronic devices.";
}
else if (lowerCommand.includes('what is soldering') || lowerCommand.includes('soldering electronics')) {
    responseText = "Soldering is a process in which two or more items are joined together by melting and putting a filler metal (solder) into the joint, with the filler metal having a lower melting point than the adjoining metal. It's a common method for making electrical connections.";
}
else if (lowerCommand.includes('what is surface mount technology') || lowerCommand.includes('SMT')) {
    responseText = "SMT (Surface-Mount Technology) is a method for producing electronic circuits in which the components are mounted directly onto the surface of printed circuit boards (PCBs). This contrasts with through-hole technology, where components have leads that are inserted into holes.";
}
else if (lowerCommand.includes('what is through-hole technology') || lowerCommand.includes('THT')) {
    responseText = "Through-Hole Technology (THT) is a method for constructing electronic circuits by inserting components' leads through holes in printed circuit boards (PCBs) and soldering them on the opposite side. It's a traditional method, often more robust than SMT for certain components.";
}
else if (lowerCommand.includes('what is a semiconductor') || lowerCommand.includes('semiconductor material')) {
    responseText = "A semiconductor is a material that has electrical conductivity between that of a conductor (like copper) and an insulator (like glass). Their conductivity can be controlled, making them fundamental to modern electronics.";
}
else if (lowerCommand.includes('what is silicon') || lowerCommand.includes('silicon electronics')) {
    responseText = "Silicon (Si) is a chemical element that is the most common semiconductor material used in electronic devices. Its unique atomic structure allows it to be easily doped, forming the basis for integrated circuits, transistors, and solar cells.";
}
else if (lowerCommand.includes('what is gallium nitride') || lowerCommand.includes('GaN electronics')) {
    responseText = "Gallium Nitride (GaN) is a wide-bandgap semiconductor material that is becoming increasingly important in power electronics and RF applications. It offers higher efficiency, faster switching speeds, and smaller form factors compared to traditional silicon devices.";
}
else if (lowerCommand.includes('what is germanium') || lowerCommand.includes('germanium electronics')) {
    responseText = "Germanium (Ge) is a chemical element that is also a semiconductor, historically used before silicon became dominant. It has a lower bandgap than silicon, making it useful in certain high-frequency and infrared applications, though less common today.";
}
else if (lowerCommand.includes('what is a substrate') || lowerCommand.includes('substrate electronics')) {
    responseText = "In electronics, a substrate is the base material on which components are fabricated or assembled. For PCBs, it's typically fiberglass; for ICs, it's a thin wafer of semiconductor material like silicon.";
}
else if (lowerCommand.includes('what is etching') || lowerCommand.includes('etching PCB')) {
    responseText = "Etching in PCB fabrication is the process of chemically removing unwanted copper from the board, leaving behind the desired conductive traces and pads. This is a key step in creating the circuit pattern.";
}
else if (lowerCommand.includes('what is reflow soldering') || lowerCommand.includes('reflow soldering')) {
    responseText = "Reflow soldering is a process in which solder paste (a mixture of powdered solder and flux) is used to temporarily attach surface-mount components to their contact pads, after which the entire assembly is subjected to controlled heat to melt the solder and form permanent electrical connections.";
}

// --- Control Systems ---
else if (lowerCommand.includes('what is a control system') || lowerCommand.includes('control system')) {
    responseText = "A control system is a device or set of devices that manages, commands, directs, or regulates the behavior of other devices or systems. It's designed to achieve a desired output by controlling various inputs.";
}
else if (lowerCommand.includes('what is open-loop control') || lowerCommand.includes('open loop control')) {
    responseText = "An open-loop control system is a type of control system where the control action is independent of the output. The system does not use feedback to determine if the desired output has been achieved, making it simpler but less accurate.";
}
else if (lowerCommand.includes('what is closed-loop control') || lowerCommand.includes('closed loop control') || lowerCommand.includes('feedback control')) {
    responseText = "A closed-loop control system, or feedback control system, is a type of control system where the control action is dependent on the output. It uses feedback from the output to adjust its control action, aiming to achieve and maintain a desired setpoint.";
}
else if (lowerCommand.includes('what is PID control') || lowerCommand.includes('PID controller')) {
    responseText = "PID (Proportional-Integral-Derivative) control is a widely used feedback control loop mechanism in industrial control systems and other applications requiring continuously modulated control. It continuously calculates an error value and applies a correction based on proportional, integral, and derivative terms.";
}
else if (lowerCommand.includes('what is a setpoint') || lowerCommand.includes('setpoint control')) {
    responseText = "In a control system, the setpoint is the desired or target value for the controlled variable. The controller's goal is to manipulate inputs to bring the system's actual output as close as possible to the setpoint.";
}
else if (lowerCommand.includes('what is stability in control systems') || lowerCommand.includes('control system stability')) {
    responseText = "Stability in control systems refers to the ability of a system to return to its equilibrium state or desired operating point after being disturbed. An unstable system will exhibit unbounded oscillations or diverge from its operating point.";
}
else if (lowerCommand.includes('what is a control loop') || lowerCommand.includes('control loop')) {
    responseText = "A control loop is a feedback mechanism in a control system where the output of the system is measured, compared to a desired setpoint, and the difference (error) is used to adjust the input to bring the output closer to the setpoint.";
}
else if (lowerCommand.includes('what is a sensor in control systems') || lowerCommand.includes('control system sensor')) {
    responseText = "In a control system, a sensor measures the actual value of the controlled variable (the output) and converts it into a signal that can be used by the controller. This feedback is essential for closed-loop control.";
}
else if (lowerCommand.includes('what is a controller') || lowerCommand.includes('controller control system')) {
    responseText = "In a control system, the controller is the component that receives the error signal (difference between setpoint and actual output) and generates an appropriate control action (input) to reduce that error and drive the system towards the setpoint.";
}
else if (lowerCommand.includes('what is an actuator in control systems') || lowerCommand.includes('control system actuator')) {
    responseText = "In a control system, an actuator is the component that converts a control signal from the controller into a physical action that affects the system being controlled. Examples include motors, valves, and heaters.";
}
else if (lowerCommand.includes('what is steady-state error') || lowerCommand.includes('steady state error control')) {
    responseText = "Steady-state error in a control system is the difference between the desired output (setpoint) and the actual output of the system after the transient response has settled. It's a measure of the system's accuracy at equilibrium.";
}

// --- Programming Languages and Platforms ---
else if (lowerCommand.includes('what is c pro') || lowerCommand.includes('what is c programming') || lowerCommand.includes('c programming')) {
    responseText = "C programming (often referred to as 'C Pro' in a general sense for professional application) is a powerful, general-purpose programming language widely used for system programming, embedded systems, and applications where performance is critical. It's a foundational language for many other languages.";
}
else if (lowerCommand.includes('what is matlab') || lowerCommand.includes('matlab')) {
    responseText = "MATLAB (Matrix Laboratory) is a proprietary multi-paradigm programming language and numerical computing environment developed by MathWorks. It's primarily used for numerical computation, visualization, and programming, especially in engineering and scientific fields.";
}
else if (lowerCommand.includes('what is arduino language') || lowerCommand.includes('arduino programming language')) {
    responseText = "The Arduino programming language is a simplified version of C/C++. It consists of two main functions: 'setup()' for initialization and 'loop()' for the main program logic, and uses a set of specific functions and libraries designed to easily interact with the Arduino hardware.";
}
else if (lowerCommand.includes('what is python for electronics') || lowerCommand.includes('python electronics')) {
    responseText = "Python is a high-level, interpreted programming language widely used in electronics for data analysis, automation (e.g., controlling test equipment), scripting for Raspberry Pi and other SBCs, and developing user interfaces for embedded systems. Its simplicity and extensive libraries make it very versatile.";
}
else if (lowerCommand.includes('what is assembly language') || lowerCommand.includes('assembly language electronics')) {
    responseText = "Assembly language is a low-level programming language that is very close to machine code. Each instruction in assembly language typically corresponds to a single machine instruction. It's used for highly optimized code in embedded systems where direct hardware control and performance are critical.";
}
else if (lowerCommand.includes('what is C++ for electronics') || lowerCommand.includes('C++ electronics')) {
    responseText = "C++ is a powerful, object-oriented programming language that is an extension of C. It offers higher-level abstractions and features, making it suitable for more complex embedded systems, real-time applications, and developing sophisticated control algorithms.";
}
else if (lowerCommand.includes('what is Java for electronics') || lowerCommand.includes('Java electronics')) {
    responseText = "Java is a high-level, object-oriented programming language known for its 'write once, run anywhere' capability. While less common for low-level microcontroller programming, it's used in higher-level embedded systems, IoT gateways, and applications requiring robust, platform-independent software.";
}
else if (lowerCommand.includes('what is JavaScript for electronics') || lowerCommand.includes('JavaScript electronics')) {
    responseText = "JavaScript, primarily a web scripting language, is also gaining traction in electronics for IoT projects, especially with platforms like Espruino (running JavaScript directly on microcontrollers) and Node.js for backend IoT applications and dashboards.";
}
// Add more conditions here for electronics and its components and definitions

else if (lowerCommand.includes('what is a resistor') || lowerCommand.includes('resistor')) {
    responseText = "A resistor is a passive two-terminal electrical component that implements electrical resistance as a circuit element. In electronic circuits, resistors are used to reduce current flow, adjust signal levels, to divide voltages, bias active elements, and terminate transmission lines, among other uses.";
}
else if (lowerCommand.includes('what is a capacitor') || lowerCommand.includes('capacitor')) {
    responseText = "A capacitor is a passive two-terminal electrical component that stores electrical energy in an electric field. The effect of a capacitor is known as capacitance. While some capacitance exists between any two electrical conductors in proximity in a circuit, a capacitor is a component designed to add capacitance to a circuit.";
}
else if (lowerCommand.includes('what is an inductor') || lowerCommand.includes('inductor')) {
    responseText = "An inductor, also called a choke, is a passive two-terminal electrical component that stores energy in a magnetic field when electric current flows through it. An inductor typically consists of a conductor such as a wire, usually wound into a coil.";
}
else if (lowerCommand.includes('what is a diode') || lowerCommand.includes('diode')) {
    responseText = "A diode is a two-terminal electronic component that conducts current primarily in one direction; it has low (ideally zero) resistance in one direction, and high (ideally infinite) resistance in the other. It's often used for rectification, converting AC to DC.";
}
else if (lowerCommand.includes('what is a transistor') || lowerCommand.includes('transistor')) {
    responseText = "A transistor is a semiconductor device used to amplify or switch electronic signals and electrical power. It is one of the basic building blocks of modern electronics and is essential in digital circuits like microprocessors, and analog circuits like audio amplifiers.";
}
else if (lowerCommand.includes('what is an LED') || lowerCommand.includes('LED')) {
    responseText = "An LED (Light Emitting Diode) is a semiconductor light source that emits light when current flows through it. Electrons in the semiconductor recombine with electron holes, releasing energy in the form of photons. LEDs are very energy-efficient and have a long lifespan.";
}
else if (lowerCommand.includes('what is a breadboard') || lowerCommand.includes('breadboard')) {
    responseText = "A breadboard is a solderless construction base used for prototyping of electronics. It allows you to quickly build temporary circuits and experiment with different component arrangements without having to solder anything.";
}
else if (lowerCommand.includes('what is Ohm\'s law') || lowerCommand.includes('ohms law') || lowerCommand.includes('define ohms law')) {
    responseText = "Ohm's Law states that the current through a conductor between two points is directly proportional to the voltage across the two points. Mathematically, it's expressed as V = I * R, where V is voltage, I is current, and R is resistance.";
}
else if (lowerCommand.includes('what is current') || lowerCommand.includes('define current')) {
    responseText = "Electric current is the rate of flow of electric charge past a point or region. A common analogy is the flow of water in a pipe, where current is the amount of water flowing per unit time.";
}
else if (lowerCommand.includes('what is voltage') || lowerCommand.includes('define voltage')) {
    responseText = "Voltage, also known as electric potential difference, is the difference in electric potential energy between two points per unit electric charge. It represents the 'push' or 'force' that drives electric current.";
}
else if (lowerCommand.includes('what is resistance') || lowerCommand.includes('define resistance')) {
    responseText = "Electrical resistance is a measure of the opposition to the flow of electric current in an electrical circuit. It's measured in ohms (Ω). Materials with high resistance are insulators, and those with low resistance are conductors.";
}
else if (lowerCommand.includes('what is an integrated circuit') || lowerCommand.includes('integrated circuit') || lowerCommand.includes('what is an IC') || lowerCommand.includes('IC')) {
    responseText = "An Integrated Circuit (IC), sometimes called a microchip, is a set of electronic circuits on one small flat piece (or 'chip') of semiconductor material, usually silicon. ICs are used in virtually all electronic equipment today.";
}
else if (lowerCommand.includes('what is a sensor') || lowerCommand.includes('define sensor')) {
    responseText = "A sensor is a device, module, machine, or subsystem whose purpose is to detect events or changes in its environment and send the information to other electronics, frequently a computer processor. It's a key component in gathering data from the physical world.";
}
else if (lowerCommand.includes('what is a microcontroller') || lowerCommand.includes('microcontroller')) {
    responseText = "A microcontroller is a small computer on a single metal-oxide-semiconductor (MOS) integrated circuit chip. It contains one or more CPUs along with memory and programmable input/output peripherals. Microcontrollers are used in automatically controlled products and devices, such as automobile engine control systems, implantable medical devices, remote controls, office machines, appliances, power tools, and toys.";
}
else if (lowerCommand.includes('what is a schematic') || lowerCommand.includes('schematic diagram')) {
    responseText = "A schematic diagram is a representation of the elements of a system using abstract, graphic symbols rather than realistic pictures. A schematic diagram of an electronic circuit shows the components of the circuit as simplified shapes, and the power and signal connections between them.";
}
else if (lowerCommand.includes('what is current flow direction') || lowerCommand.includes('conventional current')) {
    responseText = "Conventional current is the concept that electric current flows from the positive terminal to the negative terminal, even though electrons (which carry the charge) actually flow in the opposite direction. It's a historical convention still widely used in circuit analysis.";
}
else if (lowerCommand.includes('what is a series circuit') || lowerCommand.includes('series circuit')) {
    responseText = "In a series circuit, components are connected end-to-end, forming a single path for the current to flow. The current is the same through each component, but the voltage drops across each component add up to the total voltage.";
}
else if (lowerCommand.includes('what is a parallel circuit') || lowerCommand.includes('parallel circuit')) {
    responseText = "In a parallel circuit, components are connected across the same two points, creating multiple paths for the current. The voltage across each component is the same, but the total current is the sum of the currents through each path.";
}
// --- Digital Electronics ---
else if (lowerCommand.includes('what is a logic gate') || lowerCommand.includes('logic gate')) {
    responseText = "A logic gate is an elementary building block of a digital circuit. Most logic gates have two inputs and one output. At any given moment, every terminal is in one of the two binary conditions, low (0) or high (1).";
}
else if (lowerCommand.includes('what is an AND gate') || lowerCommand.includes('AND gate')) {
    responseText = "An AND gate is a digital logic gate that implements logical conjunction. It produces a high output (1) only if all its inputs are high (1). Otherwise, the output is low (0).";
}
else if (lowerCommand.includes('what is an OR gate') || lowerCommand.includes('OR gate')) {
    responseText = "An OR gate is a digital logic gate that implements logical disjunction. It produces a high output (1) if any of its inputs are high (1). The output is low (0) only if all inputs are low (0).";
}
else if (lowerCommand.includes('what is a NOT gate') || lowerCommand.includes('NOT gate') || lowerCommand.includes('inverter')) {
    responseText = "A NOT gate, also known as an inverter, is a digital logic gate with one input and one output. It performs logical negation, producing a high output (1) if the input is low (0), and a low output (0) if the input is high (1).";
}
else if (lowerCommand.includes('what is an XOR gate') || lowerCommand.includes('XOR gate')) {
    responseText = "An XOR (Exclusive-OR) gate is a digital logic gate that produces a high output (1) if an odd number of its inputs are high (1). If both inputs are the same (both 0 or both 1), the output is low (0).";
}
else if (lowerCommand.includes('what is a flip-flop') || lowerCommand.includes('flip flop')) {
    responseText = "A flip-flop is a basic storage element in sequential logic circuits, capable of storing one bit of information. It has two stable states and is used as a fundamental building block of digital memory and sequential logic.";
}
else if (lowerCommand.includes('what is combinational logic') || lowerCommand.includes('combinational logic')) {
    responseText = "Combinational logic is a type of digital logic circuit whose output is purely a function of the present inputs. It does not contain memory elements and its output changes immediately when inputs change.";
}
else if (lowerCommand.includes('what is sequential logic') || lowerCommand.includes('sequential logic')) {
    responseText = "Sequential logic is a type of digital logic circuit whose output depends not only on the present inputs but also on the sequence of past inputs, due to the presence of memory elements (like flip-flops).";
}
else if (lowerCommand.includes('what is a multiplexer') || lowerCommand.includes('mux')) {
    responseText = "A multiplexer (MUX) is a device that selects one of several analog or digital input signals and forwards the selected input into a single output line. It's essentially a multi-input, single-output switch.";
}
else if (lowerCommand.includes('what is a demultiplexer') || lowerCommand.includes('demux')) {
    responseText = "A demultiplexer (DEMUX) is a device that takes a single input signal and selects one of many data-output-lines, which is connected to the single input. It's the inverse of a multiplexer, acting as a single-input, multi-output switch.";
}
else if (lowerCommand.includes('what is an encoder') || lowerCommand.includes('encoder digital')) {
    responseText = "An encoder is a combinational logic circuit that converts a non-binary input code to a binary output code. For example, it might convert a decimal digit input to a binary-coded decimal (BCD) output.";
}
else if (lowerCommand.includes('what is a decoder') || lowerCommand.includes('decoder digital')) {
    responseText = "A decoder is a combinational logic circuit that converts n input lines into $2^n$ output lines. Only one output line is active for a given input combination. It's often used to convert binary codes into human-readable outputs.";
}
else if (lowerCommand.includes('what is a counter') || lowerCommand.includes('digital counter')) {
    responseText = "A digital counter is a sequential logic circuit that counts specific events or pulses applied to its input. It can be implemented using flip-flops and can count up, down, or in various sequences.";
}
else if (lowerCommand.includes('what is a register') || lowerCommand.includes('digital register')) {
    responseText = "A register is a small amount of fast storage available to the CPU within a microcontroller or processor. It holds data that the CPU is currently working on, significantly speeding up data access.";
}
else if (lowerCommand.includes('what is ADC') || lowerCommand.includes('Analog to Digital Converter')) {
    responseText = "An Analog-to-Digital Converter (ADC) is an electronic circuit that converts a continuous analog signal (like temperature or sound) into a discrete digital signal. This allows digital systems to process real-world analog data.";
}
else if (lowerCommand.includes('what is DAC') || lowerCommand.includes('Digital to Analog Converter')) {
    responseText = "A Digital-to-Analog Converter (DAC) is an electronic circuit that converts a digital signal (a sequence of binary numbers) into an analog signal (a continuous voltage or current). It's the opposite of an ADC.";
}
else if (lowerCommand.includes('what is a buffer') || lowerCommand.includes('digital buffer')) {
    responseText = "In digital electronics, a buffer is a logic gate that simply passes its input to its output without changing its logical state. It's used primarily to provide current amplification (buffering) to drive multiple loads or to isolate circuits.";
}
else if (lowerCommand.includes('what is CMOS') || lowerCommand.includes('CMOS logic')) {
    responseText = "CMOS (Complementary Metal-Oxide-Semiconductor) is a technology for constructing integrated circuits. It uses complementary and symmetrical pairs of p-type and n-type MOSFETs for logic functions, known for low power consumption.";
}
else if (lowerCommand.includes('what is TTL') || lowerCommand.includes('TTL logic')) {
    responseText = "TTL (Transistor-Transistor Logic) is a class of digital logic circuits constructed from bipolar junction transistors. It was widely used for digital ICs, known for its speed, but typically consumes more power than CMOS.";
}
else if (lowerCommand.includes('what is tristate logic') || lowerCommand.includes('tri-state buffer')) {
    responseText = "Tri-state logic refers to a digital output that can be in one of three states: high (1), low (0), or high-impedance (Z). The high-impedance state effectively disconnects the output, allowing multiple devices to share a bus.";
}
else if (lowerCommand.includes('what is FPGA') || lowerCommand.includes('Field-Programmable Gate Array')) {
    responseText = "An FPGA (Field-Programmable Gate Array) is an integrated circuit designed to be configured by a customer or a designer after manufacturing. FPGAs are highly flexible and can implement any digital circuit, making them suitable for rapid prototyping and custom hardware acceleration.";
}
else if (lowerCommand.includes('what is ASIC') || lowerCommand.includes('Application-Specific Integrated Circuit')) {
    responseText = "An ASIC (Application-Specific Integrated Circuit) is an integrated circuit customized for a particular use, rather than general-purpose use. ASICs are designed for specific tasks, leading to higher performance and lower power consumption for that task, but involve high initial design costs.";
}
else if (lowerCommand.includes('what is HDL') || lowerCommand.includes('Hardware Description Language')) {
    responseText = "HDL (Hardware Description Language) is a specialized computer language used to describe the structure, design, and operation of electronic circuits. VHDL and Verilog are common HDLs used for designing digital systems, particularly FPGAs and ASICs.";
}
else if (lowerCommand.includes('what is a state machine') || lowerCommand.includes('finite state machine')) {
    responseText = "A state machine (or finite state machine, FSM) is a mathematical model of computation used to design sequential logic circuits. It consists of a finite number of states, transitions between those states, and actions that can be performed upon entering a state or taking a transition.";
}
else if (lowerCommand.includes('what is DRAM') || lowerCommand.includes('Dynamic Random Access Memory')) {
    responseText = "DRAM (Dynamic Random Access Memory) is a type of random-access memory that stores each bit of data in a separate capacitor within an integrated circuit. It requires periodic refreshing of its charge to maintain the stored data, hence the term 'dynamic'.";
}
else if (lowerCommand.includes('what is SRAM') || lowerCommand.includes('Static Random Access Memory')) {
    responseText = "SRAM (Static Random Access Memory) is a type of random-access memory that uses latching circuitry (flip-flops) to store each bit. Unlike DRAM, it does not need to be refreshed periodically, making it faster but more expensive and less dense.";
}
else if (lowerCommand.includes('what is ROM') || lowerCommand.includes('Read Only Memory')) {
    responseText = "ROM (Read-Only Memory) is a type of non-volatile memory used in computers and other electronic devices. Data stored in ROM cannot be electronically modified after the manufacturing of the memory device, or requires significant effort to do so.";
}
else if (lowerCommand.includes('what is flash memory') || lowerCommand.includes('flash storage')) {
    responseText = "Flash memory is a non-volatile computer memory that can be electrically erased and reprogrammed. It is a type of EEPROM and is widely used in USB flash drives, solid-state drives (SSDs), digital cameras, and mobile phones for data storage.";
}
else if (lowerCommand.includes('what is a shift register') || lowerCommand.includes('shift register')) {
    responseText = "A shift register is a digital circuit that can store and move data by shifting bits sequentially. It's often used for serial-to-parallel conversion, parallel-to-serial conversion, or as a delay element.";
}
else if (lowerCommand.includes('what is a NAND gate') || lowerCommand.includes('NAND gate')) {
    responseText = "A NAND gate is a digital logic gate that produces a low output (0) only if all its inputs are high (1). If any input is low (0), the output is high (1). It's considered a universal gate because any other logic gate can be implemented using only NAND gates.";
}
else if (lowerCommand.includes('what is a NOR gate') || lowerCommand.includes('NOR gate')) {
    responseText = "A NOR gate is a digital logic gate that produces a high output (1) only if all its inputs are low (0). If any input is high (1), the output is low (0). It's also a universal gate.";
}
else if (lowerCommand.includes('what is an XNOR gate') || lowerCommand.includes('XNOR gate')) {
    responseText = "An XNOR (Exclusive-NOR) gate is a digital logic gate that produces a high output (1) if both of its inputs are the same (both 0 or both 1). If the inputs are different, the output is low (0). It's the complement of an XOR gate.";
}
else if (lowerCommand.includes('what is a D flip-flop') || lowerCommand.includes('D flip flop')) {
    responseText = "A D (Data) flip-flop is a basic storage element that stores the value present on its data input (D) when the clock signal transitions. It's used for storing a single bit of data and is fundamental in registers and memory.";
}
else if (lowerCommand.includes('what is a JK flip-flop') || lowerCommand.includes('JK flip flop')) {
    responseText = "A JK flip-flop is a versatile type of flip-flop with two inputs, J (set) and K (reset), which can cause the output to toggle, set, or reset depending on the input combination and clock signal. It can behave as a SR flip-flop or a T flip-flop.";
}
else if (lowerCommand.includes('what is a counter type') || lowerCommand.includes('ripple counter')) {
    responseText = "A ripple counter (or asynchronous counter) is a sequential logic circuit where the flip-flop output of one stage serves as the clock input for the next stage. The clock signal 'ripples' through the stages, leading to a propagation delay.";
}
else if (lowerCommand.includes('what is a synchronous counter') || lowerCommand.includes('synchronous counter')) {
    responseText = "A synchronous counter is a sequential logic circuit where all flip-flops are clocked simultaneously by a common clock signal. This eliminates the propagation delay issues seen in ripple counters, allowing for higher operating speeds.";
}
else if (lowerCommand.includes('what is EEPROM') || lowerCommand.includes('Electrically Erasable Programmable Read-Only Memory')) {
    responseText = "EEPROM (Electrically Erasable Programmable Read-Only Memory) is a type of non-volatile memory that can be erased and reprogrammed electrically, usually a byte at a time. It's commonly used for storing small amounts of configuration data in microcontrollers and other devices.";
}
else if (lowerCommand.includes('what is a microprocessor') || lowerCommand.includes('microprocessor')) {
    responseText = "A microprocessor (MPU) is a computer processor on a single integrated circuit. It contains the central processing unit (CPU) but typically requires external memory and peripheral components to form a complete system. It's more powerful than a microcontroller for general-purpose computing.";
}
else if (lowerCommand.includes('what is a latch') || lowerCommand.includes('digital latch')) {
    responseText = "A latch is a basic memory element that stores one bit of information. Unlike flip-flops, latches are level-sensitive, meaning their output can change as long as the enable input is active, rather than only on a clock edge.";
}
else if (lowerCommand.includes('what is a register file') || lowerCommand.includes('register file')) {
    responseText = "A register file is a collection of CPU registers in a processor. It allows for fast read and write access to multiple registers simultaneously, which is crucial for high-performance CPU architectures.";
}
else if (lowerCommand.includes('what is a ROM type') || lowerCommand.includes('PROM')) {
    responseText = "PROM (Programmable Read-Only Memory) is a type of ROM that can be programmed once by the user. Once programmed, the data is permanent and cannot be erased, typically achieved by blowing internal fuses.";
}
else if (lowerCommand.includes('what is EPROM') || lowerCommand.includes('Erasable Programmable Read-Only Memory')) {
    responseText = "EPROM (Erasable Programmable Read-Only Memory) is a type of ROM that can be erased by exposure to strong ultraviolet (UV) light and then reprogrammed. This allows for updating the firmware if needed, common in older embedded systems.";
}
else if (lowerCommand.includes('what is a barrel shifter') || lowerCommand.includes('barrel shifter')) {
    responseText = "A barrel shifter is a digital circuit that can shift a data word by a specified number of bit positions in a single clock cycle. It's much faster than cascading individual shift registers and is commonly used in arithmetic logic units (ALUs) of processors.";
}
else if (lowerCommand.includes('what is an ALU') || lowerCommand.includes('Arithmetic Logic Unit')) {
    responseText = "An ALU (Arithmetic Logic Unit) is a digital circuit that performs arithmetic operations (like addition, subtraction) and logical operations (like AND, OR, NOT) on integer binary numbers. It's a fundamental component of the central processing unit (CPU).";
}
else if (lowerCommand.includes('what is a program counter') || lowerCommand.includes('program counter')) {
    responseText = "The program counter (PC), also called the instruction pointer, is a register in a computer processor that indicates the address of the next instruction to be executed. It's essential for sequential program execution and managing control flow.";
}
else if (lowerCommand.includes('what is a CPU pipeline') || lowerCommand.includes('CPU pipeline')) {
    responseText = "A CPU pipeline is a technique where multiple instructions are executed concurrently in different stages of the CPU (e.g., fetch, decode, execute, write-back). This increases instruction throughput, allowing the processor to execute more instructions per unit time.";
}
else if (lowerCommand.includes('what is cache memory') || lowerCommand.includes('cache memory')) {
    responseText = "Cache memory is a small, high-speed type of volatile computer memory that the CPU can access more quickly than regular main memory (RAM). It stores frequently used data and instructions to speed up processing.";
}
else if (lowerCommand.includes('what is virtual memory') || lowerCommand.includes('virtual memory')) {
    responseText = "Virtual memory is a memory management technique that makes a computer seem to have more random access memory (RAM) than it physically has. It allows a system to use hard disk space as if it were RAM, extending the available memory for running programs.";
}
else if (lowerCommand.includes('what is a memory management unit') || lowerCommand.includes('MMU')) {
    responseText = "A Memory Management Unit (MMU) is a computer hardware component responsible for handling memory accesses requested by the CPU. Its primary role is to translate virtual memory addresses to physical memory addresses and provide memory protection.";
}
else if (lowerCommand.includes('what is clock gating') || lowerCommand.includes('clock gating')) {
    responseText = "Clock gating is a power optimization technique used in synchronous digital circuits to reduce power consumption by disabling the clock signal to idle parts of a circuit. This prevents unnecessary switching activity.";
}
else if (lowerCommand.includes('what is a clock domain') || lowerCommand.includes('clock domain')) {
    responseText = "A clock domain refers to a portion of a digital circuit that operates under a single clock signal. Designing systems with multiple clock domains requires careful synchronization to avoid metastability issues.";
}
else if (lowerCommand.includes('what is a synchronous design') || lowerCommand.includes('synchronous design')) {
    responseText = "Synchronous design in digital circuits means that all sequential elements (flip-flops, registers) are synchronized to a common clock signal. This simplifies timing analysis and ensures reliable data transfer.";
}
else if (lowerCommand.includes('what is an asynchronous design') || lowerCommand.includes('asynchronous design')) {
    responseText = "Asynchronous design in digital circuits means that the circuit operation is not governed by a global clock signal. Instead, components communicate using handshaking signals, which can offer advantages in power consumption and design flexibility but are more complex to design and verify.";
}
else if (lowerCommand.includes('what is a CPLD') || lowerCommand.includes('Complex Programmable Logic Device')) {
    responseText = "A CPLD (Complex Programmable Logic Device) is a type of programmable logic device that is more complex than a PAL but less complex than an FPGA. It consists of multiple SPLD (Simple Programmable Logic Device) blocks interconnected by a programmable switch matrix.";
}
else if (lowerCommand.includes('what is a systolic array') || lowerCommand.includes('systolic array')) {
    responseText = "A systolic array is a specialized type of parallel processing architecture consisting of a network of interconnected processing units (cells) that rhythmically process and pass data. It's often used for specific tasks like matrix multiplication in high-performance computing and DSP.";
}
else if (lowerCommand.includes('what is bit banging') || lowerCommand.includes('bit banging')) {
    responseText = "Bit banging is a technique for serial communication where software directly controls the states of general-purpose input/output (GPIO) pins to implement a serial communication protocol (like I2C, SPI, UART) without specialized hardware peripherals. It's flexible but CPU-intensive.";
}
else if (lowerCommand.includes('what is a logic family') || lowerCommand.includes('logic family')) {
    responseText = "A logic family is a group of electronic logic gates that share common electrical characteristics such as voltage levels, noise margins, power dissipation, and propagation delay. Examples include TTL, CMOS, ECL, and DTL.";
}
else if (lowerCommand.includes('what is noise margin') || lowerCommand.includes('noise margin digital')) {
    responseText = "Noise margin in digital circuits is the amount of noise voltage that an input can withstand without causing a spurious change in the output. A larger noise margin indicates better immunity to electrical noise.";
}
else if (lowerCommand.includes('what is propagation delay') || lowerCommand.includes('propagation delay digital')) {
    responseText = "Propagation delay is the time required for a signal to travel from the input of a logic gate or circuit to its output. It's a critical parameter for determining the maximum operating frequency of a digital system.";
}
else if (lowerCommand.includes('what is fan-in and fan-out') || lowerCommand.includes('fan-in fan-out')) {
    responseText = "Fan-in refers to the maximum number of inputs a logic gate can accept. Fan-out refers to the maximum number of standard loads that the output of a logic gate can drive while maintaining its specified output voltage levels.";
}
else if (lowerCommand.includes('what is an adder circuit') || lowerCommand.includes('binary adder')) {
    responseText = "An adder circuit is a digital circuit that performs addition of numbers. A half-adder adds two single binary digits, and a full-adder adds three single binary digits (two input bits and a carry-in bit).";
}
else if (lowerCommand.includes('what is a subtractor circuit') || lowerCommand.includes('binary subtractor')) {
    responseText = "A subtractor circuit is a digital circuit that performs subtraction of binary numbers. It can be implemented using full-adders and inverters by using the two's complement method for subtraction.";
}

// --- Electronic Circuits and Network Analysis (Advanced) ---
else if (lowerCommand.includes('what are Kirchhoff\'s Laws') || lowerCommand.includes('Kirchhoff\'s Laws') || lowerCommand.includes('KCL') || lowerCommand.includes('KVL')) {
    responseText = "Kirchhoff's Laws are two fundamental laws for circuit analysis. Kirchhoff's Current Law (KCL) states that the algebraic sum of currents entering a node (or a junction) is zero. Kirchhoff's Voltage Law (KVL) states that the algebraic sum of voltages around any closed loop in a circuit is zero.";
}
else if (lowerCommand.includes('what is Thevenin\'s Theorem') || lowerCommand.includes('Thevenin\'s Theorem') || lowerCommand.includes('thevenin')) {
    responseText = "Thevenin's Theorem states that any linear electrical network containing only voltage sources, current sources, and resistors can be replaced by an equivalent circuit consisting of a single voltage source (Vth) in series with a single resistor (Rth).";
}
else if (lowerCommand.includes('what is Norton\'s Theorem') || lowerCommand.includes('Norton\'s Theorem') || lowerCommand.includes('norton')) {
    responseText = "Norton's Theorem states that any linear electrical network can be replaced by an equivalent circuit consisting of a single current source (In) in parallel with a single resistor (Rn).";
}
else if (lowerCommand.includes('what is superposition theorem') || lowerCommand.includes('superposition')) {
    responseText = "The Superposition Theorem states that in any linear circuit with multiple independent sources, the total current or voltage for any element is the algebraic sum of the currents or voltages produced by each source acting alone, with all other independent sources turned off (voltage sources shorted, current sources opened).";
}
else if (lowerCommand.includes('what is maximum power transfer theorem') || lowerCommand.includes('maximum power transfer')) {
    responseText = "The Maximum Power Transfer Theorem states that to obtain maximum external power from a source with a finite internal resistance, the resistance of the load must be equal to the resistance of the source as viewed from its output terminals.";
}
else if (lowerCommand.includes('what is impedance') || lowerCommand.includes('define impedance')) {
    responseText = "Impedance is the measure of the opposition that a circuit presents to a current when a voltage is applied. In AC circuits, impedance is a more general concept than resistance, as it includes both resistance and reactance. It's represented by a complex number.";
}
else if (lowerCommand.includes('what is reactance') || lowerCommand.includes('define reactance')) {
    responseText = "Reactance is the opposition to the change of current or voltage in an electrical circuit due to inductance or capacitance. It is a component of impedance and is frequency-dependent. Inductive reactance ($X_L$) increases with frequency, while capacitive reactance ($X_C$) decreases with frequency.";
}
else if (lowerCommand.includes('what is admittance') || lowerCommand.includes('define admittance')) {
    responseText = "Admittance is a measure of how easily a circuit or device allows current to flow. It is the reciprocal of impedance, and in AC circuits, it's represented by a complex number. Its real part is conductance, and its imaginary part is susceptance.";
}
else if (lowerCommand.includes('what is resonance') || lowerCommand.includes('resonant frequency')) {
    responseText = "Resonance in an electrical circuit occurs when the impedance of the circuit is purely resistive, meaning the inductive and capacitive reactances cancel each other out. This typically happens at a specific resonant frequency, leading to maximum current or voltage response.";
}
else if (lowerCommand.includes('what is a low-pass filter') || lowerCommand.includes('low pass filter')) {
    responseText = "A low-pass filter is an electronic filter that passes signals with a frequency lower than a certain cutoff frequency and attenuates signals with frequencies higher than the cutoff frequency. It smooths out rapidly changing signals.";
}
else if (lowerCommand.includes('what is a high-pass filter') || lowerCommand.includes('high pass filter')) {
    responseText = "A high-pass filter is an electronic filter that passes signals with a frequency higher than a certain cutoff frequency and attenuates signals with frequencies lower than the cutoff frequency. It blocks DC components and low-frequency noise.";
}
else if (lowerCommand.includes('what is a band-pass filter') || lowerCommand.includes('band pass filter')) {
    responseText = "A band-pass filter is an electronic filter that passes signals within a certain frequency range (a 'band') and attenuates signals outside that range. It's used to isolate a specific frequency or range of frequencies.";
}
else if (lowerCommand.includes('what is a band-stop filter') || lowerCommand.includes('band stop filter') || lowerCommand.includes('notch filter')) {
    responseText = "A band-stop filter, also known as a band-rejection filter or notch filter, is an electronic filter that attenuates signals within a certain frequency range and passes signals outside that range. It's often used to remove unwanted specific frequencies, like 60Hz hum.";
}
else if (lowerCommand.includes('what is a transfer function') || lowerCommand.includes('transfer function electronics')) {
    responseText = "In electronics and control theory, a transfer function is a mathematical representation of the relationship between the output and input of a linear, time-invariant system. It's typically expressed in the Laplace domain.";
}
else if (lowerCommand.includes('what is a bode plot') || lowerCommand.includes('bode plot')) {
    responseText = "A Bode plot is a graph of the frequency response of a system. It typically consists of two plots: one for the magnitude (in decibels) and one for the phase shift (in degrees) of the transfer function, plotted against frequency.";
}
else if (lowerCommand.includes('what is the s-plane') || lowerCommand.includes('s plane') || lowerCommand.includes('laplace transform')) {
    responseText = "The s-plane is a complex plane where the horizontal axis represents the real part (sigma) and the vertical axis represents the imaginary part (omega) of the complex variable 's' used in the Laplace transform. It's a fundamental tool for analyzing linear time-invariant systems.";
}
else if (lowerCommand.includes('what is transient response') || lowerCommand.includes('transient response circuit')) {
    responseText = "The transient response of a circuit describes its behavior as it changes from one steady state to another, typically immediately after a switch is opened or closed, or a sudden change in input occurs. It's temporary and eventually settles to a steady state.";
}
else if (lowerCommand.includes('what is steady-state response') || lowerCommand.includes('steady state response circuit')) {
    responseText = "The steady-state response of a circuit is the behavior of the circuit after all transient effects have died out. For DC circuits, this is a constant value; for AC circuits, it's a sinusoidal response at the input frequency.";
}
else if (lowerCommand.includes('what is quality factor') || lowerCommand.includes('Q factor')) {
    responseText = "The Quality Factor (Q factor) is a dimensionless parameter that describes how underdamped an oscillator or resonator is. In resonant circuits, a higher Q factor indicates lower energy loss and a narrower bandwidth.";
}
else if (lowerCommand.includes('what is a filter order') || lowerCommand.includes('filter order')) {
    responseText = "The order of a filter refers to the number of reactive components (capacitors and inductors) in its passive implementation, or the highest power of 's' in the denominator of its transfer function for active filters. Higher order filters generally have steeper roll-offs.";
}
else if (lowerCommand.includes('what is damping factor') || lowerCommand.includes('damping ratio')) {
    responseText = "The damping factor (or damping ratio, $\zeta$) is a dimensionless measure describing how oscillations in a system decay after a disturbance. A critically damped system ($\zeta=1$) returns to equilibrium as quickly as possible without oscillating.";
}
else if (lowerCommand.includes('what is phase margin') || lowerCommand.includes('phase margin')) {
    responseText = "Phase margin is a measure of the stability of a feedback control system. It is the amount of additional phase lag that can be added to the system at the gain crossover frequency before it becomes unstable.";
}
else if (lowerCommand.includes('what is gain margin') || lowerCommand.includes('gain margin')) {
    responseText = "Gain margin is a measure of the stability of a feedback control system. It is the amount of gain (in dB) that can be added to the system at the phase crossover frequency before it becomes unstable.";
}
else if (lowerCommand.includes('what is an equivalent circuit') || lowerCommand.includes('equivalent circuit')) {
    responseText = "An equivalent circuit is a simplified circuit that behaves identically to a more complex circuit, at least with respect to its terminals. Thevenin and Norton equivalent circuits are common examples used to simplify analysis.";
}
else if (lowerCommand.includes('what is mesh analysis') || lowerCommand.includes('mesh analysis')) {
    responseText = "Mesh analysis is a circuit analysis technique used to solve for unknown currents in a circuit. It applies Kirchhoff's Voltage Law (KVL) to each closed loop (mesh) in the circuit, resulting in a set of simultaneous equations.";
}
else if (lowerCommand.includes('what is nodal analysis') || lowerCommand.includes('nodal analysis')) {
    responseText = "Nodal analysis is a circuit analysis technique used to solve for unknown node voltages in a circuit. It applies Kirchhoff's Current Law (KCL) to each non-reference node, resulting in a set of simultaneous equations.";
}
else if (lowerCommand.includes('what are phasors') || lowerCommand.includes('phasor diagram')) {
    responseText = "Phasors are complex numbers that represent sinusoidal waveforms in AC circuit analysis. They simplify the representation and analysis of AC circuits by converting time-domain sine waves into frequency-domain vectors.";
}
else if (lowerCommand.includes('what is complex power') || lowerCommand.includes('complex power')) {
    responseText = "Complex power (S) in an AC circuit is the sum of real power (P, in Watts) and reactive power (Q, in VARs). It's a complex number where the real part is real power and the imaginary part is reactive power. It's used to analyze power flow in AC systems.";
}
else if (lowerCommand.includes('what is power factor correction') || lowerCommand.includes('power factor correction')) {
    responseText = "Power factor correction is the technique of improving the power factor of an AC electrical power system. This is typically achieved by adding capacitors to the circuit to compensate for the reactive power caused by inductive loads, reducing energy waste.";
}
else if (lowerCommand.includes('what is a linear circuit') || lowerCommand.includes('linear circuit')) {
    responseText = "A linear circuit is an electrical circuit whose output is directly proportional to its input. It obeys the principles of superposition and homogeneity (scaling), meaning that its behavior can be described by linear differential equations.";
}
else if (lowerCommand.includes('what is a nonlinear circuit') || lowerCommand.includes('nonlinear circuit')) {
    responseText = "A nonlinear circuit is an electrical circuit that contains at least one nonlinear component (e.g., diodes, transistors in certain operating regions) whose output is not directly proportional to its input. These circuits do not obey superposition and are harder to analyze.";
}
else if (lowerCommand.includes('what is a source transformation') || lowerCommand.includes('source transformation')) {
    responseText = "Source transformation is a technique used in circuit analysis to simplify linear circuits by converting a voltage source in series with a resistor into an equivalent current source in parallel with the same resistor, and vice-versa.";
}
else if (lowerCommand.includes('what is delta-wye transformation') || lowerCommand.includes('delta wye transformation')) {
    responseText = "Delta-Wye (or Pi-Tee) transformation is a circuit analysis technique used to simplify three-terminal resistive networks. It converts a delta-connected configuration of resistors into an equivalent wye-connected configuration, and vice versa, often simplifying complex resistor networks.";
}
else if (lowerCommand.includes('what is a mutual inductance') || lowerCommand.includes('mutual inductance')) {
    responseText = "Mutual inductance occurs when a changing current in one coil induces a voltage in a nearby second coil. This phenomenon is fundamental to transformers and other coupled inductive circuits.";
}
else if (lowerCommand.includes('what is a coupling coefficient') || lowerCommand.includes('coupling coefficient')) {
    responseText = "The coupling coefficient (k) in mutually inductive circuits quantifies how tightly two coils are magnetically coupled. It ranges from 0 (no coupling) to 1 (perfect coupling).";
}
else if (lowerCommand.includes('what is a differential equation circuit') || lowerCommand.includes('circuit differential equation')) {
    responseText = "In circuit analysis, differential equations are used to describe the transient behavior of circuits containing energy storage elements (capacitors and inductors). Solving these equations yields the voltage and current as functions of time.";
}
else if (lowerCommand.includes('what is a pole in circuit analysis') || lowerCommand.includes('circuit pole')) {
    responseText = "In circuit analysis, a pole in a transfer function corresponds to a frequency at which the system's gain approaches infinity. Poles are critical for determining the stability and frequency response characteristics of a circuit.";
}
else if (lowerCommand.includes('what is a zero in circuit analysis') || lowerCommand.includes('circuit zero')) {
    responseText = "In circuit analysis, a zero in a transfer function corresponds to a frequency at which the system's gain drops to zero. Zeros can be used to shape the frequency response of a circuit, such as creating a notch in a filter.";
}
else if (lowerCommand.includes('what is a two-port network') || lowerCommand.includes('two port network')) {
    responseText = "A two-port network is an electrical circuit or device that has two pairs of terminals connected to external circuits. It's analyzed using parameters like Z-parameters, Y-parameters, and H-parameters to describe its input-output relationship.";
}
else if (lowerCommand.includes('what is an ideal transformer') || lowerCommand.includes('ideal transformer')) {
    responseText = "An ideal transformer is a theoretical transformer with no energy losses, perfect magnetic coupling, and infinite core permeability. It's used for simplified analysis of transformer behavior, assuming ideal voltage and current ratios.";
}
else if (lowerCommand.includes('what is RMS value') || lowerCommand.includes('Root Mean Square value')) {
    responseText = "The RMS (Root Mean Square) value of an AC waveform is equivalent to the DC voltage or current that would produce the same amount of heat in a resistive load. It's a way to quantify the 'effective' value of an AC signal.";
}
else if (lowerCommand.includes('what is peak value') || lowerCommand.includes('peak voltage current')) {
    responseText = "The peak value (or amplitude) of an AC waveform is the maximum instantaneous value that the voltage or current reaches during a cycle. It's a fundamental characteristic of sinusoidal signals.";
}
else if (lowerCommand.includes('what is peak-to-peak value') || lowerCommand.includes('peak to peak voltage current')) {
    responseText = "The peak-to-peak value of an AC waveform is the total difference between the maximum positive peak and the maximum negative peak of the signal. It's twice the peak value for a symmetrical waveform.";
}
else if (lowerCommand.includes('what is an integrator circuit') || lowerCommand.includes('integrator op-amp')) {
    responseText = "An integrator circuit is an electronic circuit that produces an output voltage proportional to the time integral of its input voltage. It's commonly implemented using an op-amp with a capacitor in its feedback path.";
}
else if (lowerCommand.includes('what is a differentiator circuit') || lowerCommand.includes('differentiator op-amp')) {
    responseText = "A differentiator circuit is an electronic circuit that produces an output voltage proportional to the time derivative of its input voltage. It's commonly implemented using an op-amp with a capacitor in its input path.";
}

// --- Analog Electronics (Expanded) ---
else if (lowerCommand.includes('what is an operational amplifier') || lowerCommand.includes('op-amp')) {
    responseText = "An operational amplifier (op-amp) is a DC-coupled high-gain electronic voltage amplifier with a differential input and, usually, a single-ended output. It's a versatile building block for many analog circuits, used for amplification, filtering, summing, and more.";
}
else if (lowerCommand.includes('what is negative feedback') || lowerCommand.includes('negative feedback op-amp')) {
    responseText = "Negative feedback is a method of controlling a system by feeding a portion of its output back into its input in an opposing phase. In op-amps, it stabilizes gain, reduces distortion, and improves bandwidth.";
}
else if (lowerCommand.includes('what is positive feedback') || lowerCommand.includes('positive feedback op-amp')) {
    responseText = "Positive feedback is a process in which a portion of the output signal is fed back to the input in phase with the input signal. Unlike negative feedback, it tends to increase gain, making it useful in oscillators and regenerative circuits, but can also lead to instability.";
}
else if (lowerCommand.includes('what is a voltage regulator') || lowerCommand.includes('voltage regulator')) {
    responseText = "A voltage regulator is an electronic circuit that maintains a constant output voltage regardless of changes in the input voltage or load current. They are essential for providing stable power to sensitive electronic components.";
}
else if (lowerCommand.includes('what is a rectifier') || lowerCommand.includes('rectifier circuit')) {
    responseText = "A rectifier is an electrical device that converts alternating current (AC) to direct current (DC). It typically uses diodes to allow current flow in only one direction. Common types include half-wave and full-wave rectifiers.";
}
else if (lowerCommand.includes('what is an oscillator') || lowerCommand.includes('oscillator circuit')) {
    responseText = "An oscillator is an electronic circuit that produces a repetitive, oscillating electronic signal, often a sine wave or a square wave. They are fundamental in clock generation, radio transmitters, and signal generators.";
}
else if (lowerCommand.includes('what is common-emitter configuration') || lowerCommand.includes('common emitter')) {
    responseText = "The common-emitter configuration is a type of BJT amplifier where the emitter terminal is common to both the input and output. It provides both voltage and current gain and is widely used for amplification.";
}
else if (lowerCommand.includes('what is common-collector configuration') || lowerCommand.includes('common collector') || lowerCommand.includes('emitter follower')) {
    responseText = "The common-collector configuration, also known as an emitter follower, is a type of BJT amplifier where the collector terminal is common. It provides high current gain and voltage buffering, useful for impedance matching.";
}
else if (lowerCommand.includes('what is common-base configuration') || lowerCommand.includes('common base')) {
    responseText = "The common-base configuration is a type of BJT amplifier where the base terminal is common. It provides good voltage gain but no current gain, primarily used in high-frequency applications.";
}
else if (lowerCommand.includes('what is an inverter op-amp') || lowerCommand.includes('inverting amplifier')) {
    responseText = "An inverting amplifier is an op-amp configuration where the output signal is out of phase by 180 degrees with respect to the input signal, and its gain is determined by the ratio of two resistors.";
}
else if (lowerCommand.includes('what is a non-inverting amplifier') || lowerCommand.includes('non inverting amplifier')) {
    responseText = "A non-inverting amplifier is an op-amp configuration where the output signal is in phase with the input signal, and its gain is determined by the ratio of two resistors plus one.";
}
else if (lowerCommand.includes('what is a voltage follower') || lowerCommand.includes('unity gain buffer')) {
    responseText = "A voltage follower, or unity gain buffer, is an op-amp configuration that provides a gain of 1. Its primary use is for impedance matching, preventing a source from being loaded by a low-impedance load.";
}
else if (lowerCommand.includes('what is an instrumentation amplifier') || lowerCommand.includes('instrumentation amplifier')) {
    responseText = "An instrumentation amplifier is a type of differential amplifier that is highly precise and stable, commonly used for amplifying very small differential signals in noisy environments. It typically has high input impedance and high common-mode rejection ratio.";
}
else if (lowerCommand.includes('what is a comparator') || lowerCommand.includes('comparator circuit')) {
    responseText = "A comparator is an electronic circuit that compares two input voltages or currents and outputs a digital signal indicating which is larger. It's often implemented using an op-amp in an open-loop configuration.";
}
else if (lowerCommand.includes('what is hysteresis') || lowerCommand.includes('hysteresis electronic')) {
    responseText = "Hysteresis in electronics refers to the dependence of a system's output on its past inputs as well as its present input. In circuits like Schmitt triggers, it prevents rapid, unwanted switching due to noise around the threshold.";
}
else if (lowerCommand.includes('what is a voltage controlled oscillator') || lowerCommand.includes('VCO')) {
    responseText = "A VCO (Voltage Controlled Oscillator) is an electronic oscillator whose oscillation frequency is controlled by a voltage input. The applied input voltage determines the instantaneous oscillation frequency.";
}
else if (lowerCommand.includes('what is a phase-locked loop') || lowerCommand.includes('PLL')) {
    responseText = "A PLL (Phase-Locked Loop) is a control system that generates an output signal whose phase is related to the phase of an input 'reference' signal. It's used for frequency synthesis, demodulation, and clock recovery in communication systems.";
}
else if (lowerCommand.includes('what is total harmonic distortion') || lowerCommand.includes('THD')) {
    responseText = "THD (Total Harmonic Distortion) is a measurement of the harmonic distortion present in a signal. It's defined as the ratio of the sum of the powers of all harmonic components to the power of the fundamental frequency, indicating signal purity.";
}
else if (lowerCommand.includes('what is slew rate') || lowerCommand.includes('op-amp slew rate')) {
    responseText = "Slew rate is the maximum rate of change of output voltage per unit of time, typically measured in volts per microsecond (V/μs). It limits the speed at which an op-amp's output can change, affecting its performance at higher frequencies.";
}
else if (lowerCommand.includes('what is offset voltage') || lowerCommand.includes('op-amp offset voltage')) {
    responseText = "Input offset voltage is the differential DC voltage required between the two input terminals of an op-amp to make the output zero. It's an imperfection that can cause a small DC voltage at the output even with zero input.";
}
else if (lowerCommand.includes('what is a differential amplifier') || lowerCommand.includes('differential amplifier')) {
    responseText = "A differential amplifier is a type of electronic amplifier that amplifies the difference between two input signals while rejecting any common-mode signals. It's a fundamental building block for op-amps and instrumentation amplifiers.";
}
else if (lowerCommand.includes('what is a power amplifier') || lowerCommand.includes('power amplifier')) {
    responseText = "A power amplifier is an electronic amplifier that amplifies low-power electronic audio or radio signals to a level strong enough for driving loudspeakers, radio transmitters, or other output devices. Its main goal is to deliver significant power to a load.";
}
else if (lowerCommand.includes('what is a preamplifier') || lowerCommand.includes('preamp')) {
    responseText = "A preamplifier (preamp) is an electronic amplifier that converts a weak electrical signal into an output signal strong enough to be noise-tolerant and transmitted to a main amplifier or further processing. It's typically used to boost signals from sensors or microphones.";
}
else if (lowerCommand.includes('what is a filter type') || lowerCommand.includes('active filter')) {
    responseText = "An active filter is a type of electronic filter that uses active components like op-amps or transistors in addition to passive components (resistors, capacitors). Active filters can achieve higher gain, steeper roll-offs, and do not require inductors, making them more suitable for low-frequency applications.";
}
else if (lowerCommand.includes('what is a passive filter') || lowerCommand.includes('passive filter')) {
    responseText = "A passive filter is a type of electronic filter that is composed only of passive components such as resistors, capacitors, and inductors. They are generally simpler and less expensive than active filters but offer less flexibility in terms of gain and Q factor.";
}
else if (lowerCommand.includes('what is a Butterworth filter') || lowerCommand.includes('Butterworth filter')) {
    responseText = "A Butterworth filter is a type of signal processing filter designed to have a frequency response that is as flat as possible in the passband. It's known for its maximally flat magnitude response, without ripples in the passband or stopband.";
}
else if (lowerCommand.includes('what is a Chebyshev filter') || lowerCommand.includes('Chebyshev filter')) {
    responseText = "A Chebyshev filter is a type of electronic filter that has a steeper roll-off and more ripple in the passband (Type I) or stopband (Type II) than a Butterworth filter. It achieves a faster transition from passband to stopband at the expense of ripple.";
}
else if (lowerCommand.includes('what is a Sallen-Key filter') || lowerCommand.includes('Sallen-Key filter')) {
    responseText = "A Sallen-Key filter is a simple active filter topology known for its ease of design and good performance. It uses one operational amplifier (op-amp) and two resistors and two capacitors to create a second-order filter section (low-pass or high-pass).";
}
else if (lowerCommand.includes('what is a multiple feedback filter') || lowerCommand.includes('multiple feedback filter')) {
    responseText = "A multiple feedback (MFB) filter is an active filter topology that also uses an op-amp, but with a different feedback arrangement compared to Sallen-Key. MFB filters are often preferred for higher Q values and can implement various filter types.";
}
else if (lowerCommand.includes('what is a voltage reference') || lowerCommand.includes('voltage reference')) {
    responseText = "A voltage reference is an electronic circuit that produces a constant output voltage regardless of variations in temperature, power supply voltage, or load current. They are critical for the accuracy of ADCs, DACs, and other precision analog circuits.";
}
else if (lowerCommand.includes('what is a transimpedance amplifier') || lowerCommand.includes('TIA')) {
    responseText = "A transimpedance amplifier (TIA) is a current-to-voltage converter, commonly implemented with an op-amp. It converts a very small input current (from a photodiode, for example) into a usable output voltage.";
}
else if (lowerCommand.includes('what is a voltage feedback amplifier') || lowerCommand.includes('VFA')) {
    responseText = "A voltage feedback amplifier (VFA) is the most common type of op-amp. It measures the output voltage and feeds back a proportional current to the input. VFAs are versatile and widely used for general-purpose amplification.";
}
else if (lowerCommand.includes('what is a current feedback amplifier') || lowerCommand.includes('CFA')) {
    responseText = "A current feedback amplifier (CFA) is a type of op-amp that differs from a voltage feedback amplifier in its input stage. CFAs offer higher slew rates and wider bandwidths, particularly useful in high-speed applications.";
}
else if (lowerCommand.includes('what is a mixer circuit') || lowerCommand.includes('frequency mixer')) {
    responseText = "A mixer circuit is an electronic circuit that combines two or more input signals to produce new output signals at different frequencies. In radio, it's used to convert an RF signal to an IF signal (down-conversion) or vice-versa (up-conversion).";
}
else if (lowerCommand.includes('what is an AM detector') || lowerCommand.includes('AM demodulator')) {
    responseText = "An AM detector (or AM demodulator) is a circuit that extracts the original modulating information signal from an amplitude-modulated (AM) carrier wave. Simple diode detectors are common examples.";
}
else if (lowerCommand.includes('what is an FM detector') || lowerCommand.includes('FM demodulator')) {
    responseText = "An FM detector (or FM demodulator) is a circuit that extracts the original modulating information signal from a frequency-modulated (FM) carrier wave. Examples include discriminator circuits and phase-locked loop (PLL) detectors.";
}
else if (lowerCommand.includes('what is a crystal oscillator') || lowerCommand.includes('crystal oscillator')) {
    responseText = "A crystal oscillator is an electronic oscillator circuit that uses the mechanical resonance of a vibrating crystal of piezoelectric material to create an electrical signal with a very precise frequency. They are crucial for stable timing in digital and communication systems.";
}
else if (lowerCommand.includes('what is a Hartley oscillator') || lowerCommand.includes('Hartley oscillator')) {
    responseText = "A Hartley oscillator is an electronic oscillator circuit characterized by a tuned circuit consisting of a tapped inductor (or two inductors in series) in parallel with a capacitor. It's used to generate sinusoidal oscillations at radio frequencies.";
}
else if (lowerCommand.includes('what is a Colpitts oscillator') || lowerCommand.includes('Colpitts oscillator')) {
    responseText = "A Colpitts oscillator is an electronic oscillator circuit that uses a voltage divider made of two capacitors in series across the inductor in the tuned circuit. It's also used to generate sinusoidal oscillations at radio frequencies.";
}
else if (lowerCommand.includes('what is a Wien Bridge oscillator') || lowerCommand.includes('Wien Bridge oscillator')) {
    responseText = "A Wien Bridge oscillator is a type of electronic oscillator that generates sine waves. It uses a bridge circuit to provide positive feedback for oscillation and negative feedback for amplitude stabilization, often implemented with an op-amp.";
}
else if (lowerCommand.includes('what is a class A amplifier') || lowerCommand.includes('class A amplifier')) {
    responseText = "A Class A amplifier is a power amplifier where the active device (transistor) conducts for the entire 360 degrees of the input signal cycle. It offers high linearity and low distortion but has very low power efficiency.";
}
else if (lowerCommand.includes('what is a class B amplifier') || lowerCommand.includes('class B amplifier')) {
    responseText = "A Class B amplifier is a power amplifier where each active device conducts for only half (180 degrees) of the input signal cycle. It's more efficient than Class A but suffers from crossover distortion.";
}
else if (lowerCommand.includes('what is a class AB amplifier') || lowerCommand.includes('class AB amplifier')) {
    responseText = "A Class AB amplifier is a power amplifier that combines aspects of Class A and Class B amplifiers. Each active device conducts for slightly more than half of the input cycle, providing higher efficiency than Class A and reducing crossover distortion compared to Class B.";
}
else if (lowerCommand.includes('what is a class D amplifier') || lowerCommand.includes('class D amplifier')) {
    responseText = "A Class D amplifier is a switching power amplifier that uses pulse-width modulation (PWM) to convert the analog input signal into a series of square pulses. It achieves very high power efficiency, making it popular in portable audio devices.";
}
else if (lowerCommand.includes('what is common-mode rejection ratio') || lowerCommand.includes('CMRR')) {
    responseText = "CMRR (Common-Mode Rejection Ratio) is a measure of the ability of a differential amplifier to reject common-mode signals (signals common to both inputs) while amplifying differential signals. A high CMRR is desirable for precision measurements.";
}
else if (lowerCommand.includes('what is a current mirror') || lowerCommand.includes('current mirror')) {
    responseText = "A current mirror is a circuit designed to copy a current flowing through one active device by controlling the current in another active device, maintaining the output current constant regardless of loading. It's a fundamental building block in analog IC design.";
}

// --- Semiconductor Devices (Detailed) ---
else if (lowerCommand.includes('what is a PN junction') || lowerCommand.includes('PN junction diode')) {
    responseText = "A PN junction is the boundary or interface between two types of semiconductor materials, p-type and n-type, inside a single crystal of semiconductor. It forms the basis of all semiconductor devices like diodes, transistors, and solar cells.";
}
else if (lowerCommand.includes('what is doping') || lowerCommand.includes('semiconductor doping')) {
    responseText = "Doping is the process of intentionally introducing impurities into an intrinsic semiconductor for the purpose of modulating its electrical properties, such as its electron and hole concentrations. This creates p-type or n-type semiconductors.";
}
else if (lowerCommand.includes('what is a Zener diode') || lowerCommand.includes('zener diode')) {
    responseText = "A Zener diode is a special type of diode designed to reliably allow current to flow in the reverse direction when a certain reverse voltage, known as the Zener voltage, is reached. It's primarily used for voltage regulation.";
}
else if (lowerCommand.includes('what is a Schottky diode') || lowerCommand.includes('schottky diode')) {
    responseText = "A Schottky diode is a semiconductor diode with a very low forward voltage drop and a very fast switching action. It's formed by a metal-semiconductor junction, rather than a p-n junction, making it useful in high-speed switching and RF applications.";
}
else if (lowerCommand.includes('what is a BJT') || lowerCommand.includes('Bipolar Junction Transistor')) {
    responseText = "A BJT (Bipolar Junction Transistor) is a type of transistor that uses both electron and hole charge carriers. It's a current-controlled device and comes in NPN and PNP types, used for amplification and switching.";
}
else if (lowerCommand.includes('what is an FET') || lowerCommand.includes('Field-Effect Transistor')) {
    responseText = "An FET (Field-Effect Transistor) is a type of transistor that uses an electric field to control the flow of current. Unlike BJTs, FETs are voltage-controlled devices and have high input impedance, coming in JFET and MOSFET variations.";
}
else if (lowerCommand.includes('what is a MOSFET') || lowerCommand.includes('MOSFET transistor')) {
    responseText = "A MOSFET (Metal-Oxide-Semiconductor Field-Effect Transistor) is the most common type of FET. It's a voltage-controlled device known for high input impedance and is crucial in digital circuits, power electronics, and integrated circuits due to its scalability and low power consumption.";
}
else if (lowerCommand.includes('what is an SCR') || lowerCommand.includes('Silicon Controlled Rectifier')) {
    responseText = "An SCR (Silicon Controlled Rectifier) is a four-layer solid-state device that controls current flow. It acts as a switch, remaining off until a small current is applied to its gate terminal, after which it conducts heavily until the main current is interrupted.";
}
else if (lowerCommand.includes('what is a TRIAC') || lowerCommand.includes('triac')) {
    responseText = "A TRIAC (Triode for Alternating Current) is a three-terminal electronic component that conducts current in either direction when triggered by a gate signal. It's commonly used in AC power control applications like light dimmers and motor speed controls.";
}
else if (lowerCommand.includes('what is a DIAC') || lowerCommand.includes('diac')) {
    responseText = "A DIAC (Diode for Alternating Current) is a two-terminal, three-layer semiconductor device that conducts electrical current only after its breakdown voltage has been reached. It's often used to trigger TRIACs.";
}
else if (lowerCommand.includes('what is an IGBT') || lowerCommand.includes('Insulated Gate Bipolar Transistor')) {
    responseText = "An IGBT (Insulated Gate Bipolar Transistor) is a three-terminal power semiconductor device primarily used as an electronic switch. It combines the high input impedance of a MOSFET with the low on-state voltage drop and high current handling capability of a BJT.";
}
else if (lowerCommand.includes('what is a photodiode') || lowerCommand.includes('photodiode')) {
    responseText = "A photodiode is a semiconductor device that converts light into an electrical current. When light strikes the photodiode, it creates electron-hole pairs, generating a current proportional to the light intensity.";
}
else if (lowerCommand.includes('what is a phototransistor') || lowerCommand.includes('phototransistor')) {
    responseText = "A phototransistor is a light-sensitive transistor, similar to a photodiode but with internal gain. When light strikes its base junction, it generates a much larger output current compared to a photodiode, making it more sensitive to light.";
}
else if (lowerCommand.includes('what is a thermistor') || lowerCommand.includes('thermistor')) {
    responseText = "A thermistor is a type of resistor whose resistance is strongly dependent on temperature. It's widely used as a temperature sensor, with its resistance typically decreasing significantly as temperature increases (NTC thermistor).";
}
else if (lowerCommand.includes('what is an LDR') || lowerCommand.includes('Light Dependent Resistor')) {
    responseText = "An LDR (Light Dependent Resistor), also known as a photoresistor, is a passive component whose resistance decreases with increasing incident light intensity. It's often used in light-sensing applications.";
}
else if (lowerCommand.includes('what is a varactor diode') || lowerCommand.includes('varicap diode')) {
    responseText = "A varactor diode (or varicap diode) is a type of diode whose capacitance varies with the reverse voltage applied across its terminals. This property makes them useful in voltage-controlled oscillators, frequency multipliers, and tunable filters.";
}
else if (lowerCommand.includes('what is an optocoupler') || lowerCommand.includes('optocoupler') || lowerCommand.includes('opt-isolator')) {
    responseText = "An optocoupler (or opto-isolator) is an electronic component that transfers electrical signals between two isolated circuits by using light. It prevents high voltages or rapid voltage transients in one part of a system from affecting the other, providing electrical isolation.";
}
else if (lowerCommand.includes('what is a laser diode') || lowerCommand.includes('laser diode')) {
    responseText = "A laser diode is a semiconductor device that emits coherent light through a process called stimulated emission. It's similar to an LED but produces a highly directional, monochromatic, and coherent light beam, used in fiber optics, barcode scanners, and laser pointers.";
}
else if (lowerCommand.includes('what is an LED type') || lowerCommand.includes('OLED') || lowerCommand.includes('organic light emitting diode')) {
    responseText = "An OLED (Organic Light-Emitting Diode) is a type of LED that uses an organic compound as the electroluminescent material. OLED displays are known for their high contrast, deep blacks, wide viewing angles, and faster response times compared to traditional LCDs.";
}
else if (lowerCommand.includes('what is a unijunction transistor') || lowerCommand.includes('UJT')) {
    responseText = "A UJT (Unijunction Transistor) is a three-terminal semiconductor device that has only one PN junction. It's primarily used as an electronically controlled switch or for triggering other devices like SCRs and TRIACs in timing and oscillator circuits.";
}
else if (lowerCommand.includes('what is a programmable unijunction transistor') || lowerCommand.includes('PUT')) {
    responseText = "A PUT (Programmable Unijunction Transistor) is a type of thyristor that acts like a UJT but its firing voltage can be set by an external voltage divider. It's useful in precision timer circuits and oscillators.";
}
else if (lowerCommand.includes('what is IC packaging') || lowerCommand.includes('integrated circuit packaging')) {
    responseText = "IC packaging refers to the housing or enclosure for an integrated circuit (IC) chip. It protects the chip from physical damage and corrosion, and provides electrical connections for power and signals. Common packages include DIP, SOP, QFN, and BGA.";
}
else if (lowerCommand.includes('what is an intrinsic semiconductor') || lowerCommand.includes('intrinsic semiconductor')) {
    responseText = "An intrinsic semiconductor is a pure semiconductor material with no impurities, where the number of free electrons is equal to the number of holes. Its conductivity is low and primarily dependent on temperature.";
}
else if (lowerCommand.includes('what is an extrinsic semiconductor') || lowerCommand.includes('extrinsic semiconductor')) {
    responseText = "An extrinsic semiconductor is a semiconductor material that has been doped with impurities to increase its conductivity. It can be either N-type (doped with donor impurities, increasing electrons) or P-type (doped with acceptor impurities, increasing holes).";
}
else if (lowerCommand.includes('what is a p-type semiconductor') || lowerCommand.includes('p-type semiconductor')) {
    responseText = "A p-type semiconductor is created by doping an intrinsic semiconductor with acceptor impurities (e.g., Boron in Silicon). These impurities create 'holes' which act as majority charge carriers, increasing conductivity.";
}
else if (lowerCommand.includes('what is an n-type semiconductor') || lowerCommand.includes('n-type semiconductor')) {
    responseText = "An n-type semiconductor is created by doping an intrinsic semiconductor with donor impurities (e.g., Phosphorus in Silicon). These impurities donate free electrons which act as majority charge carriers, increasing conductivity.";
}
else if (lowerCommand.includes('what is a depletion region') || lowerCommand.includes('depletion region')) {
    responseText = "The depletion region (or depletion layer) is an area within a p-n junction diode where mobile charge carriers (electrons and holes) have been swept out, leaving behind immobile ionized donor and acceptor atoms. This region acts as an insulator.";
}
else if (lowerCommand.includes('what is forward bias') || lowerCommand.includes('forward bias diode')) {
    responseText = "Forward bias is the condition where a voltage is applied across a p-n junction in a direction that allows current to flow easily. The positive terminal is connected to the p-type material and the negative to the n-type, reducing the depletion region.";
}
else if (lowerCommand.includes('what is reverse bias') || lowerCommand.includes('reverse bias diode')) {
    responseText = "Reverse bias is the condition where a voltage is applied across a p-n junction in a direction that prevents current from flowing (or allows only a very small leakage current). The positive terminal is connected to the n-type material and the negative to the p-type, widening the depletion region.";
}
else if (lowerCommand.includes('what is breakdown voltage') || lowerCommand.includes('breakdown voltage diode')) {
    responseText = "Breakdown voltage in a semiconductor device is the minimum reverse voltage that causes the device to conduct current significantly. Beyond this voltage, the device can be damaged unless designed for it (like a Zener diode).";
}
else if (lowerCommand.includes('what is a light emitting diode principle') || lowerCommand.includes('LED principle')) {
    responseText = "The principle of an LED (Light Emitting Diode) relies on electroluminescence in a semiconductor. When forward biased, electrons and holes recombine in the depletion region, releasing energy in the form of photons (light).";
}
else if (lowerCommand.includes('what is a tunnel diode') || lowerCommand.includes('tunnel diode')) {
    responseText = "A tunnel diode (or Esaki diode) is a highly doped semiconductor diode that exhibits negative resistance in its current-voltage characteristic due to quantum mechanical tunneling. It's used in very high-frequency oscillators and switching circuits.";
}
else if (lowerCommand.includes('what is a solar cell') || lowerCommand.includes('photovoltaic cell')) {
    responseText = "A solar cell (or photovoltaic cell) is an electrical device that converts the energy of light directly into electricity by the photovoltaic effect. It's essentially a large-area p-n junction where incident photons create electron-hole pairs, generating current.";
}
else if (lowerCommand.includes('what is a Gunn diode') || lowerCommand.includes('Gunn diode')) {
    responseText = "A Gunn diode is a type of diode that exhibits negative differential resistance, allowing it to function as an oscillator and amplifier for microwave frequencies. It's based on the Gunn effect, involving electron transfer between conduction band valleys.";
}
else if (lowerCommand.includes('what is a PIN diode') || lowerCommand.includes('PIN diode')) {
    responseText = "A PIN diode is a type of diode with a wide, lightly doped 'intrinsic' semiconductor layer between a p-type and an n-type semiconductor layer. It's used as an RF switch, attenuator, and photodetector due to its variable resistance at RF frequencies.";
}
else if (lowerCommand.includes('what is an avalanche photodiode') || lowerCommand.includes('APD')) {
    responseText = "An Avalanche Photodiode (APD) is a highly sensitive semiconductor photodiode that utilizes the photoelectric effect to convert light into an electrical current. It provides internal current gain through avalanche multiplication, making it suitable for low-light applications.";
}
else if (lowerCommand.includes('what is a CCD sensor') || lowerCommand.includes('Charge-Coupled Device')) {
    responseText = "A CCD (Charge-Coupled Device) sensor is an image sensor used in digital cameras, camcorders, and other optical scanners. It converts light into an electrical charge, which is then transferred and read out sequentially to create a digital image.";
}
else if (lowerCommand.includes('what is a CMOS image sensor') || lowerCommand.includes('CMOS sensor image')) {
    responseText = "A CMOS (Complementary Metal-Oxide-Semiconductor) image sensor is a type of image sensor used to capture images. Unlike CCDs, each pixel in a CMOS sensor has its own photodetector and active amplifier, allowing for faster readout and lower power consumption.";
}

// --- Sensors & Actuators (Even More Expanded) ---
else if (lowerCommand.includes('what is a temperature sensor') || lowerCommand.includes('temperature sensor')) {
    responseText = "A temperature sensor is a device that measures temperature. Common types include thermistors, RTDs (Resistance Temperature Detectors), thermocouples, and semiconductor-based IC sensors.";
}
else if (lowerCommand.includes('what is an RTD') || lowerCommand.includes('Resistance Temperature Detector')) {
    responseText = "An RTD (Resistance Temperature Detector) is a temperature sensor that changes its resistance with temperature. It's known for high accuracy and stability, often made of platinum, copper, or nickel.";
}
else if (lowerCommand.includes('what is a thermocouple') || lowerCommand.includes('thermocouple')) {
    responseText = "A thermocouple is a temperature sensor consisting of two dissimilar electrical conductors forming electrical junctions at differing temperatures. It produces a temperature-dependent voltage as a result of the Seebeck effect, allowing for temperature measurement over wide ranges.";
}
else if (lowerCommand.includes('what is a pressure sensor') || lowerCommand.includes('pressure sensor')) {
    responseText = "A pressure sensor is a device that measures pressure, typically of gases or liquids. Pressure is an expression of the force required to stop a fluid from expanding, and pressure sensors convert this force into an electrical signal.";
}
else if (lowerCommand.includes('what is an ultrasonic sensor') || lowerCommand.includes('ultrasonic sensor')) {
    responseText = "An ultrasonic sensor measures distance by emitting ultrasonic waves and listening for the echo. By calculating the time taken for the sound to return, it determines the distance to an object. It's common in robotics and object detection.";
}
else if (lowerCommand.includes('what is an infrared sensor') || lowerCommand.includes('IR sensor')) {
    responseText = "An infrared (IR) sensor is an electronic device that measures or detects infrared radiation in its environment. It can be used for motion detection, proximity sensing, object detection, and even thermal imaging.";
}
else if (lowerCommand.includes('what is a motion sensor') || lowerCommand.includes('PIR sensor')) {
    responseText = "A motion sensor, often a PIR (Passive Infrared) sensor, detects movement by measuring changes in infrared radiation levels in its field of view. It's commonly used in security systems and automatic lighting.";
}
else if (lowerCommand.includes('what is a humidity sensor') || lowerCommand.includes('humidity sensor')) {
    responseText = "A humidity sensor (or hygrometer) detects and measures the amount of water vapor in the air. These sensors are crucial for environmental monitoring, HVAC systems, and weather stations.";
}
else if (lowerCommand.includes('what is an accelerometer') || lowerCommand.includes('accelerometer')) {
    responseText = "An accelerometer is a device that measures proper acceleration. This is the acceleration (or rate of change of velocity) of a body in its own rest frame. It's used to detect tilt, vibration, and orientation changes.";
}
else if (lowerCommand.includes('what is a gyroscope') || lowerCommand.includes('gyroscope sensor')) {
    responseText = "A gyroscope is a device that measures or maintains orientation and angular velocity. It detects rotation around an axis and is often paired with accelerometers in IMUs (Inertial Measurement Units) for more complete motion sensing.";
}
else if (lowerCommand.includes('what is a magnetomter') || lowerCommand.includes('magnetometer')) {
    responseText = "A magnetometer is an instrument that measures magnetic field strength or direction. In electronics, they are used in compasses, navigation systems, and metal detectors.";
}
else if (lowerCommand.includes('what is a proximity sensor') || lowerCommand.includes('proximity sensor')) {
    responseText = "A proximity sensor is a non-contact sensor that detects the presence of nearby objects without any physical contact. They work by emitting an electromagnetic field or a beam of radiation and looking for changes in the return signal.";
}
else if (lowerCommand.includes('what is a force sensor') || lowerCommand.includes('force sensor') || lowerCommand.includes('load cell')) {
    responseText = "A force sensor, often called a load cell, is a transducer that converts a force into an electrical signal. The electrical signal output is proportional to the applied force. They are used in scales, robotic grippers, and industrial measurement.";
}
else if (lowerCommand.includes('what is a flex sensor') || lowerCommand.includes('flex sensor')) {
    responseText = "A flex sensor is a sensor that measures the amount of bend or deflection. As the sensor is bent, the resistance across it increases. They are commonly used in robotics, gaming, and virtual reality gloves.";
}
else if (lowerCommand.includes('what is a gas sensor') || lowerCommand.includes('gas sensor')) {
    responseText = "A gas sensor is an electronic device that detects the presence and concentration of different types of gases in an area. They are used to detect combustible, flammable, and toxic gases, as well as oxygen depletion, in various environments.";
}
else if (lowerCommand.includes('what is a pH sensor') || lowerCommand.includes('pH sensor')) {
    responseText = "A pH sensor measures the acidity or alkalinity of a liquid. It typically consists of a glass electrode that generates a voltage proportional to the hydrogen ion concentration in the solution. Important for water quality, chemical processes, and agriculture.";
}
else if (lowerCommand.includes('what is a photoelectric sensor') || lowerCommand.includes('photoelectric sensor')) {
    responseText = "A photoelectric sensor detects the presence or absence of an object by emitting a light beam (usually infrared) and detecting whether the light is returned. They are widely used in automation and industrial applications.";
}
else if (lowerCommand.includes('what is an encoder sensor') || lowerCommand.includes('rotary encoder')) {
    responseText = "An encoder sensor converts linear or rotary motion into digital signals. Rotary encoders, for example, detect angular position or motion and are commonly used for precise control in robotics and industrial machinery.";
}
else if (lowerCommand.includes('what is an IMU') || lowerCommand.includes('Inertial Measurement Unit')) {
    responseText = "An IMU (Inertial Measurement Unit) is an electronic device that measures and reports a body's specific force, angular rate, and sometimes the magnetic field surrounding the body, using a combination of accelerometers, gyroscopes, and often magnetometers.";
}
else if (lowerCommand.includes('what is a motor') || lowerCommand.includes('electric motor')) {
    responseText = "An electric motor is an electrical machine that converts electrical energy into mechanical energy. Most electric motors operate through the interaction between the motor's magnetic field and electric current in a wire winding to generate force in the form of torque.";
}
else if (lowerCommand.includes('what is a servo motor') || lowerCommand.includes('servo motor')) {
    responseText = "A servo motor is a rotary actuator that allows for precise control of angular position, velocity, and acceleration. It consists of a motor, a feedback sensor (often an encoder), and a control circuit. Commonly used in robotics and RC applications.";
}
else if (lowerCommand.includes('what is a stepper motor') || lowerCommand.includes('stepper motor')) {
    responseText = "A stepper motor is a brushless DC electric motor that divides a full rotation into a number of equal steps. It can be commanded to move and hold at any of these steps without a feedback sensor (open-loop control), making it ideal for precise positioning.";
}
else if (lowerCommand.includes('what is an actuator') || lowerCommand.includes('define actuator')) {
    responseText = "An actuator is a component of a machine that is responsible for moving and controlling a mechanism or system. It converts electrical, hydraulic, or pneumatic energy into mechanical motion. Motors, solenoids, and relays are common actuators.";
}
else if (lowerCommand.includes('what is a solenoid') || lowerCommand.includes('solenoid')) {
    responseText = "A solenoid is a type of electromagnet, the purpose of which is to generate a controlled magnetic field. When current passes through its coil, it creates a magnetic field that can be used to pull or push a plunger, converting electrical energy into linear mechanical motion.";
}
else if (lowerCommand.includes('what is a relay') || lowerCommand.includes('relay')) {
    responseText = "A relay is an electrically operated switch. It uses an electromagnet to mechanically operate a switch, either opening or closing a circuit. Relays are used to control a high-power circuit using a low-power signal, or to control multiple circuits with one signal.";
}
else if (lowerCommand.includes('what is a haptic actuator') || lowerCommand.includes('haptic feedback')) {
    responseText = "A haptic actuator is a device that creates a sense of touch by applying forces, vibrations, or motions to the user. It's used in touchscreens, gaming controllers, and virtual reality to provide haptic feedback.";
}
else if (lowerCommand.includes('what is a flow sensor') || lowerCommand.includes('flow sensor')) {
    responseText = "A flow sensor is a device that measures the rate of fluid or gas movement. It's critical in industrial processes, water management, and HVAC systems for monitoring and control.";
}
else if (lowerCommand.includes('what is a level sensor') || lowerCommand.includes('level sensor')) {
    responseText = "A level sensor is a device that detects the level of liquids, solids, or granular materials within a container or in open air. They are used in tanks, bins, and silos to monitor fill levels and prevent overfilling or running dry.";
}
else if (lowerCommand.includes('what is a strain gauge') || lowerCommand.includes('strain gauge')) {
    responseText = "A strain gauge is a sensor whose resistance varies with applied force. It converts force, pressure, tension, and weight into an electrical signal that can be measured. They are fundamental in load cells and structural health monitoring.";
}
else if (lowerCommand.includes('what is a hall effect sensor') || lowerCommand.includes('hall effect sensor')) {
    responseText = "A Hall effect sensor is a transducer that varies its output voltage in response to a magnetic field. It can be used for proximity sensing, positioning, speed detection, and current sensing.";
}
else if (lowerCommand.includes('what is a lidar sensor') || lowerCommand.includes('lidar')) {
    responseText = "Lidar (Light Detection and Ranging) is a remote sensing method that uses pulsed laser light to measure ranges (variable distances) to the Earth. It creates 3D point clouds and is used in autonomous vehicles, robotics, and mapping.";
}
else if (lowerCommand.includes('what is a radar sensor') || lowerCommand.includes('radar')) {
    responseText = "Radar (Radio Detection and Ranging) is a detection system that uses radio waves to determine the range, angle, or velocity of objects. It's used in automotive safety, weather forecasting, and air traffic control.";
}
else if (lowerCommand.includes('what is a MEMS sensor') || lowerCommand.includes('MEMS')) {
    responseText = "MEMS (Micro-Electro-Mechanical Systems) sensors are miniature devices that combine electrical and mechanical components on a microscopic scale. They are widely used in accelerometers, gyroscopes, pressure sensors, and microphones found in smartphones and wearables.";
}
else if (lowerCommand.includes('what is a biomedical sensor') || lowerCommand.includes('biomedical sensor')) {
    responseText = "A biomedical sensor is a device used to detect, measure, record, or transmit biological or physiological parameters. Examples include ECG sensors for heart activity, PPG sensors for blood volume changes, and glucose sensors.";
}
else if (lowerCommand.includes('what is an ECG sensor') || lowerCommand.includes('ECG sensor')) {
    responseText = "An ECG (Electrocardiogram) sensor measures the electrical activity of the heart over a period of time. It's used to detect and diagnose various cardiac conditions.";
}
else if (lowerCommand.includes('what is a PPG sensor') || lowerCommand.includes('PPG sensor')) {
    responseText = "A PPG (Photoplethysmography) sensor is an optical volumetric measurement technique that detects changes in blood volume in the microvascular bed of tissue. It's commonly used in wearable devices for heart rate monitoring and blood oxygen saturation (SpO2) measurement.";
}
else if (lowerCommand.includes('what is a chemical sensor') || lowerCommand.includes('chemical sensor')) {
    responseText = "A chemical sensor is a device that transforms chemical information (concentration of a specific component, presence of a specific analyte, etc.) into an analytically useful signal. This includes gas sensors, pH sensors, and biosensors.";
}
else if (lowerCommand.includes('what is a biosensor') || lowerCommand.includes('biosensor')) {
    responseText = "A biosensor is an analytical device that combines a biological component (e.g., enzyme, antibody, DNA) with a physicochemical detector element. It's used to detect biological analytes, such as glucose, proteins, or pathogens.";
}
else if (lowerCommand.includes('what is a force plate') || lowerCommand.includes('force plate')) {
    responseText = "A force plate is a measuring instrument that measures the ground reaction forces generated by a body standing on or moving across it. It's used in biomechanics, sports science, and robotics for analyzing balance and movement.";
}
else if (lowerCommand.includes('what is a load cell type') || lowerCommand.includes('bending beam load cell')) {
    responseText = "A bending beam load cell is a common type of force sensor that measures force by detecting the deflection of a metal beam with strain gauges attached. As the beam bends, the resistance of the strain gauges changes, which is converted to an electrical signal.";
}
else if (lowerCommand.includes('what is a rotary actuator') || lowerCommand.includes('rotary actuator')) {
    responseText = "A rotary actuator is a type of actuator that produces a rotary motion or torque. Electric motors, servo motors, and stepper motors are all examples of rotary actuators.";
}
else if (lowerCommand.includes('what is a linear actuator') || lowerCommand.includes('linear actuator')) {
    responseText = "A linear actuator is a type of actuator that creates motion in a straight line, as opposed to circular motion. Solenoids, pneumatic cylinders, and hydraulic cylinders are common linear actuators.";
}
else if (lowerCommand.includes('what is a piezoelectric actuator') || lowerCommand.includes('piezoelectric actuator')) {
    responseText = "A piezoelectric actuator is a device that uses the piezoelectric effect to convert electrical energy into mechanical displacement or force. They are known for their high precision, fast response, and ability to generate large forces in small packages.";
}
else if (lowerCommand.includes('what is a pneumatic actuator') || lowerCommand.includes('pneumatic actuator')) {
    responseText = "A pneumatic actuator is a device that converts compressed air energy into mechanical motion (linear or rotary). They are commonly used in industrial automation, robotics, and valve control due to their power and speed.";
}
else if (lowerCommand.includes('what is a hydraulic actuator') || lowerCommand.includes('hydraulic actuator')) {
    responseText = "A hydraulic actuator is a device that converts hydraulic fluid pressure into mechanical motion (linear or rotary). They are known for their high force capabilities and precision, used in heavy machinery, construction equipment, and aerospace.";
}

// --- Microcontrollers & Embedded Systems (Expanded Further) ---
else if (lowerCommand.includes('what is arduino') || lowerCommand.includes('define arduino')) {
    responseText = "Arduino is an open-source electronics platform that makes it easy to create a wide variety of interactive electronic objects and projects. It consists of two main parts: a physical programmable circuit board, known as a microcontroller, and a piece of software, or IDE (Integrated Development Environment), that runs on your computer. You use the IDE to write and upload code to the physical board.";
}
else if (lowerCommand.includes('what are arduino shields') || lowerCommand.includes('arduino shield')) {
    responseText = "Arduino shields are pre-assembled circuit boards that can be easily plugged on top of an Arduino board, extending its capabilities. They provide additional functionality like Ethernet connectivity, motor control, or wireless communication, without requiring complex wiring.";
}
else if (lowerCommand.includes('what is the arduino IDE') || lowerCommand.includes('arduino IDE')) {
    responseText = "The Arduino IDE (Integrated Development Environment) is a cross-platform application written in Java, designed to write, compile, and upload code to Arduino compatible boards. It provides a simple environment for programming microcontrollers.";
}
else if (lowerCommand.includes('what is GPIO') || lowerCommand.includes('General Purpose Input/Output')) {
    responseText = "GPIO stands for General Purpose Input/Output. These are generic pins on a microcontroller that can be configured by software to either input or output digital signals (high or low voltage). They are fundamental for interacting with sensors, LEDs, buttons, and other external components.";
}
else if (lowerCommand.includes('what is UART') || lowerCommand.includes('Universal Asynchronous Receiver/Transmitter')) {
    responseText = "UART (Universal Asynchronous Receiver/Transmitter) is a hardware communication protocol that transmits and receives serial data asynchronously. It's a common method for communication between microcontrollers and other devices like computers (via USB-to-serial converters).";
}
else if (lowerCommand.includes('what is SPI') || lowerCommand.includes('Serial Peripheral Interface')) {
    responseText = "SPI (Serial Peripheral Interface) is a synchronous serial communication interface specification used for short-distance communication, primarily in embedded systems. It operates in full duplex mode and typically uses four wires: MOSI, MISO, SCK, and SS.";
}
else if (lowerCommand.includes('what is I2C') || lowerCommand.includes('IIC') || lowerCommand.includes('Inter-Integrated Circuit')) {
    responseText = "I2C (Inter-Integrated Circuit), also known as IIC, is a multi-master, multi-slave serial communication bus used for connecting low-speed peripheral ICs to processors and microcontrollers. It uses only two bidirectional lines, SDA (data) and SCL (clock), making it very efficient.";
}
else if (lowerCommand.includes('what are interrupts') || lowerCommand.includes('microcontroller interrupts')) {
    responseText = "Interrupts are signals from hardware or software that indicate an event needs immediate attention from the CPU. When an interrupt occurs, the CPU temporarily suspends its current task, executes a specific 'Interrupt Service Routine' (ISR), and then resumes its previous task.";
}
else if (lowerCommand.includes('what is PWM') || lowerCommand.includes('Pulse Width Modulation')) {
    responseText = "PWM (Pulse Width Modulation) is a technique used to control the average power delivered to an electrical device by varying the width of electrical pulses. By changing the duty cycle (on-time vs. off-time), you can effectively control brightness of LEDs, speed of motors, etc.";
}
else if (lowerCommand.includes('what is a watchdog timer') || lowerCommand.includes('watchdog timer')) {
    responseText = "A watchdog timer is an electronic timer that is used to detect and recover from malfunctions in embedded systems. If the main program fails to reset the watchdog timer periodically (e.g., due to a software error), the timer will time out and reset the system.";
}
else if (lowerCommand.includes('what is a bootloader') || lowerCommand.includes('bootloader')) {
    responseText = "A bootloader is a small piece of code that runs when a microcontroller or computer first powers on or resets. Its primary function is to initialize the system and then load a larger program (like your Arduino sketch) into memory and start its execution.";
}
else if (lowerCommand.includes('what is firmware') || lowerCommand.includes('define firmware')) {
    responseText = "Firmware is a specific class of computer software that provides low-level control for a device's specific hardware. It's typically stored in non-volatile memory (like Flash ROM) and is responsible for basic functions, allowing higher-level software to interact with the hardware.";
}
else if (lowerCommand.includes('what is an RTOS') || lowerCommand.includes('Real-Time Operating System')) {
    responseText = "An RTOS (Real-Time Operating System) is an operating system intended for real-time applications, meaning it guarantees that certain operations will be completed within specific time constraints. RTOSes are crucial in embedded systems where timely responses are critical, such as in industrial control or medical devices.";
}
else if (lowerCommand.includes('what is memory in a microcontroller') || lowerCommand.includes('microcontroller memory')) {
    responseText = "Microcontrollers typically have different types of memory: Flash memory (for storing the program code), SRAM (Static RAM, for temporary data and variables), and EEPROM (Electrically Erasable Programmable Read-Only Memory, for small amounts of persistent data).";
}
else if (lowerCommand.includes('what is an instruction set') || lowerCommand.includes('instruction set architecture')) {
    responseText = "An instruction set (or Instruction Set Architecture - ISA) is the set of all instructions that a central processing unit (CPU) can understand and execute. It defines the commands that a processor knows, including operations, data types, and memory addressing modes.";
}
else if (lowerCommand.includes('what is raspberry pi') || lowerCommand.includes('raspberry pi')) {
    responseText = "The Raspberry Pi is a series of small single-board computers (SBCs) developed in the United Kingdom by the Raspberry Pi Foundation to promote the teaching of basic computer science in schools and developing countries. Unlike Arduino, it's a full-fledged computer capable of running an operating system.";
}
else if (lowerCommand.includes('arduino vs raspberry pi') || lowerCommand.includes('difference between arduino and raspberry pi')) {
    responseText = "Arduino is a microcontroller board, ideal for controlling hardware and real-time operations, programmed in a simplified C/C++. Raspberry Pi is a single-board computer, capable of running an OS like Linux, better for complex computing tasks, networking, and software applications.";
}
else if (lowerCommand.includes('what is an embedded system') || lowerCommand.includes('embedded system')) {
    responseText = "An embedded system is a computer system—a combination of a computer processor, computer memory, and input/output peripheral devices—that has a dedicated function within a larger mechanical or electrical system. It's designed to perform a specific task, often with real-time computing constraints.";
}
else if (lowerCommand.includes('what is cross-compilation') || lowerCommand.includes('cross compilation')) {
    responseText = "Cross-compilation is the process of compiling code on one computer architecture (the host) for execution on a different computer architecture (the target). This is common in embedded systems development, where code for a microcontroller is compiled on a desktop PC.";
}
else if (lowerCommand.includes('what is an IDE') || lowerCommand.includes('Integrated Development Environment')) {
    responseText = "An IDE (Integrated Development Environment) is a software application that provides comprehensive facilities to computer programmers for software development. It typically consists of a source code editor, build automation tools, and a debugger.";
}
else if (lowerCommand.includes('what is a debugger') || lowerCommand.includes('debugger electronics')) {
    responseText = "A debugger is a computer program that is used to test and debug other programs (the 'target' program). It allows a programmer to step through code, inspect variables, and set breakpoints to find and fix errors.";
}
else if (lowerCommand.includes('what is an SDK') || lowerCommand.includes('Software Development Kit')) {
    responseText = "An SDK (Software Development Kit) is a collection of software development tools in one installable package. It typically includes libraries, documentation, code samples, processes, and guides that developers can use to create applications for a specific platform.";
}
else if (lowerCommand.includes('what is CAN bus') || lowerCommand.includes('CAN protocol')) {
    responseText = "CAN (Controller Area Network) bus is a robust vehicle bus standard designed to allow microcontrollers and devices to communicate with each other in applications without a host computer. It's widely used in automotive and industrial automation.";
}
else if (lowerCommand.includes('what is Ethernet for embedded systems') || lowerCommand.includes('embedded ethernet')) {
    responseText = "Ethernet in embedded systems allows devices to connect to local area networks (LANs) and the internet using standard Ethernet protocols. This enables high-speed data transfer, remote monitoring, and integration with existing network infrastructure.";
}
else if (lowerCommand.includes('what is USB for embedded systems') || lowerCommand.includes('embedded USB')) {
    responseText = "USB (Universal Serial Bus) in embedded systems provides a common interface for connecting peripheral devices like sensors, displays, and storage to microcontrollers. It supports various data rates and power delivery, simplifying connectivity.";
}
else if (lowerCommand.includes('what is memory organization in microcontroller') || lowerCommand.includes('microcontroller memory organization')) {
    responseText = "Memory organization in a microcontroller refers to how different types of memory (Flash, SRAM, EEPROM) are structured and addressed by the CPU. Understanding this is crucial for efficient programming and resource management.";
}
else if (lowerCommand.includes('what is pipelining in CPU') || lowerCommand.includes('CPU pipelining')) {
    responseText = "Pipelining is a technique used in microprocessor design where multiple instructions are executed concurrently in different stages of the CPU pipeline. This increases instruction throughput and overall processor performance.";
}
else if (lowerCommand.includes('what is latency in embedded systems') || lowerCommand.includes('embedded system latency')) {
    responseText = "Latency in embedded systems refers to the delay between when an event occurs (e.g., a sensor reading) and when the system reacts to it. Low latency is critical for real-time applications.";
}
else if (lowerCommand.includes('what is jitter in embedded systems') || lowerCommand.includes('embedded system jitter')) {
    responseText = "Jitter in embedded systems refers to the variation in latency or the deviation from true periodicity of a signal or event. Excessive jitter can degrade the performance of real-time control systems and communication links.";
}
else if (lowerCommand.includes('what is an architecture type') || lowerCommand.includes('RISC architecture')) {
    responseText = "RISC (Reduced Instruction Set Computer) architecture is a CPU design philosophy that favors a smaller, highly optimized set of simple instructions, each taking roughly one clock cycle. This simplifies the processor design, allowing for faster clock speeds and lower power consumption.";
}
else if (lowerCommand.includes('what is CISC architecture') || lowerCommand.includes('CISC architecture')) {
    responseText = "CISC (Complex Instruction Set Computer) architecture is a CPU design philosophy that uses a larger, more complex set of instructions, where a single instruction can perform multiple low-level operations. While potentially more compact in code, it often leads to variable instruction execution times.";
}
else if (lowerCommand.includes('what is a system-on-chip') || lowerCommand.includes('SoC')) {
    responseText = "A System-on-a-Chip (SoC) is an integrated circuit that integrates all or most components of a computer or other electronic system into a single chip. It typically combines a CPU, memory, input/output ports, and other components, common in mobile phones and embedded devices.";
}
else if (lowerCommand.includes('what is a digital signal processor') || lowerCommand.includes('DSP processor')) {
    responseText = "A Digital Signal Processor (DSP) is a specialized microprocessor designed specifically for efficient, high-speed mathematical operations on digital signals. They are crucial in applications like audio processing, image recognition, and telecommunications.";
}
else if (lowerCommand.includes('what is a real-time operating system task') || lowerCommand.includes('RTOS task')) {
    responseText = "In an RTOS (Real-Time Operating System), a task (or thread) is an independent unit of execution that performs a specific function. RTOSes manage and schedule these tasks to ensure they meet their deadlines and execute in a predictable manner.";
}
else if (lowerCommand.includes('what is inter-process communication') || lowerCommand.includes('IPC embedded')) {
    responseText = "Inter-Process Communication (IPC) refers to mechanisms that allow independent processes or tasks within an embedded system to communicate and synchronize their activities. Examples include shared memory, message queues, semaphores, and mutexes.";
}
else if (lowerCommand.includes('what is a semaphore') || lowerCommand.includes('semaphore embedded')) {
    responseText = "A semaphore is a synchronization primitive used in operating systems and embedded systems to control access to shared resources by multiple tasks. It's a variable or abstract data type used to regulate access to a common resource by multiple processes.";
}
else if (lowerCommand.includes('what is a mutex') || lowerCommand.includes('mutex embedded')) {
    responseText = "A mutex (mutual exclusion) is a synchronization primitive that grants exclusive access to a shared resource, preventing multiple tasks from accessing it simultaneously. Only one task can 'lock' the mutex and access the resource at any given time.";
}
else if (lowerCommand.includes('what is JTAG') || lowerCommand.includes('JTAG debugging')) {
    responseText = "JTAG (Joint Test Action Group) is an industry standard for verifying designs and testing printed circuit boards (PCBs) after manufacture, and for debugging embedded systems. It provides a serial interface to access internal registers of ICs.";
}
else if (lowerCommand.includes('what is SWD') || lowerCommand.includes('Serial Wire Debug')) {
    responseText = "SWD (Serial Wire Debug) is a two-pin electrical interface that provides a debug port for microcontrollers and other embedded devices. It's a simpler alternative to JTAG, often used for debugging and programming ARM-based microcontrollers.";
}
else if (lowerCommand.includes('what is over-the-air firmware update') || lowerCommand.includes('OTA firmware update')) {
    responseText = "An Over-The-Air (OTA) firmware update is a method of wirelessly distributing and installing new software or firmware to embedded devices without physical connection. It's crucial for maintaining and improving IoT devices in the field.";
}
else if (lowerCommand.includes('what is a development board') || lowerCommand.includes('development board')) {
    responseText = "A development board is a circuit board designed to facilitate experimentation with a particular microcontroller, microprocessor, or SoC. It typically includes the main chip, power supply circuitry, programming interface, and various peripherals for easy prototyping.";
}
else if (lowerCommand.includes('what is an IDE for embedded systems') || lowerCommand.includes('embedded IDE')) {
    responseText = "An IDE (Integrated Development Environment) for embedded systems is a software application tailored for developing, debugging, and deploying code to microcontrollers or embedded processors. It often includes specialized compilers, debuggers, and hardware integration tools.";
}
else if (lowerCommand.includes('what is toolchain') || lowerCommand.includes('embedded toolchain')) {
    responseText = "An embedded toolchain is a set of programming tools used to create software for embedded systems. It typically includes a cross-compiler, an assembler, a linker, a debugger, and utilities for flashing firmware to the target device.";
}
else if (lowerCommand.includes('what is a boot sector') || lowerCommand.includes('boot sector')) {
    responseText = "A boot sector is a region of a hard disk or other data storage device that contains machine code that a computer's firmware loads and executes during the booting process. It's the very first code executed when a system starts up.";
}
else if (lowerCommand.includes('what is device driver') || lowerCommand.includes('device driver embedded')) {
    responseText = "A device driver is a computer program that operates or controls a particular type of device that is attached to a computer. In embedded systems, drivers provide the software interface between the operating system or application and the hardware peripherals.";
}
else if (lowerCommand.includes('what is a hardware abstraction layer') || lowerCommand.includes('HAL embedded')) {
    responseText = "A Hardware Abstraction Layer (HAL) is a layer of programming that allows software to interact with a hardware device at a general level rather than at a detailed hardware level. It makes software more portable across different hardware platforms.";
}

// --- Internet of Things (IoT) (Expanded Further) ---
else if (lowerCommand.includes('what is IoT') || lowerCommand.includes('Internet of Things') || lowerCommand.includes('define IoT')) {
    responseText = "IoT (Internet of Things) refers to the network of physical objects embedded with sensors, software, and other technologies for the purpose of connecting and exchanging data with other devices and systems over the internet. It enables objects to 'talk' to each other and the cloud.";
}
else if (lowerCommand.includes('what is an IoT device') || lowerCommand.includes('IoT device')) {
    responseText = "An IoT device is any physical object that contains embedded technology allowing it to connect to the internet and interact with other devices. This can range from smart home appliances and wearable tech to industrial sensors.";
}
else if (lowerCommand.includes('what is an IoT gateway') || lowerCommand.includes('IoT gateway')) {
    responseText = "An IoT gateway is a physical device or a software program that serves as a connection point between the cloud and controllers, sensors, and intelligent devices. It acts as a bridge, aggregating, filtering, and transmitting data securely.";
}
else if (lowerCommand.includes('what is edge computing') || lowerCommand.includes('edge computing IoT')) {
    responseText = "Edge computing in IoT involves processing data closer to where it's generated, rather than sending it all to a centralized cloud. This reduces latency, saves bandwidth, and can improve security and real-time decision-making.";
}
else if (lowerCommand.includes('what is cloud computing') || lowerCommand.includes('cloud computing IoT')) {
    responseText = "Cloud computing in IoT refers to using remote servers, storage, databases, networking, software, analytics, and intelligence over the Internet ('the cloud') to process and store data from IoT devices. It provides scalable resources for large-scale IoT deployments.";
}
else if (lowerCommand.includes('what is an IoT platform') || lowerCommand.includes('IoT platform')) {
    responseText = "An IoT platform is a multi-layered technology that connects physical devices to the cloud and other applications. It provides tools for device management, data acquisition, processing, analytics, and application development for IoT solutions.";
}
else if (lowerCommand.includes('what is MQTT') || lowerCommand.includes('MQTT protocol')) {
    responseText = "MQTT (Message Queuing Telemetry Transport) is a lightweight, publish-subscribe network protocol that transports messages between devices. It's designed for constrained devices and low-bandwidth, high-latency, or unreliable networks, making it popular for IoT applications.";
}
else if (lowerCommand.includes('what is CoAP') || lowerCommand.includes('CoAP protocol')) {
    responseText = "CoAP (Constrained Application Protocol) is a specialized web transfer protocol for use with constrained nodes and constrained networks in the Internet of Things. It's designed for use by small, low-power sensors, switches, and other devices.";
}
else if (lowerCommand.includes('what is LoRaWAN') || lowerCommand.includes('LoRaWAN protocol')) {
    responseText = "LoRaWAN is a Low Power Wide Area Network (LPWAN) specification for wireless, battery-operated IoT devices. It defines the communication protocol and system architecture for the network, offering long-range and low-power connectivity.";
}
else if (lowerCommand.includes('what is Zigbee') || lowerCommand.includes('Zigbee protocol')) {
    responseText = "Zigbee is a wireless technology standard that operates on IEEE 802.15.4, designed for low-power, low-data-rate, short-range wireless networking. It's commonly used in smart homes, building automation, and industrial control systems.";
}
else if (lowerCommand.includes('what is Bluetooth Low Energy') || lowerCommand.includes('BLE')) {
    responseText = "Bluetooth Low Energy (BLE) is a wireless personal area network technology designed and marketed by the Bluetooth Special Interest Group. It's optimized for very low power consumption, making it ideal for small, battery-powered IoT devices and wearables.";
}
else if (lowerCommand.includes('what is smart home') || lowerCommand.includes('smart home technology')) {
    responseText = "A smart home is a residence that uses internet-connected devices to enable the remote monitoring and management of appliances and systems, such as lighting, heating, and security. It aims to enhance comfort, convenience, energy efficiency, and security.";
}
else if (lowerCommand.includes('what is industrial IoT') || lowerCommand.includes('IIoT')) {
    responseText = "Industrial IoT (IIoT) refers to the application of IoT technologies in industrial settings, such as manufacturing, energy management, and supply chain logistics. It focuses on improving operational efficiency, predictive maintenance, and overall productivity.";
}
else if (lowerCommand.includes('what is a digital twin') || lowerCommand.includes('digital twin IoT')) {
    responseText = "A digital twin is a virtual representation of a physical object, system, or process. In IoT, digital twins use real-time data from sensors to create an accurate virtual model, enabling monitoring, simulation, and analysis to optimize performance and predict issues.";
}
else if (lowerCommand.includes('what is fog computing') || lowerCommand.includes('fog computing IoT')) {
    responseText = "Fog computing extends cloud computing to the edge of the network, placing data, compute, storage, and application services closer to end-devices and users. It bridges the gap between edge devices and the cloud, offering faster processing for certain IoT applications.";
}
else if (lowerCommand.includes('what is M2M communication') || lowerCommand.includes('Machine to Machine communication')) {
    responseText = "M2M (Machine-to-Machine) communication refers to the direct communication between devices using any communication channel, including wired and wireless. It's a foundational concept for IoT, enabling devices to exchange data and act without human intervention.";
}
else if (lowerCommand.includes('what is LPWAN') || lowerCommand.includes('Low Power Wide Area Network')) {
    responseText = "LPWAN (Low Power Wide Area Network) is a type of wireless telecommunication network designed to allow long-range communications at a low bit rate among things (connected objects) that are battery-powered, for a period of months or years.";
}
else if (lowerCommand.includes('what is NB-IoT') || lowerCommand.includes('Narrowband IoT')) {
    responseText = "NB-IoT (Narrowband IoT) is a low-power wide-area (LPWA) technology standard published by 3GPP for cellular devices and services. It's designed to enable a wide range of new IoT devices and services, offering extended battery life and deep coverage.";
}
else if (lowerCommand.includes('what is OPC UA') || lowerCommand.includes('OPC Unified Architecture')) {
    responseText = "OPC UA (Open Platform Communications Unified Architecture) is an industrial interoperability standard that enables the secure and reliable exchange of data between industrial equipment and systems from different vendors. It's crucial for IIoT communication.";
}
else if (lowerCommand.includes('what is a message broker') || lowerCommand.includes('IoT message broker')) {
    responseText = "An IoT message broker is a server that handles message routing and queuing between IoT devices and applications. It facilitates communication in publish-subscribe models, ensuring messages are delivered reliably and efficiently, even with many connected devices.";
}
else if (lowerCommand.includes('what is IoT security') || lowerCommand.includes('IoT security')) {
    responseText = "IoT security refers to the measures taken to protect IoT devices, networks, and data from cyber threats. This includes device authentication, data encryption, secure boot, and vulnerability management to ensure the integrity and privacy of IoT ecosystems.";
}
else if (lowerCommand.includes('what is device authentication IoT') || lowerCommand.includes('IoT device authentication')) {
    responseText = "Device authentication in IoT is the process of verifying the identity of an IoT device attempting to connect to a network or cloud service. This prevents unauthorized devices from accessing the system and ensures data integrity.";
}
else if (lowerCommand.includes('what is data encryption IoT') || lowerCommand.includes('IoT data encryption')) {
    responseText = "Data encryption in IoT involves converting data into a coded format to prevent unauthorized access during transmission and storage. Protocols like TLS/SSL are commonly used to secure communication between IoT devices and servers.";
}
else if (lowerCommand.includes('what is a public key infrastructure IoT') || lowerCommand.includes('PKI IoT')) {
    responseText = "A Public Key Infrastructure (PKI) in IoT provides the necessary components (e.g., digital certificates, certificate authorities) to manage and validate cryptographic keys, enabling secure communication and authentication for IoT devices.";
}
else if (lowerCommand.includes('what is a cloud provider IoT') || lowerCommand.includes('AWS IoT')) {
    responseText = "AWS IoT Core is a managed cloud platform service from Amazon Web Services that allows connected devices to interact with cloud applications and other devices securely. It provides message routing, device management, and data processing capabilities.";
}
else if (lowerCommand.includes('what is Google Cloud IoT') || lowerCommand.includes('Google Cloud IoT Core')) {
    responseText = "Google Cloud IoT Core is a fully managed service that allows you to securely connect, manage, and ingest data from globally dispersed devices. It provides device management, protocol bridges, and integration with other Google Cloud services for analytics.";
}
else if (lowerCommand.includes('what is Azure IoT') || lowerCommand.includes('Azure IoT Hub')) {
    responseText = "Azure IoT Hub is a managed service hosted in the Microsoft Azure cloud that acts as a central message hub for bi-directional communication between your IoT application and the devices it manages. It supports millions of devices and secure communication.";
}
else if (lowerCommand.includes('what is 5G for IoT') || lowerCommand.includes('5G IoT')) {
    responseText = "5G for IoT refers to the application of fifth-generation cellular technology to connect IoT devices. It offers ultra-low latency, massive connectivity, and enhanced mobile broadband, enabling new use cases in industrial automation, smart cities, and autonomous vehicles.";
}
else if (lowerCommand.includes('what is satellite IoT') || lowerCommand.includes('satellite IoT')) {
    responseText = "Satellite IoT involves using satellite networks to provide connectivity for IoT devices, particularly in remote areas where terrestrial networks (cellular, Wi-Fi) are unavailable. It enables global coverage for asset tracking, environmental monitoring, and maritime applications.";
}
else if (lowerCommand.includes('what is mesh networking IoT') || lowerCommand.includes('IoT mesh network')) {
    responseText = "Mesh networking in IoT is a network topology where devices (nodes) connect directly, non-hierarchically, to as many other nodes as possible and cooperate to route data from/to clients. It provides increased reliability, range, and robustness, common in smart homes (e.g., Zigbee, Thread).";
}
else if (lowerCommand.includes('what is data analytics IoT') || lowerCommand.includes('IoT data analytics')) {
    responseText = "IoT data analytics involves processing, analyzing, and interpreting the large volumes of data generated by IoT devices to extract valuable insights. This can include predictive maintenance, operational optimization, and understanding customer behavior.";
}

// --- Analog and Digital Communication Systems (More Specific) ---
else if (lowerCommand.includes('what is modulation') || lowerCommand.includes('define modulation')) {
    responseText = "Modulation is the process of varying one or more properties of a carrier wave with a modulating signal that contains information. This allows the information to be transmitted over long distances or different mediums.";
}
else if (lowerCommand.includes('what is AM') || lowerCommand.includes('amplitude modulation')) {
    responseText = "AM stands for Amplitude Modulation. It's a modulation technique used in electronic communication, most commonly for transmitting information via a radio carrier wave. In AM, the amplitude (signal strength) of the carrier wave is varied in proportion to that of the message signal.";
}
else if (lowerCommand.includes('what is FM') || lowerCommand.includes('frequency modulation')) {
    responseText = "FM stands for Frequency Modulation. It's a modulation technique in which the frequency of the carrier wave is varied in proportion to that of the message signal, while its amplitude remains constant. FM is less susceptible to noise than AM.";
}
else if (lowerCommand.includes('what is PM') || lowerCommand.includes('Phase Modulation')) {
    responseText = "PM stands for Phase Modulation. It's a modulation technique where the phase of the carrier wave is varied in proportion to the message signal. PM is closely related to FM and is often used in digital communication.";
}
else if (lowerCommand.includes('what is sampling') || lowerCommand.includes('define sampling in communication')) {
    responseText = "In digital communication, sampling is the process of converting a continuous-time analog signal into a discrete-time signal by taking a series of measurements (samples) at regular intervals. The sampling rate must be at least twice the highest frequency in the signal (Nyquist-Shannon theorem).";
}
else if (lowerCommand.includes('what is quantization') || lowerCommand.includes('define quantization')) {
    responseText = "Quantization is the process of converting a continuous range of values (like sampled amplitudes) into a finite number of discrete steps or levels. In digital communication, after sampling, the amplitude of each sample is rounded to the nearest allowed discrete value.";
}
else if (lowerCommand.includes('what is encoding') || lowerCommand.includes('encoding digital communication')) {
    responseText = "In digital communication, encoding is the process of assigning a unique binary code (a sequence of bits) to each quantized sample or symbol. This allows the digital representation of the information to be transmitted.";
}
else if (lowerCommand.includes('what is PCM') || lowerCommand.includes('Pulse Code Modulation')) {
    responseText = "PCM (Pulse Code Modulation) is a method used to digitally represent sampled analog signals. It's the standard form of digital audio in computers and other digital communication systems. PCM involves three main steps: sampling, quantization, and encoding.";
}
else if (lowerCommand.includes('what is ASK') || lowerCommand.includes('Amplitude Shift Keying')) {
    responseText = "ASK (Amplitude Shift Keying) is a digital modulation technique where the amplitude of a carrier wave is varied to represent binary data (0s and 1s). It's simple but susceptible to noise.";
}
else if (lowerCommand.includes('what is FSK') || lowerCommand.includes('Frequency Shift Keying')) {
    responseText = "FSK (Frequency Shift Keying) is a digital modulation technique where the frequency of the carrier wave is shifted between different values to represent binary data. It's more robust to noise than ASK.";
}
else if (lowerCommand.includes('what is PSK') || lowerCommand.includes('Phase Shift Keying')) {
    responseText = "PSK (Phase Shift Keying) is a digital modulation technique where the phase of the carrier wave is varied to represent binary data. Different phase shifts correspond to different symbols (e.g., 0 and 1).";
}
else if (lowerCommand.includes('what is QAM') || lowerCommand.includes('Quadrature Amplitude Modulation')) {
    responseText = "QAM (Quadrature Amplitude Modulation) is a digital modulation scheme that conveys data by changing (modulating) the amplitude of two carrier waves. These two waves are out of phase with each other by 90 degrees (quadrature). It's efficient for high data rates.";
}
else if (lowerCommand.includes('what is multiplexing') || lowerCommand.includes('define multiplexing')) {
    responseText = "Multiplexing is a method by which multiple analog or digital signals are combined into one signal over a shared medium. The aim is to share a costly resource (e.g., a transmission medium) among multiple independent users.";
}
else if (lowerCommand.includes('what is TDM') || lowerCommand.includes('Time Division Multiplexing')) {
    responseText = "TDM (Time Division Multiplexing) is a technique where different signals are transmitted over a single communication channel by dividing the channel's time into slots. Each signal gets a brief turn to use the channel.";
}
else if (lowerCommand.includes('what is FDM') || lowerCommand.includes('Frequency Division Multiplexing')) {
    responseText = "FDM (Frequency Division Multiplexing) is a technique where multiple signals are transmitted simultaneously over a single communication channel by assigning each signal a different frequency band. This is common in radio broadcasting.";
}
else if (lowerCommand.includes('what is WDM') || lowerCommand.includes('Wavelength Division Multiplexing')) {
    responseText = "WDM (Wavelength Division Multiplexing) is a technology that multiplexes multiple optical carrier signals onto a single optical fiber by using different wavelengths (colors) of laser light. It greatly increases the capacity of optical fiber communication systems.";
}
else if (lowerCommand.includes('what is noise in communication') || lowerCommand.includes('communication noise')) {
    responseText = "Noise in communication systems refers to unwanted random disturbances that interfere with the desired signal. It can degrade the quality and intelligibility of transmitted information, making it harder to recover the original message.";
}
else if (lowerCommand.includes('what is an antenna') || lowerCommand.includes('define antenna')) {
    responseText = "An antenna is a transducer designed to transmit or receive electromagnetic waves. It converts electrical signals into electromagnetic waves for transmission, and vice versa for reception. Antennas come in various shapes and sizes depending on their application.";
}
else if (lowerCommand.includes('what is bandwidth') || lowerCommand.includes('define bandwidth')) {
    responseText = "Bandwidth in communication refers to the range of frequencies occupied by a signal, or the capacity of a transmission medium to carry data. A larger bandwidth generally means more data can be transmitted in a given time.";
}
else if (lowerCommand.includes('what is data rate') || lowerCommand.includes('define data rate')) {
    responseText = "Data rate, or bit rate, is the number of bits that are conveyed or processed per unit of time. It's typically measured in bits per second (bps) and represents the speed at which digital information is transferred.";
}
else if (lowerCommand.includes('what is channel capacity') || lowerCommand.includes('channel capacity')) {
    responseText = "Channel capacity is the maximum rate at which information can be transmitted over a communication channel with arbitrarily small error probability. It's often defined by the Shannon-Hartley theorem, which relates it to bandwidth and signal-to-noise ratio.";
}
else if (lowerCommand.includes('what is signal to noise ratio') || lowerCommand.includes('SNR')) {
    responseText = "Signal-to-Noise Ratio (SNR) is a measure used in science and engineering that compares the level of a desired signal to the level of background noise. A higher SNR indicates a clearer signal with less contamination from noise.";
}
else if (lowerCommand.includes('what is a transmission line') || lowerCommand.includes('transmission line')) {
    responseText = "A transmission line is a specialized cable or other structure designed to carry alternating current of radio frequency, as well as data or power, with minimal signal loss. Examples include coaxial cables and waveguides.";
}
else if (lowerCommand.includes('what is impedance matching') || lowerCommand.includes('impedance matching')) {
    responseText = "Impedance matching is the practice of designing the input impedance of an electrical load or the output impedance of its corresponding signal source to maximize power transfer or minimize signal reflection. It's crucial in RF and audio systems.";
}
else if (lowerCommand.includes('what is reflection coefficient') || lowerCommand.includes('reflection coefficient')) {
    responseText = "The reflection coefficient ($\Gamma$) in a transmission line describes the proportion of an electromagnetic wave that is reflected by an impedance discontinuity in the transmission medium. It's a complex number ranging from -1 to 1.";
}
else if (lowerCommand.includes('what is VSWR') || lowerCommand.includes('Voltage Standing Wave Ratio')) {
    responseText = "VSWR (Voltage Standing Wave Ratio) is a measure of impedance mismatch in a transmission line. It's the ratio of the maximum to minimum voltage in a standing wave pattern, indicating how much power is reflected back toward the source.";
}
else if (lowerCommand.includes('what is spread spectrum') || lowerCommand.includes('spread spectrum communication')) {
    responseText = "Spread spectrum is a technique in telecommunication in which a signal is deliberately spread in the frequency domain, resulting in a wider bandwidth than the information content, for the purpose of making it more robust to interference and jamming.";
}
else if (lowerCommand.includes('what is OFDM') || lowerCommand.includes('Orthogonal Frequency Division Multiplexing')) {
    responseText = "OFDM (Orthogonal Frequency Division Multiplexing) is a method of encoding digital data on multiple carrier frequencies. It's a robust modulation technique used in modern high-speed communication systems like Wi-Fi, 4G/5G, and DSL.";
}
else if (lowerCommand.includes('what is MIMO') || lowerCommand.includes('Multiple-Input Multiple-Output')) {
    responseText = "MIMO (Multiple-Input Multiple-Output) is an antenna technology for wireless communications in which multiple antennas are used at both the transmitter and receiver. It enhances data throughput and link range without requiring additional bandwidth or transmit power.";
}
else if (lowerCommand.includes('what is CDMA') || lowerCommand.includes('Code Division Multiple Access')) {
    responseText = "CDMA (Code Division Multiple Access) is a channel access method used by various radio communication technologies. It allows multiple users to share a common channel simultaneously by assigning a unique code to each user, differentiating their signals.";
}
else if (lowerCommand.includes('what is simplex communication') || lowerCommand.includes('simplex mode')) {
    responseText = "Simplex communication is a communication mode where data can flow in only one direction, from the transmitter to the receiver. Examples include traditional radio broadcasting or a security camera streaming video.";
}
else if (lowerCommand.includes('what is half-duplex communication') || lowerCommand.includes('half duplex mode')) {
    responseText = "Half-duplex communication is a communication mode where data can flow in both directions, but not simultaneously. Devices must take turns transmitting and receiving, like a walkie-talkie.";
}
else if (lowerCommand.includes('what is full-duplex communication') || lowerCommand.includes('full duplex mode')) {
    responseText = "Full-duplex communication is a communication mode where data can flow in both directions simultaneously. This allows for continuous two-way communication, such as in a telephone conversation or Ethernet network.";
}
else if (lowerCommand.includes('what is error detection and correction') || lowerCommand.includes('error correction communication')) {
    responseText = "Error detection and correction techniques are methods used in digital communication to identify and fix errors that may occur during data transmission due to noise or interference. Common methods include parity checks, checksums, and Hamming codes.";
}
else if (lowerCommand.includes('what is a waveguide') || lowerCommand.includes('waveguide RF')) {
    responseText = "A waveguide is a structure that guides waves, such as electromagnetic waves or sound waves. In RF and microwave applications, it's typically a hollow metal pipe used to transmit high-frequency electromagnetic waves with low loss.";
}
else if (lowerCommand.includes('what are S-parameters') || lowerCommand.includes('S parameters')) {
    responseText = "S-parameters (scattering parameters) are a mathematical construct used in electrical engineering to describe the electrical behavior of linear electrical networks when undergoing various steady state stimuli by electrical signals. They are particularly useful for characterizing high-frequency components and transmission lines.";
}
else if (lowerCommand.includes('what is an impedance matching network') || lowerCommand.includes('matching network')) {
    responseText = "An impedance matching network is an electrical network designed to transform the impedance of a source to match the impedance of a load. This maximizes power transfer and minimizes signal reflections in RF and microwave circuits.";
}
else if (lowerCommand.includes('what is satellite communication') || lowerCommand.includes('satellite communication')) {
    responseText = "Satellite communication is a method of communication that uses artificial satellites to relay radio signals between Earth stations. It allows for global coverage and is used for television broadcasting, internet access, and mobile communication.";
}
else if (lowerCommand.includes('what is cellular communication') || lowerCommand.includes('cellular network')) {
    responseText = "Cellular communication is a type of wireless communication where the service area is divided into smaller geographical areas called 'cells,' each served by a base station. This allows for efficient use of spectrum and high user capacity, as seen in mobile phone networks.";
}
else if (lowerCommand.includes('what is fiber optic communication') || lowerCommand.includes('fiber optics')) {
    responseText = "Fiber optic communication is a method of transmitting information from one place to another by sending pulses of light through an optical fiber. It offers high bandwidth, long-distance transmission, and immunity to electromagnetic interference.";
}
else if (lowerCommand.includes('what is a modem') || lowerCommand.includes('modem')) {
    responseText = "A modem (modulator-demodulator) is a network hardware device that modulates one or more carrier wave signals to encode digital information for transmission and demodulates signals to decode the transmitted information. It's used to connect computers to the internet over telephone lines, cable, or fiber.";
}
else if (lowerCommand.includes('what is a dipole antenna') || lowerCommand.includes('dipole antenna')) {
    responseText = "A dipole antenna is one of the simplest and most widely used types of radio antennas. It consists of two identical conductive elements (usually metal wires or rods) arranged collinearly, and typically fed at the center.";
}
else if (lowerCommand.includes('what is a monopole antenna') || lowerCommand.includes('monopole antenna')) {
    responseText = "A monopole antenna is a type of radio antenna that consists of a single conductor or rod, typically mounted above an electrically conductive surface that acts as a ground plane. It's essentially half of a dipole antenna.";
}
else if (lowerCommand.includes('what is a patch antenna') || lowerCommand.includes('patch antenna')) {
    responseText = "A patch antenna is a type of antenna that consists of a flat, rectangular or circular metal patch mounted over a larger ground plane. They are low profile, conformable, and often used in mobile phones and GPS devices.";
}
else if (lowerCommand.includes('what is a Yagi-Uda antenna') || lowerCommand.includes('Yagi antenna')) {
    responseText = "A Yagi-Uda antenna (or simply Yagi antenna) is a directional antenna consisting of a driven element (e.g., a dipole) and several parasitic elements (reflectors and directors). It provides high gain and directionality, common for TV reception.";
}
else if (lowerCommand.includes('what is a horn antenna') || lowerCommand.includes('horn antenna')) {
    responseText = "A horn antenna is a type of antenna used for microwave frequencies. It consists of a flaring metal waveguide shaped like a horn, which acts as a transducer to match the impedance of a waveguide to free space, providing high directivity.";
}
else if (lowerCommand.includes('what is stripline') || lowerCommand.includes('stripline PCB')) {
    responseText = "Stripline is a type of electrical transmission line that consists of a central conductive trace embedded in a dielectric material between two ground planes. It's used for controlled impedance routing on PCBs, especially at high frequencies.";
}
else if (lowerCommand.includes('what is microstrip') || lowerCommand.includes('microstrip PCB')) {
    responseText = "Microstrip is a type of electrical transmission line that consists of a conductive trace on one side of a dielectric substrate, with a ground plane on the opposite side. It's commonly used for RF and microwave circuits on PCBs.";
}
else if (lowerCommand.includes('what is characteristic impedance') || lowerCommand.includes('characteristic impedance')) {
    responseText = "Characteristic impedance ($Z_0$) is the impedance that a transmission line would present to an infinitely long line. It's a key parameter for matching transmission lines to loads to prevent reflections and maximize power transfer.";
}
else if (lowerCommand.includes('what is a circulator') || lowerCommand.includes('RF circulator')) {
    responseText = "A circulator is a passive, non-reciprocal three-port or four-port device in RF and microwave engineering. It allows a signal to flow in a specific direction from one port to the next in a circular fashion, often used for duplexing or isolation.";
}
else if (lowerCommand.includes('what is an isolator') || lowerCommand.includes('RF isolator')) {
    responseText = "An isolator is a two-port passive device that transmits microwave or radio frequency power in one direction only. It prevents reflections from reaching the source, protecting sensitive components and improving system stability.";
}
else if (lowerCommand.includes('what is a directional coupler') || lowerCommand.includes('directional coupler')) {
    responseText = "A directional coupler is a passive four-port device used in RF engineering that couples a defined amount of the electromagnetic power in a transmission line to another port, allowing for monitoring of forward and reflected power.";
}
else if (lowerCommand.includes('what is a low noise amplifier') || lowerCommand.includes('LNA')) {
    responseText = "A Low Noise Amplifier (LNA) is an electronic amplifier that amplifies very weak signals (e.g., from an antenna) while adding as little noise as possible. It's a critical component in the receiver chain of communication systems.";
}
else if (lowerCommand.includes('what is a power amplifier RF') || lowerCommand.includes('RF PA')) {
    responseText = "An RF Power Amplifier (RF PA) is an electronic amplifier that converts a low-power radio-frequency signal into a higher power signal. It's typically used in the transmitter chain to drive an antenna for wireless communication.";
}
else if (lowerCommand.includes('what is a SAW filter') || lowerCommand.includes('Surface Acoustic Wave filter')) {
    responseText = "A SAW (Surface Acoustic Wave) filter is an electronic filter that uses surface acoustic waves propagating on the surface of a piezoelectric substrate to implement its filtering function. They are compact, highly selective, and widely used in RF and IF sections of wireless devices.";
}
else if (lowerCommand.includes('what is a frequency synthesizer') || lowerCommand.includes('frequency synthesizer')) {
    responseText = "A frequency synthesizer is an electronic circuit that generates a range of frequencies from a single fixed reference frequency. They are essential components in radio transmitters and receivers, enabling tuning to different channels.";
}
else if (lowerCommand.includes('what is radar technology') || lowerCommand.includes('radar technology')) {
    responseText = "Radar (Radio Detection and Ranging) technology uses radio waves to detect the presence, range, angle, and velocity of objects. It involves transmitting radio pulses and analyzing the echoes received, applied in diverse fields from defense to weather forecasting.";
}
else if (lowerCommand.includes('what is sonar technology') || lowerCommand.includes('sonar technology')) {
    responseText = "Sonar (Sound Navigation and Ranging) technology uses sound propagation (usually underwater) to navigate, communicate with or detect objects on or under the surface of the water. It's used for seafloor mapping, submarine detection, and fishing.";
}
else if (lowerCommand.includes('what is electromagnetic spectrum') || lowerCommand.includes('EM spectrum')) {
    responseText = "The electromagnetic (EM) spectrum is the range of all types of EM radiation, ordered by frequency or wavelength. It includes radio waves, microwaves, infrared, visible light, ultraviolet, X-rays, and gamma rays.";
}
else if (lowerCommand.includes('what is a filter type RF') || lowerCommand.includes('RF filter')) {
    responseText = "An RF filter is an electronic filter designed to operate on signals in the radio frequency range. They are used to pass certain frequencies while rejecting others, crucial for preventing interference and selecting desired signals in wireless systems.";
}

// --- Power Electronics (Expanded Further) ---
else if (lowerCommand.includes('what is a DC-DC converter') || lowerCommand.includes('DC to DC converter')) {
    responseText = "A DC-DC converter is an electronic circuit that converts a source of direct current (DC) from one voltage level to another. They are essential in portable electronic devices and renewable energy systems.";
}
else if (lowerCommand.includes('what is a buck converter') || lowerCommand.includes('buck converter')) {
    responseText = "A buck converter (step-down converter) is a type of DC-DC converter that converts a higher input DC voltage to a lower output DC voltage. It's widely used in power supplies.";
}
else if (lowerCommand.includes('what is a boost converter') || lowerCommand.includes('boost converter')) {
    responseText = "A boost converter (step-up converter) is a type of DC-DC converter that converts a lower input DC voltage to a higher output DC voltage. It's used in applications requiring a higher voltage than the available source.";
}
else if (lowerCommand.includes('what is a buck-boost converter') || lowerCommand.includes('buck boost converter')) {
    responseText = "A buck-boost converter is a type of DC-DC converter that can produce an output voltage magnitude that is either greater than or less than the input voltage magnitude. The output voltage is of opposite polarity to the input.";
}
else if (lowerCommand.includes('what is an inverter') || lowerCommand.includes('power inverter')) {
    responseText = "An inverter is an electronic device that converts direct current (DC) to alternating current (AC). It's crucial for applications like solar power systems, UPS (Uninterruptible Power Supplies), and variable frequency drives for AC motors.";
}
else if (lowerCommand.includes('what is a switch mode power supply') || lowerCommand.includes('SMPS')) {
    responseText = "An SMPS (Switch-Mode Power Supply) is an electronic power supply that incorporates a switching regulator to convert electrical power efficiently. It rapidly switches a power device between ON and OFF states to regulate the output voltage, offering high efficiency compared to linear power supplies.";
}
else if (lowerCommand.includes('what is power factor') || lowerCommand.includes('power factor electronics')) {
    responseText = "Power factor is a dimensionless quantity in AC circuits, defined as the ratio of real power flowing to the load to the apparent power in the circuit. It indicates how effectively electrical power is being used. A power factor closer to 1 (unity) is desirable.";
}
else if (lowerCommand.includes('what is a transformer') || lowerCommand.includes('transformer electronics')) {
    responseText = "A transformer is a passive electrical device that transfers electrical energy from one electrical circuit to another, or multiple circuits. A varying current in one coil of the transformer produces a varying magnetic flux in the transformer's core, which in turn induces a varying electromotive force across a second coil.";
}
else if (lowerCommand.includes('what is a UPS') || lowerCommand.includes('Uninterruptible Power Supply')) {
    responseText = "A UPS (Uninterruptible Power Supply) is an electrical apparatus that provides emergency power to a load when the input power source or mains power fails. It typically contains a battery and an inverter, ensuring continuous power to critical equipment.";
}
else if (lowerCommand.includes('what is a full-wave rectifier') || lowerCommand.includes('full wave rectifier')) {
    responseText = "A full-wave rectifier is an electrical circuit that converts both halves of an alternating current (AC) input into a pulsating direct current (DC) output. This makes it more efficient than a half-wave rectifier, providing a smoother DC output after filtering.";
}
else if (lowerCommand.includes('what is a bridge rectifier') || lowerCommand.includes('bridge rectifier')) {
    responseText = "A bridge rectifier is a type of full-wave rectifier circuit that uses four diodes to provide an efficient conversion of alternating current (AC) input to direct current (DC) output. It's commonly used in power supplies for its simplicity and effectiveness.";
}
else if (lowerCommand.includes('what is a linear power supply') || lowerCommand.includes('linear power supply')) {
    responseText = "A linear power supply is a power supply that uses a linear regulator to maintain a constant output voltage. It achieves regulation by dissipating excess voltage as heat, making it less efficient but often resulting in lower noise and ripple compared to SMPS.";
}
else if (lowerCommand.includes('what is active power') || lowerCommand.includes('real power')) {
    responseText = "Active power (also known as real power) is the actual power consumed by the load in an AC circuit. It is the component of power that results in the dissipation of energy, such as heat, light, or mechanical work, measured in Watts (W).";
}
else if (lowerCommand.includes('what is reactive power') || lowerCommand.includes('reactive power')) {
    responseText = "Reactive power is the power that oscillates between the source and the reactive components (inductors and capacitors) in an AC circuit. It does not perform any useful work but is necessary for the operation of inductive loads. It is measured in Volt-Ampere Reactive (VAR).";
}
else if (lowerCommand.includes('what is a flyback converter') || lowerCommand.includes('flyback converter')) {
    responseText = "A flyback converter is a type of buck-boost converter that can provide isolation between the input and output. It stores energy in an inductor during the switch's on-time and transfers it to the output during the off-time. Commonly used in low-power isolated power supplies.";
}
else if (lowerCommand.includes('what is a forward converter') || lowerCommand.includes('forward converter')) {
    responseText = "A forward converter is a type of isolated DC-DC converter that uses a transformer to transfer energy from the input to the output when the switch is ON. It's often used for higher power applications than flyback converters.";
}

else if (lowerCommand.includes('what is a Cuk converter') || lowerCommand.includes('Cuk converter')) {
    responseText = "A Cuk converter is a type of switched-mode DC-DC converter that has the ability to either step up or step down the input voltage, and the output voltage has the opposite polarity of the input voltage. It's known for its low output ripple current.";
}
else if (lowerCommand.includes('what is a SEPIC converter') || lowerCommand.includes('SEPIC converter')) {
    responseText = "A SEPIC (Single-Ended Primary-Inductor Converter) is a type of DC-DC converter that provides a regulated output voltage that can be higher than, lower than, or equal to the input voltage. It's non-inverting and often used in battery-powered applications.";
}
else if (lowerCommand.includes('what is battery management system') || lowerCommand.includes('BMS electronics')) {
    responseText = "A Battery Management System (BMS) is an electronic system that manages a rechargeable battery (cell or battery pack). It monitors its state, calculates secondary data, reports that data, protects the battery, controls its environment, and balances it.";
}
else if (lowerCommand.includes('what is energy harvesting') || lowerCommand.includes('energy harvesting')) {
    responseText = "Energy harvesting (also known as power harvesting or energy scavenging) is the process by which energy is derived from external sources (e.g., solar, thermal, kinetic, RF) and converted into electrical power for small electronic devices. It aims to achieve autonomous operation.";
}
else if (lowerCommand.includes('what is a grid-tie inverter') || lowerCommand.includes('grid-tie inverter')) {
    responseText = "A grid-tie inverter is an electronic device that converts direct current (DC) from renewable energy sources (like solar panels) into alternating current (AC) that can be fed into a commercial electrical grid. It synchronizes with the grid's voltage and frequency.";
}

else if (lowerCommand.includes('what is a controlled rectifier') || lowerCommand.includes('controlled rectifier')) {
    responseText = "A controlled rectifier is an electronic circuit that converts AC to DC, but unlike uncontrolled rectifiers (using only diodes), it allows the output DC voltage to be varied by controlling the firing angle of switching devices like SCRs or TRIACs.";
}

// --- Instrumentation & Measurement (Expanded Further) ---
else if (lowerCommand.includes('what is an oscilloscope') || lowerCommand.includes('oscilloscope')) {
    responseText = "An oscilloscope is an electronic test instrument that graphically displays varying signal voltages, usually as a two-dimensional plot of one or more signals as a function of time. It's indispensable for observing and analyzing waveforms.";
}
else if (lowerCommand.includes('what is a multimeter') || lowerCommand.includes('multimeter')) {
    responseText = "A multimeter is an electronic measuring instrument that combines several measurement functions in one unit. A typical multimeter can measure voltage, current, and resistance, and some can also measure capacitance, frequency, and temperature.";
}
else if (lowerCommand.includes('what is a function generator') || lowerCommand.includes('function generator')) {
    responseText = "A function generator is a piece of electronic test equipment used to generate various types of electrical waveforms over a wide range of frequencies. Common waveforms include sine, square, triangle, and sawtooth waves.";
}
else if (lowerCommand.includes('what is a logic analyzer') || lowerCommand.includes('logic analyzer')) {
    responseText = "A logic analyzer is an electronic instrument that captures and displays multiple digital signals from a digital system or circuit. Unlike an oscilloscope, which displays analog waveforms, a logic analyzer focuses on the timing and logic states (high/low) of digital signals.";
}
else if (lowerCommand.includes('what is a spectrum analyzer') || lowerCommand.includes('spectrum analyzer')) {
    responseText = "A spectrum analyzer is an electronic instrument that measures the magnitude of an input signal versus frequency within the full frequency range of the instrument. Its primary use is to measure the power of the spectrum of known and unknown signals.";
}
else if (lowerCommand.includes('what is a signal generator') || lowerCommand.includes('signal generator')) {
    responseText = "A signal generator is an electronic device that generates repeating or non-repeating electronic signals (waveforms) in either the analog or digital domain. These are used as stimuli for testing electronic designs, for example, to test the frequency response of an amplifier.";
}
else if (lowerCommand.includes('what is an LCR meter') || lowerCommand.includes('LCR meter')) {
    responseText = "An LCR meter is a piece of electronic test equipment used to measure the inductance (L), capacitance (C), and resistance (R) of an electronic component. It can also measure other derived parameters like Q factor and dissipation factor.";
}
else if (lowerCommand.includes('what is a power supply') || lowerCommand.includes('lab power supply')) {
    responseText = "A power supply is an electrical device that supplies electric power to an electrical load. It's typically used to convert one form of electrical energy to another, regulating the output voltage and current to provide stable power for testing and operating circuits.";
}
else if (lowerCommand.includes('what is calibration') || lowerCommand.includes('instrument calibration')) {
    responseText = "Calibration is the process of configuring an instrument to provide a result for a sample within an acceptable range. It involves comparing the readings of a measurement device against a known standard to ensure accuracy.";
}
else if (lowerCommand.includes('what is a data logger') || lowerCommand.includes('data logger')) {
    responseText = "A data logger is an electronic device that records data over time or in relation to location either with a built-in instrument or sensor or via external instruments and sensors. They are used for long-term monitoring of environmental conditions, process parameters, and more.";
}
else if (lowerCommand.includes('what is an arbitrary waveform generator') || lowerCommand.includes('AWG')) {
    responseText = "An Arbitrary Waveform Generator (AWG) is an electronic test equipment that can generate any desired waveform, unlike a standard function generator which produces only predefined waveforms (sine, square, etc.). AWGs are highly versatile for complex signal generation.";
}
else if (lowerCommand.includes('what is ground in electronics') || lowerCommand.includes('ground electronics')) {
    responseText = "Ground in electronics is the reference point in an electrical circuit from which voltages are measured. It also serves as a common return path for electric current and can provide a safety path for fault currents.";
}
else if (lowerCommand.includes('what is a short circuit') || lowerCommand.includes('short circuit')) {
    responseText = "A short circuit is an electrical circuit that allows current to travel along an unintended path with very low electrical impedance. This can cause excessive current flow, leading to overheating, damage to components, or fire.";
}
else if (lowerCommand.includes('what is an open circuit') || lowerCommand.includes('open circuit')) {
    responseText = "An open circuit is an electrical circuit in which the continuity has been broken, so that current cannot flow. This results in infinite resistance and zero current flow through the open part of the circuit.";
}
else if (lowerCommand.includes('what is a vector network analyzer') || lowerCommand.includes('VNA')) {
    responseText = "A Vector Network Analyzer (VNA) is an electronic test instrument that measures the scattering parameters (S-parameters) of electrical networks. It's critical for characterizing RF components like antennas, filters, and transmission lines.";
}
else if (lowerCommand.includes('what is an environmental chamber') || lowerCommand.includes('environmental testing')) {
    responseText = "An environmental chamber (or climatic chamber) is an enclosure used to test the effects of specified environmental conditions (e.g., temperature, humidity, vibration) on industrial products, electronic devices, and materials. It's crucial for product reliability testing.";
}
else if (lowerCommand.includes('what is SPICE simulation') || lowerCommand.includes('SPICE')) {
    responseText = "SPICE (Simulation Program with Integrated Circuit Emphasis) is a general-purpose open-source analog electronic circuit simulator. It's widely used by circuit designers to predict the behavior of electronic circuits before actually building them, saving time and cost.";
}
else if (lowerCommand.includes('what is an in-circuit emulator') || lowerCommand.includes('ICE embedded')) {
    responseText = "An In-Circuit Emulator (ICE) is a hardware device used to debug embedded systems. It replaces the target microcontroller during development, allowing the developer to control and observe the CPU's behavior in real-time.";
}
else if (lowerCommand.includes('what is a digital storage oscilloscope') || lowerCommand.includes('DSO')) {
    responseText = "A Digital Storage Oscilloscope (DSO) is an oscilloscope that captures and stores digital representations of waveforms. This allows for detailed analysis, saving, and printing of signals, and enables advanced triggering modes and waveform processing.";
}
else if (lowerCommand.includes('what is a mixed-signal oscilloscope') || lowerCommand.includes('MSO')) {
    responseText = "A Mixed-Signal Oscilloscope (MSO) is an oscilloscope that combines the functionality of a digital storage oscilloscope (DSO) with a logic analyzer. It can simultaneously display and correlate analog and digital signals, ideal for debugging embedded systems.";
}
else if (lowerCommand.includes('what is a spectrum analyzer function') || lowerCommand.includes('spectrum analyzer function')) {
    responseText = "A spectrum analyzer displays the magnitude of a signal against frequency. This allows engineers to identify signal components, measure power levels, characterize modulation, and detect interference, crucial for RF and wireless development.";
}
else if (lowerCommand.includes('what is current clamp meter') || lowerCommand.includes('clamp meter')) {
    responseText = "A current clamp meter is an electrical test tool that combines a basic digital multimeter with a current sensor. It measures current by clamping around a conductor, without needing to break the circuit, making it convenient and safe for measuring high currents.";
}
else if (lowerCommand.includes('what is a data acquisition system') || lowerCommand.includes('DAQ system')) {
    responseText = "A Data Acquisition (DAQ) system is a system that measures electrical or physical phenomena, such as voltage, current, temperature, pressure, or sound, and converts them into digital values that can be manipulated by a computer. DAQ systems are essential for testing and control applications.";
}


// --- Materials and Fabrication (Expanded Further) ---
else if (lowerCommand.includes('what is a PCB') || lowerCommand.includes('Printed Circuit Board')) {
    responseText = "A PCB (Printed Circuit Board) is a board used to mechanically support and electrically connect electronic components using conductive pathways, tracks, or signal traces etched from copper sheets laminated onto a non-conductive substrate. It's the foundation of almost all electronic devices.";
}
else if (lowerCommand.includes('what is soldering') || lowerCommand.includes('soldering electronics')) {
    responseText = "Soldering is a process in which two or more items are joined together by melting and putting a filler metal (solder) into the joint, with the filler metal having a lower melting point than the adjoining metal. It's a common method for making electrical connections.";
}
else if (lowerCommand.includes('what is surface mount technology') || lowerCommand.includes('SMT')) {
    responseText = "SMT (Surface-Mount Technology) is a method for producing electronic circuits in which the components are mounted directly onto the surface of printed circuit boards (PCBs). This contrasts with through-hole technology, where components have leads that are inserted into holes.";
}

else if (lowerCommand.includes('what is through-hole technology') || lowerCommand.includes('THT')) {
    responseText = "Through-Hole Technology (THT) is a method for constructing electronic circuits by inserting components' leads through holes in printed circuit boards (PCBs) and soldering them on the opposite side. It's a traditional method, often more robust than SMT for certain components.";
}
else if (lowerCommand.includes('what is a semiconductor') || lowerCommand.includes('semiconductor material')) {
    responseText = "A semiconductor is a material that has electrical conductivity between that of a conductor (like copper) and an insulator (like glass). Their conductivity can be controlled, making them fundamental to modern electronics.";
}
else if (lowerCommand.includes('what is silicon') || lowerCommand.includes('silicon electronics')) {
    responseText = "Silicon (Si) is a chemical element that is the most common semiconductor material used in electronic devices. Its unique atomic structure allows it to be easily doped, forming the basis for integrated circuits, transistors, and solar cells.";
}
else if (lowerCommand.includes('what is gallium nitride') || lowerCommand.includes('GaN electronics')) {
    responseText = "Gallium Nitride (GaN) is a wide-bandgap semiconductor material that is becoming increasingly important in power electronics and RF applications. It offers higher efficiency, faster switching speeds, and smaller form factors compared to traditional silicon devices.";
}
else if (lowerCommand.includes('what is germanium') || lowerCommand.includes('germanium electronics')) {
    responseText = "Germanium (Ge) is a chemical element that is also a semiconductor, historically used before silicon became dominant. It has a lower bandgap than silicon, making it useful in certain high-frequency and infrared applications, though less common today.";
}
else if (lowerCommand.includes('what is a substrate') || lowerCommand.includes('substrate electronics')) {
    responseText = "In electronics, a substrate is the base material on which components are fabricated or assembled. For PCBs, it's typically fiberglass; for ICs, it's a thin wafer of semiconductor material like silicon.";
}
else if (lowerCommand.includes('what is etching') || lowerCommand.includes('etching PCB')) {
    responseText = "Etching in PCB fabrication is the process of chemically removing unwanted copper from the board, leaving behind the desired conductive traces and pads. This is a key step in creating the circuit pattern.";
}
else if (lowerCommand.includes('what is reflow soldering') || lowerCommand.includes('reflow soldering')) {
    responseText = "Reflow soldering is a process in which solder paste (a mixture of powdered solder and flux) is used to temporarily attach surface-mount components to their contact pads, after which the entire assembly is subjected to controlled heat to melt the solder and form permanent electrical connections.";
}
else if (lowerCommand.includes('what is a dielectric material') || lowerCommand.includes('dielectric material')) {
    responseText = "A dielectric material is an electrical insulator that can be polarized by an applied electric field. It's used in capacitors to increase capacitance and in PCBs as insulating layers between conductive traces.";
}
else if (lowerCommand.includes('what is a ferromagnetic material') || lowerCommand.includes('ferromagnetic material')) {
    responseText = "A ferromagnetic material is a material that exhibits a large and permanent magnetization in the presence of an external magnetic field. These materials (e.g., iron, nickel) are used in inductors, transformers, and magnetic storage devices.";
}
else if (lowerCommand.includes('what is a piezoelectric material') || lowerCommand.includes('piezoelectric material')) {
    responseText = "A piezoelectric material is a material that generates an electric charge in response to applied mechanical stress (piezoelectric effect) and conversely changes shape when an electric field is applied (inverse piezoelectric effect). Used in sensors, actuators, and oscillators.";
}
else if (lowerCommand.includes('what is a superconductor') || lowerCommand.includes('superconductor electronics')) {
    responseText = "A superconductor is a material that, when cooled below a critical temperature, exhibits zero electrical resistance and expels magnetic fields. While challenging to implement at room temperature, they promise highly efficient electronics and power transmission.";
}
else if (lowerCommand.includes('what is wafer-level packaging') || lowerCommand.includes('wafer-level packaging')) {
    responseText = "Wafer-level packaging (WLP) is an IC packaging technology where all packaging and testing operations are performed while the chips are still in wafer form. This results in smaller, thinner packages with improved electrical performance.";
}
else if (lowerCommand.includes('what is 3D ICs') || lowerCommand.includes('3D Integrated Circuits')) {
    responseText = "3D Integrated Circuits (3D ICs) are integrated circuits that are fabricated by vertically stacking two or more layers of active electronic components or dies and interconnecting them with through-silicon vias (TSVs). This allows for higher density and shorter interconnections.";
}
else if (lowerCommand.includes('what is photolithography') || lowerCommand.includes('photolithography electronics')) {
    responseText = "Photolithography is a process used in microfabrication to pattern parts of a thin film or the bulk of a substrate. It uses light to transfer a geometric pattern from a photomask to a light-sensitive chemical photoresist on the substrate, essential for IC manufacturing.";
}
else if (lowerCommand.includes('what is cleanroom') || lowerCommand.includes('cleanroom electronics')) {
    responseText = "A cleanroom is a controlled environment with low levels of pollutants such as dust, airborne microbes, and chemical vapors. It's essential in semiconductor manufacturing and other fields where small particles can adversely affect the fabrication process.";
}
else if (lowerCommand.includes('what is pick and place machine') || lowerCommand.includes('pick and place machine')) {
    responseText = "A pick and place machine is an automated device used in electronics manufacturing to place surface-mount devices (SMDs) onto printed circuit boards (PCBs) with high precision and speed. It uses robotic arms and vision systems to accurately position components.";
}
else if (lowerCommand.includes('what is a stencil printer') || lowerCommand.includes('stencil printer PCB')) {
    responseText = "A stencil printer is a machine used in the PCB assembly process to apply solder paste onto the pads of a printed circuit board (PCB) through a stencil. This ensures that the right amount of solder paste is deposited in the correct locations for surface-mount components.";
}
// --- Programming Languages and Platforms ---
else if (lowerCommand.includes('what is c pro') || lowerCommand.includes('what is c programming') || lowerCommand.includes('c programming')) {
    responseText = "C programming (often referred to as 'C Pro' in a general sense for professional application) is a powerful, general-purpose programming language widely used for system programming, embedded systems, and applications where performance is critical. It's a foundational language for many other languages.";
}
else if (lowerCommand.includes('what is python programming') || lowerCommand.includes('python programming')) {
    responseText = "Python is a high-level, interpreted programming language known for its readability and versatility. It's widely used in web development, data analysis, artificial intelligence, scientific computing, and automation due to its extensive libraries and supportive community.";
}
else if (lowerCommand.includes('what is java programming') || lowerCommand.includes('java programming')) {
    responseText = "Java is a high-level, class-based, object-oriented programming language designed to have as few implementation dependencies as possible. It's widely used for building enterprise-scale applications, Android apps, and web applications due to its portability and robustness.";
}
else if (lowerCommand.includes('what is javascript programming') || lowerCommand.includes('javascript programming')) {
    responseText = "JavaScript is a versatile, high-level programming language primarily used for enhancing the interactivity of web pages. It runs in web browsers and on servers (via Node.js), enabling dynamic content, user interfaces, and full-stack development.";
}
else if (lowerCommand.includes('what is c++ programming') || lowerCommand.includes('c++ programming')) {
    responseText = "C++ is a powerful, high-performance programming language that extends the C programming language with object-oriented features. It's widely used in system/software development, game development, real-time simulations, and performance-critical applications.";
}
else if (lowerCommand.includes('what is embedded c') || lowerCommand.includes('embedded c programming')) {
    responseText = "Embedded C is an extension of the C programming language specifically designed for programming microcontrollers and embedded systems. It includes additional features to handle hardware-specific tasks like direct memory access and peripheral control.";
}
else if (lowerCommand.includes('what is VHDL') || lowerCommand.includes('VHDL programming')) {
    responseText = "VHDL (VHSIC Hardware Description Language) is a hardware description language used to model electronic systems at various levels of abstraction. It's commonly used for designing and simulating digital circuits such as FPGAs and ASICs.";
}
else if (lowerCommand.includes('what is verilog') || lowerCommand.includes('verilog programming')) {
    responseText = "Verilog is a hardware description language used to model electronic systems. It allows designers to describe the structure and behavior of digital circuits and is widely used for designing FPGAs and ASICs.";
}
else if (lowerCommand.includes('what is matlab') || lowerCommand.includes('matlab')) {
    responseText = "MATLAB (Matrix Laboratory) is a proprietary multi-paradigm programming language and numerical computing environment developed by MathWorks. It's primarily used for numerical computation, visualization, and programming, especially in engineering and scientific fields.";
}

else if (lowerCommand.includes('what is arduino language') || lowerCommand.includes('arduino programming language')) {
    responseText = "The Arduino programming language is a simplified version of C/C++. It consists of two main functions: 'setup()' for initialization and 'loop()' for the main program logic, and uses a set of specific functions and libraries designed to easily interact with the Arduino hardware.";
}

else if (lowerCommand.includes('who are you') || lowerCommand.includes('about you') || lowerCommand.includes('indra')) {
    responseText = "I'm INDRA, an electronics engineer and educator with over 3 years of experience. My passion is to make electronics education accessible to everyone through my platform, E-TECH SOLUTIONS.";
}
else if (lowerCommand.includes('qualifications') || lowerCommand.includes('experience')) {
    responseText = "INDRA holds a Diploma in Electronics and Communication Engineering, is a Certified IoT Specialist, has over 2 years of industry experience, 1 year of teaching experience, and has published over 20 technical papers.";
}

                else if (lowerCommand.includes('troubleshoot') || lowerCommand.includes('fix my code') || lowerCommand.includes('debug')) {
                    responseText = "Please provide the specific issue or code snippet you'd like help troubleshooting.";
                } 
                else if (lowerCommand.includes('explain this code') || lowerCommand.includes('code explanation')) {
                    responseText = "Please paste the code snippet you'd like me to explain.";
                } 
                else if (lowerCommand.includes('suggest components') || lowerCommand.includes('component suggestion')) {
                    responseText = "Please describe your project requirements or the type of components you're looking for.";
                } 
                else if (lowerCommand.includes('lab report help') || lowerCommand.includes('draft lab report')) {
                    responseText = "Please provide the data or observations from your lab experiment that you'd like help drafting into a report.";
                }

                else if (lowerCommand.includes('open google')) {
                    window.open('https://www.google.com', '_blank');
                    responseText = "Opening Google in a new tab.";
                }
                else if (lowerCommand.includes('open instagram')) {
                    window.open('https://www.instagram.com', '_blank');
                    responseText = "Opening Instagram in a new tab.";
                } else if (lowerCommand.includes('open facebook')) {
                    window.open('https://www.facebook.com', '_blank');
                    responseText = "Opening Facebook in a new tab.";
                } else if (lowerCommand.includes('open youtube')) {
                    window.open('https://www.youtube.com', '_blank');
                    responseText = "Opening YouTube in a new tab.";
                }

                 else if (lowerCommand.includes('open calculator')) {
                    window.open('https://www.google.com/search?q=calculator', '_blank'); // Opens Google's calculator
                    responseText = "Opening calculator in a new tab.";
                } else if (lowerCommand.includes('open whatsapp')) {
                    window.open('https://web.whatsapp.com', '_blank'); // Opens WhatsApp Web
                    responseText = "Opening WhatsApp Web in a new tab.";
                } else if (lowerCommand.includes('open email') || lowerCommand.includes('open gmail')) {
                    window.open('https://mail.google.com', '_blank'); // Opens Gmail
                    responseText = "Opening Gmail in a new tab.";
                } else if (imageData) {
                    try {
                        const imageDescription = await callGeminiApi("Describe this image in detail.", null, imageData);
                        responseText = `Here's what I see in the image: ${imageDescription} Currently, I can describe images, but converting them into videos is beyond my current capabilities. Perhaps in a future update!`;
                    } catch (error) {
                        console.error("Image analysis failed:", error);
                        responseText = "I had trouble analyzing that image. Please try again.";
                    }
                } else {
                    // Redirect to Gemini API for other questions
                    try {
                        responseText = await callGeminiApi(command);
                    } catch (error) {
                        console.error("Gemini API call failed for general query:", error);
                        responseText = "I'm sorry, I couldn't fetch an answer for that right now. Please try asking something else.";
                    }
                }

                thinkingStatus.classList.add('hidden'); // Hide thinking status
                appendMessage(responseText, 'assistant');
                readAloud(responseText);
            }

            function appendMessage(message, sender) {
                const msgDiv = document.createElement('div');
                msgDiv.className = `chat-message ${sender} fade-in`; // Add fade-in animation
                // Check if the message content implies an image, and add a specific class
                if (sender === 'user' && message.includes('<img src=')) {
                    msgDiv.classList.add('image-message');
                }
                msgDiv.innerHTML = message; // Use innerHTML to allow for image messages
                chatHistory.prepend(msgDiv); // Add new messages to the top for reverse-flex layout
                chatHistory.scrollTop = chatHistory.scrollHeight; // Scroll to bottom if not using flex-reverse
            }

            function readAloud(text) {
                if (synth.speaking) {
                    synth.cancel(); // Stop current speech
                }
                currentUtterance = new SpeechSynthesisUtterance(text);
                
                // You can set properties like voice, pitch, rate here
                // Example:
                // const voices = synth.getVoices();
                // currentUtterance.voice = voices.find(voice => voice.name === 'Google UK English Female');
                currentUtterance.pitch = 1;
                currentUtterance.rate = 1;

                currentUtterance.onstart = () => {
                    stopSpeechBtn.classList.add('speech-active'); // Add animation
                };
                currentUtterance.onend = () => {
                    stopSpeechBtn.classList.remove('speech-active'); // Remove animation
                    currentUtterance = null;
                };
                currentUtterance.onerror = (event) => {
                    console.error('SpeechSynthesisUtterance.onerror', event);
                    stopSpeechBtn.classList.remove('speech-active');
                    currentUtterance = null;
                };

                synth.speak(currentUtterance);
            }

        }); // End DOMContentLoaded
    </script>
   
</body>
</html>